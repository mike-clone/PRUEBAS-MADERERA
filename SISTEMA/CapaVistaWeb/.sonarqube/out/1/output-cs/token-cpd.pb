Ç
YC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Conexion.cs
	namespace 	
CapaAccesoDatos
 
{ 
public 

class 
Conexion 
{		 
private

 
static

 
readonly

 
Conexion

  (

_instancia

) 3
=

4 5
new

6 9
Conexion

: B
(

B C
)

C D
;

D E
public 
static 
Conexion 
	Instancia (
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
SqlConnection 
Conectar %
(% &
)& '
{ 	
SqlConnection 
cn 
= 
new "
SqlConnection# 0
(0 1
)1 2
;2 3
try 
{ 
cn 
. 
ConnectionString #
=$ %
$str& y
;y z
cn 
. 
Open 
( 
) 
; 
cn 
. 
Close 
( 
) 
; 
} 
catch 
( 
	Exception 
ex 
)  
{ 
throw 
new 
	Exception #
(# $
$str$ E
+E F
exF H
.H I
MessageI P
)P Q
;Q R
} 
return 
cn 
; 
} 	
}   
}!! ´ä
eC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatTemporaryProducts.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class  
DatTemporaryProducts %
:& '!
IDatTemporaryProducts( =
{ 
private 
static 
readonly  
DatTemporaryProducts  4
	_instance5 >
=? @
newA D 
DatTemporaryProductsE Y
(Y Z
)Z [
;[ \
public 
static  
DatTemporaryProducts *
Instance+ 3
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
bool &
CreaarTemporaryProductsCli .
(. / 
EntTemporaryProducts/ C
tempD H
)H I
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% B
,B C
cnD F
)F G
;G H
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
temp; ?
.? @
ProveedorProducto@ Q
.Q R
ProductoR Z
.Z [

IdProducto[ e
)e f
;f g
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
temp: >
.> ?
Usuario? F
.F G
	IdUsuarioG P
)P Q
;Q R
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
temp9 =
.= >
Cantidad> F
)F G
;G H
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
temp9 =
.= >
Subtotal> F
)F G
;G H
cn 
. 
Open 
( 
) 
; 
int   
i   
=   
cmd   
.   
ExecuteNonQuery   +
(  + ,
)  , -
;  - .
if!! 
(!! 
i!! 
>!! 
$num!! 
)!! 
{"" 
creado## 
=## 
true## !
;##! "
}$$ 
}%% 
catch&& 
(&& 
	Exception&& 
e&& 
)&& 
{'' 

MessageBox)) 
.)) 
Show)) 
())  
e))  !
.))! "
Message))" )
)))) *
;))* +
}** 
finally++ 
{,, 
cmd-- 
.-- 

Connection-- 
.-- 
Close-- $
(--$ %
)--% &
;--& '
}.. 
return// 
creado// 
;// 
}11 	
public22 
bool22 #
CreaarTemporaryProducts22 +
(22+ , 
EntTemporaryProducts22, @
temp22A E
)22E F
{33 	

SqlCommand44 
cmd44 
=44 
null44 !
;44! "
bool55 
creado55 
=55 
false55 
;55  
try66 
{77 
SqlConnection88 
cn88  
=88! "
Conexion88# +
.88+ ,
	Instancia88, 5
.885 6
Conectar886 >
(88> ?
)88? @
;88@ A
cmd99 
=99 
new99 

SqlCommand99 $
(99$ %
$str99% ?
,99? @
cn99A C
)99C D
;99D E
cmd:: 
.:: 
CommandType:: 
=::  !
CommandType::" -
.::- .
StoredProcedure::. =
;::= >
cmd;; 
.;; 

Parameters;; 
.;; 
AddWithValue;; +
(;;+ ,
$str;;, 9
,;;9 :
temp;;; ?
.;;? @
ProveedorProducto;;@ Q
.;;Q R
Producto;;R Z
.;;Z [

IdProducto;;[ e
);;e f
;;;f g
cmd<< 
.<< 

Parameters<< 
.<< 
AddWithValue<< +
(<<+ ,
$str<<, :
,<<: ;
temp<<< @
.<<@ A
ProveedorProducto<<A R
.<<R S
	Proveedor<<S \
.<<\ ]
IdProveedor<<] h
)<<h i
;<<i j
cmd== 
.== 

Parameters== 
.== 
AddWithValue== +
(==+ ,
$str==, 8
,==8 9
temp==: >
.==> ?
Usuario==? F
.==F G
	IdUsuario==G P
)==P Q
;==Q R
cmd>> 
.>> 

Parameters>> 
.>> 
AddWithValue>> +
(>>+ ,
$str>>, 7
,>>7 8
temp>>9 =
.>>= >
Cantidad>>> F
)>>F G
;>>G H
cmd?? 
.?? 

Parameters?? 
.?? 
AddWithValue?? +
(??+ ,
$str??, 7
,??7 8
temp??9 =
.??= >
Subtotal??> F
)??F G
;??G H
cn@@ 
.@@ 
Open@@ 
(@@ 
)@@ 
;@@ 
intAA 
iAA 
=AA 
cmdAA 
.AA 
ExecuteNonQueryAA +
(AA+ ,
)AA, -
;AA- .
ifBB 
(BB 
iBB 
>BB 
$numBB 
)BB 
{CC 
creadoDD 
=DD 
trueDD !
;DD! "
}EE 
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 

MessageBoxJJ 
.JJ 
ShowJJ 
(JJ  
eJJ  !
.JJ! "
MessageJJ" )
)JJ) *
;JJ* +
}KK 
finallyLL 
{MM 
cmdNN 
.NN 

ConnectionNN 
.NN 
CloseNN $
(NN$ %
)NN% &
;NN& '
}OO 
returnPP 
creadoPP 
;PP 
}RR 	
publicTT 
ListTT 
<TT  
EntTemporaryProductsTT (
>TT( )$
MostrarTemporaryProductsTT* B
(TTB C
intTTC F
	idUsuarioTTG P
)TTP Q
{UU 	

SqlCommandVV 
cmdVV 
=VV 
nullVV !
;VV! "
ListWW 
<WW  
EntTemporaryProductsWW %
>WW% &
listWW' +
=WW, -
newWW. 1
ListWW2 6
<WW6 7 
EntTemporaryProductsWW7 K
>WWK L
(WWL M
)WWM N
;WWN O
tryXX 
{YY 
SqlConnectionZZ 
cnZZ  
=ZZ! "
ConexionZZ# +
.ZZ+ ,
	InstanciaZZ, 5
.ZZ5 6
ConectarZZ6 >
(ZZ> ?
)ZZ? @
;ZZ@ A
cmd[[ 
=[[ 
new[[ 

SqlCommand[[ $
([[$ %
$str[[% @
,[[@ A
cn[[B D
)[[D E
;[[E F
cmd\\ 
.\\ 

Parameters\\ 
.\\ 
AddWithValue\\ +
(\\+ ,
$str\\, 8
,\\8 9
	idUsuario\\: C
)\\C D
;\\D E
cmd]] 
.]] 
CommandType]] 
=]]  !
CommandType]]" -
.]]- .
StoredProcedure]]. =
;]]= >
cn^^ 
.^^ 
Open^^ 
(^^ 
)^^ 
;^^ 
SqlDataReader__ 
dr__  
=__! "
cmd__# &
.__& '
ExecuteReader__' 4
(__4 5
)__5 6
;__6 7
while`` 
(`` 
dr`` 
.`` 
Read`` 
(`` 
)``  
)``  !
{aa  
EntTemporaryProductsbb (
tempbb) -
=bb. /
newbb0 3 
EntTemporaryProductsbb4 H
{cc 
IdTempdd 
=dd  
Convertdd! (
.dd( )
ToInt32dd) 0
(dd0 1
drdd1 3
[dd3 4
$strdd4 <
]dd< =
)dd= >
,dd> ?
ProveedorProductoee )
=ee) *
newee* - 
EntProveedorProductoee. B
{ff 
	Proveedorgg %
=gg& '
newgg( +
EntProveedorgg, 8
{hh 
IdProveedorii  +
=ii, -
Convertii. 5
.ii5 6
ToInt32ii6 =
(ii= >
drii> @
[ii@ A
$striiA N
]iiN O
)iiO P
,iiP Q
RazonSocialjj  +
=jj, -
drjj. 0
[jj0 1
$strjj1 >
]jj> ?
.jj? @
ToStringjj@ H
(jjH I
)jjI J
,jjJ K
Descripcionkk  +
=kk, -
drkk. 0
[kk0 1
$strkk1 >
]kk> ?
.kk? @
ToStringkk@ H
(kkH I
)kkI J
}ll 
,ll 
Productomm $
=mm% &
newmm' *
EntProductomm+ 6
{nn 

IdProductooo  *
=oo+ ,
Convertoo- 4
.oo4 5
ToInt32oo5 <
(oo< =
droo= ?
[oo? @
$stroo@ L
]ooL M
)ooM N
,ooN O
Nombrepp  &
=pp' (
drpp) +
[pp+ ,
$strpp, 4
]pp4 5
.pp5 6
ToStringpp6 >
(pp> ?
)pp? @
,pp@ A
Longitudqq  (
=qq) *
Convertqq+ 2
.qq2 3
ToDoubleqq3 ;
(qq; <
drqq< >
[qq> ?
$strqq? I
]qqI J
)qqJ K
,qqK L
Diametrorr  (
=rr) *
Convertrr+ 2
.rr2 3
ToDoublerr3 ;
(rr; <
drrr< >
[rr> ?
$strrr? I
]rrI J
)rrJ K
,rrK L
PrecioVentass  +
=ss, -
Convertss. 5
.ss5 6
ToDoubless6 >
(ss> ?
drss? A
[ssA B
$strssB O
]ssO P
)ssP Q
,ssQ R
Tipott  $
=tt% &
newtt' *
EntTipoProductott+ :
{uu  !
Nombrevv$ *
=vv+ ,
drvv- /
[vv/ 0
$strvv0 6
]vv6 7
.vv7 8
ToStringvv8 @
(vv@ A
)vvA B
}ww  !
}yy 
,yy 
PrecioComprazz (
=zz) *
Convertzz+ 2
.zz2 3
ToDoublezz3 ;
(zz; <
drzz< >
[zz> ?
$strzz? M
]zzM N
)zzN O
}{{ 
,{{ 
Cantidad||  
=||! "
Convert||# *
.||* +
ToInt32||+ 2
(||2 3
dr||3 5
[||5 6
$str||6 @
]||@ A
)||A B
,||B C
Subtotal}}  
=}}! "
Convert}}# *
.}}* +
ToDouble}}+ 3
(}}3 4
dr}}4 6
[}}6 7
$str}}7 A
]}}A B
)}}B C
}~~ 
;~~ 
list 
. 
Add 
( 
temp !
)! "
;" #
}
ÄÄ 
}
ÇÇ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
e
ÉÉ 
)
ÉÉ 
{
ÑÑ 

MessageBox
ÖÖ 
.
ÖÖ 
Show
ÖÖ 
(
ÖÖ  
e
ÖÖ  !
.
ÖÖ! "
Message
ÖÖ" )
)
ÖÖ) *
;
ÖÖ* +
}
ÜÜ 
finally
áá 
{
àà 
cmd
ââ 
.
ââ 

Connection
ââ 
.
ââ 
Close
ââ $
(
ââ$ %
)
ââ% &
;
ââ& '
}
ää 
return
ãã 
list
ãã 
;
ãã 
}
åå 	
public
éé 
List
éé 
<
éé "
EntTemporaryProducts
éé (
>
éé( ))
MostrarTemporaryProductsCli
éé* E
(
ééE F
int
ééF I
	idUsuario
ééJ S
)
ééS T
{
èè 	

SqlCommand
êê 
cmd
êê 
=
êê 
null
êê !
;
êê! "
List
ëë 
<
ëë "
EntTemporaryProducts
ëë %
>
ëë% &
list
ëë' +
=
ëë, -
new
ëë. 1
List
ëë2 6
<
ëë6 7"
EntTemporaryProducts
ëë7 K
>
ëëK L
(
ëëL M
)
ëëM N
;
ëëN O
try
íí 
{
ìì 
SqlConnection
îî 
cn
îî  
=
îî! "
Conexion
îî# +
.
îî+ ,
	Instancia
îî, 5
.
îî5 6
Conectar
îî6 >
(
îî> ?
)
îî? @
;
îî@ A
cmd
ïï 
=
ïï 
new
ïï 

SqlCommand
ïï $
(
ïï$ %
$str
ïï% C
,
ïïC D
cn
ïïE G
)
ïïG H
;
ïïH I
cmd
ññ 
.
ññ 

Parameters
ññ 
.
ññ 
AddWithValue
ññ +
(
ññ+ ,
$str
ññ, 8
,
ññ8 9
	idUsuario
ññ: C
)
ññC D
;
ññD E
cmd
óó 
.
óó 
CommandType
óó 
=
óó  !
CommandType
óó" -
.
óó- .
StoredProcedure
óó. =
;
óó= >
cn
òò 
.
òò 
Open
òò 
(
òò 
)
òò 
;
òò 
SqlDataReader
ôô 
dr
ôô  
=
ôô! "
cmd
ôô# &
.
ôô& '
ExecuteReader
ôô' 4
(
ôô4 5
)
ôô5 6
;
ôô6 7
while
öö 
(
öö 
dr
öö 
.
öö 
Read
öö 
(
öö 
)
öö  
)
öö  !
{
õõ "
EntTemporaryProducts
úú (
temp
úú) -
=
úú. /
new
úú0 3"
EntTemporaryProducts
úú4 H
{
ùù 
IdTemp
ûû 
=
ûû  
Convert
ûû! (
.
ûû( )
ToInt32
ûû) 0
(
ûû0 1
dr
ûû1 3
[
ûû3 4
$str
ûû4 <
]
ûû< =
)
ûû= >
,
ûû> ?
ProveedorProducto
üü )
=
üü* +
new
üü, /"
EntProveedorProducto
üü0 D
{
†† 
Producto
°° $
=
°°% &
new
°°' *
EntProducto
°°+ 6
{
¢¢ 

IdProducto
££  *
=
££+ ,
Convert
££- 4
.
££4 5
ToInt32
££5 <
(
££< =
dr
££= ?
[
££? @
$str
££@ L
]
££L M
)
££M N
,
££N O
Nombre
§§  &
=
§§' (
dr
§§) +
[
§§+ ,
$str
§§, 4
]
§§4 5
.
§§5 6
ToString
§§6 >
(
§§> ?
)
§§? @
,
§§@ A
Longitud
••  (
=
••) *
Convert
••+ 2
.
••2 3
ToDouble
••3 ;
(
••; <
dr
••< >
[
••> ?
$str
••? I
]
••I J
)
••J K
,
••K L
Diametro
¶¶  (
=
¶¶) *
Convert
¶¶+ 2
.
¶¶2 3
ToDouble
¶¶3 ;
(
¶¶; <
dr
¶¶< >
[
¶¶> ?
$str
¶¶? I
]
¶¶I J
)
¶¶J K
,
¶¶K L
PrecioVenta
ßß  +
=
ßß, -
Convert
ßß. 5
.
ßß5 6
ToDouble
ßß6 >
(
ßß> ?
dr
ßß? A
[
ßßA B
$str
ßßB O
]
ßßO P
)
ßßP Q
,
ßßQ R
Tipo
®®  $
=
®®% &
new
®®' *
EntTipoProducto
®®+ :
{
©©  !
Nombre
™™$ *
=
™™+ ,
dr
™™- /
[
™™/ 0
$str
™™0 6
]
™™6 7
.
™™7 8
ToString
™™8 @
(
™™@ A
)
™™A B
}
´´  !
}
¨¨ 
,
¨¨ 
}
≠≠ 
,
≠≠ 
Cantidad
ÆÆ  
=
ÆÆ! "
Convert
ÆÆ# *
.
ÆÆ* +
ToInt32
ÆÆ+ 2
(
ÆÆ2 3
dr
ÆÆ3 5
[
ÆÆ5 6
$str
ÆÆ6 @
]
ÆÆ@ A
)
ÆÆA B
,
ÆÆB C
Subtotal
ØØ  
=
ØØ! "
Convert
ØØ# *
.
ØØ* +
ToDouble
ØØ+ 3
(
ØØ3 4
dr
ØØ4 6
[
ØØ6 7
$str
ØØ7 A
]
ØØA B
)
ØØB C
}
∞∞ 
;
∞∞ 
list
±± 
.
±± 
Add
±± 
(
±± 
temp
±± !
)
±±! "
;
±±" #
}
≤≤ 
}
¥¥ 
catch
µµ 
(
µµ 
	Exception
µµ 
e
µµ 
)
µµ 
{
∂∂ 

MessageBox
∑∑ 
.
∑∑ 
Show
∑∑ 
(
∑∑  
e
∑∑  !
.
∑∑! "
Message
∑∑" )
)
∑∑) *
;
∑∑* +
}
∏∏ 
finally
ππ 
{
∫∫ 
cmd
ªª 
.
ªª 

Connection
ªª 
.
ªª 
Close
ªª $
(
ªª$ %
)
ªª% &
;
ªª& '
}
ºº 
return
ΩΩ 
list
ΩΩ 
;
ΩΩ 
}
ææ 	
public
¡¡ 
bool
¡¡ '
EliminarTemporaryProducts
¡¡ -
(
¡¡- .
int
¡¡. 1
idtemp
¡¡2 8
)
¡¡8 9
{
¬¬ 	

SqlCommand
√√ 
cmd
√√ 
=
√√ 
null
√√ !
;
√√! "
bool
ƒƒ 
	eliminado
ƒƒ 
=
ƒƒ 
false
ƒƒ "
;
ƒƒ" #
try
≈≈ 
{
∆∆ 
SqlConnection
«« 
cn
««  
=
««! "
Conexion
««# +
.
««+ ,
	Instancia
««, 5
.
««5 6
Conectar
««6 >
(
««> ?
)
««? @
;
««@ A
cmd
»» 
=
»» 
new
»» 

SqlCommand
»» $
(
»»$ %
$str
»»% B
,
»»B C
cn
»»D F
)
»»F G
;
»»G H
cmd
…… 
.
…… 
CommandType
…… 
=
……  !
CommandType
……" -
.
……- .
StoredProcedure
……. =
;
……= >
cmd
   
.
   

Parameters
   
.
   
AddWithValue
   +
(
  + ,
$str
  , 2
,
  2 3
idtemp
  4 :
)
  : ;
;
  ; <
cn
ÀÀ 
.
ÀÀ 
Open
ÀÀ 
(
ÀÀ 
)
ÀÀ 
;
ÀÀ 
int
ÃÃ 
i
ÃÃ 
=
ÃÃ 
cmd
ÃÃ 
.
ÃÃ 
ExecuteNonQuery
ÃÃ +
(
ÃÃ+ ,
)
ÃÃ, -
;
ÃÃ- .
if
ÕÕ 
(
ÕÕ 
i
ÕÕ 
>
ÕÕ 
$num
ÕÕ 
)
ÕÕ 
{
ŒŒ 
	eliminado
œœ 
=
œœ 
true
œœ  $
;
œœ$ %
}
–– 
}
—— 
catch
““ 
(
““ 
	Exception
““ 
e
““ 
)
““ 
{
”” 

MessageBox
’’ 
.
’’ 
Show
’’ 
(
’’  
e
’’  !
.
’’! "
Message
’’" )
)
’’) *
;
’’* +
}
÷÷ 
finally
◊◊ 
{
ÿÿ 
cmd
ŸŸ 
.
ŸŸ 

Connection
ŸŸ 
.
ŸŸ 
Close
ŸŸ $
(
ŸŸ$ %
)
ŸŸ% &
;
ŸŸ& '
}
⁄⁄ 
return
€€ 
	eliminado
€€ 
;
€€ 
}
›› 	
public
ﬂﬂ 
bool
ﬂﬂ )
ActualizarTemporaryProducts
ﬂﬂ /
(
ﬂﬂ/ 0"
EntTemporaryProducts
ﬂﬂ0 D
temp
ﬂﬂE I
)
ﬂﬂI J
{
‡‡ 	

SqlCommand
·· 
cmd
·· 
=
·· 
null
·· !
;
··! "
bool
‚‚ 
actualizado
‚‚ 
=
‚‚ 
false
‚‚ $
;
‚‚$ %
try
„„ 
{
‰‰ 
SqlConnection
ÂÂ 
cn
ÂÂ  
=
ÂÂ! "
Conexion
ÂÂ# +
.
ÂÂ+ ,
	Instancia
ÂÂ, 5
.
ÂÂ5 6
Conectar
ÂÂ6 >
(
ÂÂ> ?
)
ÂÂ? @
;
ÂÂ@ A
cmd
ÊÊ 
=
ÊÊ 
new
ÊÊ 

SqlCommand
ÊÊ $
(
ÊÊ$ %
$str
ÊÊ% @
,
ÊÊ@ A
cn
ÊÊB D
)
ÊÊD E
{
ÁÁ 
CommandType
ËË 
=
ËË  !
CommandType
ËË" -
.
ËË- .
StoredProcedure
ËË. =
}
ÈÈ 
;
ÈÈ 
cmd
ÍÍ 
.
ÍÍ 

Parameters
ÍÍ 
.
ÍÍ 
AddWithValue
ÍÍ +
(
ÍÍ+ ,
$str
ÍÍ, 5
,
ÍÍ5 6
temp
ÍÍ7 ;
.
ÍÍ; <
IdTemp
ÍÍ< B
)
ÍÍB C
;
ÍÍC D
cmd
ÎÎ 
.
ÎÎ 

Parameters
ÎÎ 
.
ÎÎ 
AddWithValue
ÎÎ +
(
ÎÎ+ ,
$str
ÎÎ, 7
,
ÎÎ7 8
temp
ÎÎ9 =
.
ÎÎ= >
Cantidad
ÎÎ> F
)
ÎÎF G
;
ÎÎG H
cn
ÏÏ 
.
ÏÏ 
Open
ÏÏ 
(
ÏÏ 
)
ÏÏ 
;
ÏÏ 
int
ÌÌ 
i
ÌÌ 
=
ÌÌ 
cmd
ÌÌ 
.
ÌÌ 
ExecuteNonQuery
ÌÌ +
(
ÌÌ+ ,
)
ÌÌ, -
;
ÌÌ- .
if
ÓÓ 
(
ÓÓ 
i
ÓÓ 
>
ÓÓ 
$num
ÓÓ 
)
ÓÓ 
{
ÔÔ 
actualizado
 
=
  !
true
" &
;
& '
}
ÒÒ 
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
e
ÛÛ 
)
ÛÛ 
{
ÙÙ 

MessageBox
ˆˆ 
.
ˆˆ 
Show
ˆˆ 
(
ˆˆ  
e
ˆˆ  !
.
ˆˆ! "
Message
ˆˆ" )
)
ˆˆ) *
;
ˆˆ* +
}
˜˜ 
finally
¯¯ 
{
˘˘ 
cmd
˙˙ 
.
˙˙ 

Connection
˙˙ 
.
˙˙ 
Close
˙˙ $
(
˙˙$ %
)
˙˙% &
;
˙˙& '
}
˚˚ 
return
¸¸ 
actualizado
¸¸ 
;
¸¸ 
}
˝˝ 	
public
ˇˇ "
EntTemporaryProducts
ˇˇ #'
BuscarTemporaryProductsId
ˇˇ$ =
(
ˇˇ= >
int
ˇˇ> A
id
ˇˇB D
)
ˇˇD E
{
ÄÄ 	

SqlCommand
ÅÅ 
cmd
ÅÅ 
=
ÅÅ 
null
ÅÅ !
;
ÅÅ! ""
EntTemporaryProducts
ÇÇ  
temp
ÇÇ! %
=
ÇÇ& '
new
ÇÇ( +"
EntTemporaryProducts
ÇÇ, @
(
ÇÇ@ A
)
ÇÇA B
;
ÇÇB C
try
ÉÉ 
{
ÑÑ 
SqlConnection
ÖÖ 
cn
ÖÖ  
=
ÖÖ! "
Conexion
ÖÖ# +
.
ÖÖ+ ,
	Instancia
ÖÖ, 5
.
ÖÖ5 6
Conectar
ÖÖ6 >
(
ÖÖ> ?
)
ÖÖ? @
;
ÖÖ@ A
cmd
ÜÜ 
=
ÜÜ 
new
ÜÜ 

SqlCommand
ÜÜ $
(
ÜÜ$ %
$str
ÜÜ% @
,
ÜÜ@ A
cn
ÜÜB D
)
ÜÜD E
{
áá 
CommandType
àà 
=
àà  !
CommandType
àà" -
.
àà- .
StoredProcedure
àà. =
}
ââ 
;
ââ 
cmd
ää 
.
ää 

Parameters
ää 
.
ää 
AddWithValue
ää +
(
ää+ ,
$str
ää, 5
,
ää5 6
id
ää7 9
)
ää9 :
;
ää: ;
cn
ãã 
.
ãã 
Open
ãã 
(
ãã 
)
ãã 
;
ãã 
SqlDataReader
åå 
dr
åå  
=
åå! "
cmd
åå# &
.
åå& '
ExecuteReader
åå' 4
(
åå4 5
)
åå5 6
;
åå6 7
while
çç 
(
çç 
dr
çç 
.
çç 
Read
çç 
(
çç 
)
çç  
)
çç  !
{
éé 
temp
èè 
.
èè 
IdTemp
èè 
=
èè  !
Convert
èè" )
.
èè) *
ToInt32
èè* 1
(
èè1 2
dr
èè2 4
[
èè4 5
$str
èè5 =
]
èè= >
)
èè> ?
;
èè? @
temp
êê 
.
êê 
ProveedorProducto
êê *
=
êê+ ,
new
êê- 0"
EntProveedorProducto
êê1 E
{
ëë 
	Proveedor
íí !
=
íí" #
new
íí$ '
EntProveedor
íí( 4
{
ìì 
IdProveedor
îî '
=
îî( )
Convert
îî* 1
.
îî1 2
ToInt32
îî2 9
(
îî9 :
dr
îî: <
[
îî< =
$str
îî= J
]
îîJ K
)
îîK L
,
îîL M
RazonSocial
ïï '
=
ïï( )
dr
ïï* ,
[
ïï, -
$str
ïï- :
]
ïï: ;
.
ïï; <
ToString
ïï< D
(
ïïD E
)
ïïE F
,
ïïF G
Descripcion
ññ '
=
ññ( )
dr
ññ* ,
[
ññ, -
$str
ññ- :
]
ññ: ;
.
ññ; <
ToString
ññ< D
(
ññD E
)
ññE F
}
óó 
,
óó 
Producto
òò  
=
òò! "
new
òò# &
EntProducto
òò' 2
{
ôô 
Nombre
öö "
=
öö# $
dr
öö% '
[
öö' (
$str
öö( 0
]
öö0 1
.
öö1 2
ToString
öö2 :
(
öö: ;
)
öö; <
,
öö< =
Longitud
õõ $
=
õõ% &
Convert
õõ' .
.
õõ. /
ToDouble
õõ/ 7
(
õõ7 8
dr
õõ8 :
[
õõ: ;
$str
õõ; E
]
õõE F
)
õõF G
,
õõG H
Diametro
úú $
=
úú% &
Convert
úú' .
.
úú. /
ToDouble
úú/ 7
(
úú7 8
dr
úú8 :
[
úú: ;
$str
úú; E
]
úúE F
)
úúF G
,
úúG H
Tipo
ùù  
=
ùù! "
new
ùù# &
EntTipoProducto
ùù' 6
{
ûû 
IdTipo_producto
üü  /
=
üü/ 0
Convert
üü1 8
.
üü8 9
ToInt32
üü9 @
(
üü@ A
dr
üüA C
[
üüC D
$str
üüD U
]
üüU V
)
üüV W
,
üüW X
Nombre
††  &
=
††' (
dr
††) +
[
††+ ,
$str
††, 2
]
††2 3
.
††3 4
ToString
††4 <
(
††< =
)
††= >
}
°° 
}
¢¢ 
,
¢¢ 
PrecioCompra
££ $
=
££% &
Convert
££' .
.
££. /
ToDouble
££/ 7
(
££7 8
dr
££8 :
[
££: ;
$str
££; I
]
££I J
)
££J K
,
££K L
}
¶¶ 
;
¶¶ 
temp
®® 
.
®® 
Cantidad
®® !
=
®®" #
Convert
®®$ +
.
®®+ ,
ToInt32
®®, 3
(
®®3 4
dr
®®4 6
[
®®6 7
$str
®®7 A
]
®®A B
)
®®B C
;
®®C D
temp
©© 
.
©© 
Subtotal
©© !
=
©©" #
Convert
©©$ +
.
©©+ ,
ToDouble
©©, 4
(
©©4 5
dr
©©5 7
[
©©7 8
$str
©©8 B
]
©©B C
)
©©C D
;
©©D E
}
´´ 
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
e
ÆÆ 
)
ÆÆ 
{
ØØ 

MessageBox
∞∞ 
.
∞∞ 
Show
∞∞ 
(
∞∞  
e
∞∞  !
.
∞∞! "
Message
∞∞" )
)
∞∞) *
;
∞∞* +
}
±± 
finally
≤≤ 
{
≤≤ 
cmd
≤≤ 
.
≤≤ 

Connection
≤≤ $
.
≤≤$ %
Close
≤≤% *
(
≤≤* +
)
≤≤+ ,
;
≤≤, -
}
≤≤. /
return
¥¥ 
temp
¥¥ 
;
¥¥ 
}
µµ 	
public
∂∂ "
EntTemporaryProducts
∂∂ #*
BuscarTemporaryProductsIdCli
∂∂$ @
(
∂∂@ A
int
∂∂A D
id
∂∂E G
)
∂∂G H
{
∑∑ 	

SqlCommand
∏∏ 
cmd
∏∏ 
=
∏∏ 
null
∏∏ !
;
∏∏! ""
EntTemporaryProducts
ππ  
temp
ππ! %
=
ππ& '
new
ππ( +"
EntTemporaryProducts
ππ, @
(
ππ@ A
)
ππA B
;
ππB C
try
∫∫ 
{
ªª 
SqlConnection
ºº 
cn
ºº  
=
ºº! "
Conexion
ºº# +
.
ºº+ ,
	Instancia
ºº, 5
.
ºº5 6
Conectar
ºº6 >
(
ºº> ?
)
ºº? @
;
ºº@ A
cmd
ΩΩ 
=
ΩΩ 
new
ΩΩ 

SqlCommand
ΩΩ $
(
ΩΩ$ %
$str
ΩΩ% C
,
ΩΩC D
cn
ΩΩE G
)
ΩΩG H
{
ææ 
CommandType
øø 
=
øø  !
CommandType
øø" -
.
øø- .
StoredProcedure
øø. =
}
¿¿ 
;
¿¿ 
cmd
¡¡ 
.
¡¡ 

Parameters
¡¡ 
.
¡¡ 
AddWithValue
¡¡ +
(
¡¡+ ,
$str
¡¡, 5
,
¡¡5 6
id
¡¡7 9
)
¡¡9 :
;
¡¡: ;
cn
¬¬ 
.
¬¬ 
Open
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
SqlDataReader
√√ 
dr
√√  
=
√√! "
cmd
√√# &
.
√√& '
ExecuteReader
√√' 4
(
√√4 5
)
√√5 6
;
√√6 7
while
ƒƒ 
(
ƒƒ 
dr
ƒƒ 
.
ƒƒ 
Read
ƒƒ 
(
ƒƒ 
)
ƒƒ  
)
ƒƒ  !
{
≈≈ 
temp
∆∆ 
.
∆∆ 
IdTemp
∆∆ 
=
∆∆  !
Convert
∆∆" )
.
∆∆) *
ToInt32
∆∆* 1
(
∆∆1 2
dr
∆∆2 4
[
∆∆4 5
$str
∆∆5 =
]
∆∆= >
)
∆∆> ?
;
∆∆? @
temp
«« 
.
«« 
ProveedorProducto
«« *
=
««+ ,
new
««- 0"
EntProveedorProducto
««1 E
{
»» 
	Proveedor
…… !
=
……" #
new
……$ '
EntProveedor
……( 4
{
   
IdProveedor
ÀÀ '
=
ÀÀ( )
Convert
ÀÀ* 1
.
ÀÀ1 2
ToInt32
ÀÀ2 9
(
ÀÀ9 :
dr
ÀÀ: <
[
ÀÀ< =
$str
ÀÀ= J
]
ÀÀJ K
)
ÀÀK L
,
ÀÀL M
RazonSocial
ÃÃ '
=
ÃÃ( )
dr
ÃÃ* ,
[
ÃÃ, -
$str
ÃÃ- :
]
ÃÃ: ;
.
ÃÃ; <
ToString
ÃÃ< D
(
ÃÃD E
)
ÃÃE F
,
ÃÃF G
Descripcion
ÕÕ '
=
ÕÕ( )
dr
ÕÕ* ,
[
ÕÕ, -
$str
ÕÕ- :
]
ÕÕ: ;
.
ÕÕ; <
ToString
ÕÕ< D
(
ÕÕD E
)
ÕÕE F
}
ŒŒ 
,
ŒŒ 
Producto
œœ  
=
œœ! "
new
œœ# &
EntProducto
œœ' 2
{
–– 
Nombre
—— "
=
——# $
dr
——% '
[
——' (
$str
——( 0
]
——0 1
.
——1 2
ToString
——2 :
(
——: ;
)
——; <
,
——< =
Longitud
““ $
=
““% &
Convert
““' .
.
““. /
ToDouble
““/ 7
(
““7 8
dr
““8 :
[
““: ;
$str
““; E
]
““E F
)
““F G
,
““G H
Diametro
”” $
=
””% &
Convert
””' .
.
””. /
ToDouble
””/ 7
(
””7 8
dr
””8 :
[
””: ;
$str
””; E
]
””E F
)
””F G
,
””G H
Tipo
‘‘  
=
‘‘! "
new
‘‘# &
EntTipoProducto
‘‘' 6
{
’’ 
IdTipo_producto
÷÷  /
=
÷÷0 1
Convert
÷÷2 9
.
÷÷9 :
ToInt32
÷÷: A
(
÷÷A B
dr
÷÷B D
[
÷÷D E
$str
÷÷E V
]
÷÷V W
)
÷÷W X
,
÷÷X Y
Nombre
◊◊  &
=
◊◊' (
dr
◊◊) +
[
◊◊+ ,
$str
◊◊, 2
]
◊◊2 3
.
◊◊3 4
ToString
◊◊4 <
(
◊◊< =
)
◊◊= >
}
ÿÿ 
}
ŸŸ 
,
ŸŸ 
PrecioCompra
⁄⁄ $
=
⁄⁄% &
Convert
⁄⁄' .
.
⁄⁄. /
ToDouble
⁄⁄/ 7
(
⁄⁄7 8
dr
⁄⁄8 :
[
⁄⁄: ;
$str
⁄⁄; I
]
⁄⁄I J
)
⁄⁄J K
,
⁄⁄K L
}
›› 
;
›› 
temp
ﬂﬂ 
.
ﬂﬂ 
Cantidad
ﬂﬂ !
=
ﬂﬂ" #
Convert
ﬂﬂ$ +
.
ﬂﬂ+ ,
ToInt32
ﬂﬂ, 3
(
ﬂﬂ3 4
dr
ﬂﬂ4 6
[
ﬂﬂ6 7
$str
ﬂﬂ7 A
]
ﬂﬂA B
)
ﬂﬂB C
;
ﬂﬂC D
temp
‡‡ 
.
‡‡ 
Subtotal
‡‡ !
=
‡‡" #
Convert
‡‡$ +
.
‡‡+ ,
ToDouble
‡‡, 4
(
‡‡4 5
dr
‡‡5 7
[
‡‡7 8
$str
‡‡8 B
]
‡‡B C
)
‡‡C D
;
‡‡D E
}
‚‚ 
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
e
ÂÂ 
)
ÂÂ 
{
ÊÊ 

MessageBox
ÁÁ 
.
ÁÁ 
Show
ÁÁ 
(
ÁÁ  
e
ÁÁ  !
.
ÁÁ! "
Message
ÁÁ" )
)
ÁÁ) *
;
ÁÁ* +
}
ËË 
finally
ÈÈ 
{
ÈÈ 
cmd
ÈÈ 
.
ÈÈ 

Connection
ÈÈ $
.
ÈÈ$ %
Close
ÈÈ% *
(
ÈÈ* +
)
ÈÈ+ ,
;
ÈÈ, -
}
ÈÈ. /
return
ÎÎ 
temp
ÎÎ 
;
ÎÎ 
}
ÏÏ 	
}
ÌÌ 
}ÔÔ êÃ
[C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatUsuario.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 

DatUsuario 
: 
IDatUsuario (
{ 
public 
bool 
CrearCliente  
(  !

EntUsuario! +
Cli, /
)/ 0
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 5
,5 6
cn7 9
)9 :
;: ;
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
Cli< ?
.? @
RazonSocial@ K
)K L
;L M
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
Cli7 :
.: ;
Correo; A
)A B
;B C
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Cli9 <
.< =
UserName= E
)E F
;F G
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 3
,3 4
Cli5 8
.8 9
Pass9 =
)= >
;> ?
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
Cli6 9
.9 :
Roll: >
.> ?
IdRoll? E
)E F
;F G
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 7
,  7 8
Cli  9 <
.  < =
Ubigeo  = C
.  C D
IdUbigeo  D L
)  L M
;  M N
cn!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
int"" 
i"" 
="" 
cmd"" 
."" 
ExecuteNonQuery"" +
(""+ ,
)"", -
;""- .
if## 
(## 
i## 
>## 
$num## 
)## 
creado$$ 
=$$ 
true$$ !
;$$! "
}%% 
catch&& 
(&& 
	Exception&& 
e&& 
)&& 
{'' 
throw(( 
new(( 
	Exception(( #
(((# $
e(($ %
.((% &
Message((& -
)((- .
;((. /
})) 
return** 
creado** 
;** 
}++ 	
public,, 
List,, 
<,, 

EntUsuario,, 
>,, 
ListarCliente,,  -
(,,- .
),,. /
{-- 	

SqlCommand.. 
cmd.. 
=.. 
null.. !
;..! "
List// 
<// 

EntUsuario// 
>// 
lista// "
=//# $
new//% (
List//) -
<//- .

EntUsuario//. 8
>//8 9
(//9 :
)//: ;
;//; <
try00 
{11 
SqlConnection22 
cn22  
=22! "
Conexion22# +
.22+ ,
	Instancia22, 5
.225 6
Conectar226 >
(22> ?
)22? @
;22@ A
cmd33 
=33 
new33 

SqlCommand33 $
(33$ %
$str33% 7
,337 8
cn339 ;
)33; <
;33< =
cmd44 
.44 
CommandType44 
=44  !
CommandType44" -
.44- .
StoredProcedure44. =
;44= >
cn55 
.55 
Open55 
(55 
)55 
;55 
SqlDataReader66 
dr66  
=66! "
cmd66# &
.66& '
ExecuteReader66' 4
(664 5
)665 6
;666 7
while77 
(77 
dr77 
.77 
Read77 
(77 
)77  
)77  !
{88 

EntUsuario99 
Cli99 "
=99# $
new99% (

EntUsuario99) 3
{:: 
	IdUsuario;; !
=;;" #
Convert;;$ +
.;;+ ,
ToInt32;;, 3
(;;3 4
dr;;4 6
[;;6 7
$str;;7 B
];;B C
);;C D
,;;D E
RazonSocial<< #
=<<$ %
dr<<& (
[<<( )
$str<<) 6
]<<6 7
.<<7 8
ToString<<8 @
(<<@ A
)<<A B
,<<B C
Telefono==  
===! "
dr==# %
[==% &
$str==& 0
]==0 1
.==1 2
ToString==2 :
(==: ;
)==; <
,==< =
	Direccion>> !
=>>" #
dr>>$ &
[>>& '
$str>>' 2
]>>2 3
.>>3 4
ToString>>4 <
(>>< =
)>>= >
,>>> ?
Correo?? 
=??  
dr??! #
[??# $
$str??$ ,
]??, -
.??- .
ToString??. 6
(??6 7
)??7 8
,??8 9
UserName@@  
=@@! "
dr@@# %
[@@% &
$str@@& 0
]@@0 1
.@@1 2
ToString@@2 :
(@@: ;
)@@; <
,@@< =
PassAA 
=AA 
drAA !
[AA! "
$strAA" (
]AA( )
.AA) *
ToStringAA* 2
(AA2 3
)AA3 4
,AA4 5
ActivoBB 
=BB  
ConvertBB! (
.BB( )
	ToBooleanBB) 2
(BB2 3
drBB3 5
[BB5 6
$strBB6 >
]BB> ?
)BB? @
}CC 
;CC 
	EntUbigeoDD 
uDD 
=DD  !
newDD" %
	EntUbigeoDD& /
{EE 
	ProvinciaFF !
=FF" #
drFF$ &
[FF& '
$strFF' 2
]FF2 3
.FF3 4
ToStringFF4 <
(FF< =
)FF= >
,FF> ?
}GG 
;GG 
listaJJ 
.JJ 
AddJJ 
(JJ 
CliJJ !
)JJ! "
;JJ" #
}KK 
}MM 
catchNN 
(NN 
	ExceptionNN 
eNN 
)NN 
{OO 

MessageBoxPP 
.PP 
ShowPP 
(PP  
ePP  !
.PP! "
MessagePP" )
,PP) *
$strPP+ F
,PPF G
MessageBoxButtonsPPH Y
.PPY Z
OKPPZ \
,PP\ ]
MessageBoxIconPP^ l
.PPl m
ErrorPPm r
)PPr s
;PPs t
}RR 
finallySS 
{TT 
cmdUU 
.UU 

ConnectionUU 
.UU 
CloseUU $
(UU$ %
)UU% &
;UU& '
}VV 
returnWW 
listaWW 
;WW 
}XX 	
publicZZ 
ListZZ 
<ZZ 

EntUsuarioZZ 
>ZZ 
BuscarClienteZZ  -
(ZZ- .
stringZZ. 4
busquedaZZ5 =
)ZZ= >
{[[ 	
List\\ 
<\\ 

EntUsuario\\ 
>\\ 
lista\\ "
=\\# $
new\\% (
List\\) -
<\\- .

EntUsuario\\. 8
>\\8 9
(\\9 :
)\\: ;
;\\; <

SqlCommand]] 
cmd]] 
=]] 
null]] !
;]]! "
try^^ 
{__ 
SqlConnection`` 
cn``  
=``! "
Conexion``# +
.``+ ,
	Instancia``, 5
.``5 6
Conectar``6 >
(``> ?
)``? @
;``@ A
cmdaa 
=aa 
newaa 

SqlCommandaa $
(aa$ %
$straa% 7
,aa7 8
cnaa9 ;
)aa; <
;aa< =
cmdbb 
.bb 
CommandTypebb 
=bb  !
CommandTypebb" -
.bb- .
StoredProcedurebb. =
;bb= >
cmdcc 
.cc 

Parameterscc 
.cc 
AddWithValuecc +
(cc+ ,
$strcc, 4
,cc4 5
busquedacc6 >
)cc> ?
;cc? @
cndd 
.dd 
Opendd 
(dd 
)dd 
;dd 
SqlDataReaderee 
dree  
=ee! "
cmdee# &
.ee& '
ExecuteReaderee' 4
(ee4 5
)ee5 6
;ee6 7
whileff 
(ff 
drff 
.ff 
Readff 
(ff 
)ff  
)ff  !
{gg 

EntUsuariohh 
Clihh "
=hh# $
newhh% (

EntUsuariohh) 3
{ii 
	IdUsuariojj !
=jj" #
Convertjj$ +
.jj+ ,
ToInt32jj, 3
(jj3 4
drjj4 6
[jj6 7
$strjj7 B
]jjB C
)jjC D
,jjD E
RazonSocialkk #
=kk$ %
drkk& (
[kk( )
$strkk) 6
]kk6 7
.kk7 8
ToStringkk8 @
(kk@ A
)kkA B
,kkB C
Telefonoll  
=ll! "
drll# %
[ll% &
$strll& 0
]ll0 1
.ll1 2
ToStringll2 :
(ll: ;
)ll; <
,ll< =
	Direccionmm !
=mm" #
drmm$ &
[mm& '
$strmm' 2
]mm2 3
.mm3 4
ToStringmm4 <
(mm< =
)mm= >
,mm> ?
Correonn 
=nn  
drnn! #
[nn# $
$strnn$ ,
]nn, -
.nn- .
ToStringnn. 6
(nn6 7
)nn7 8
,nn8 9
UserNameoo  
=oo! "
droo# %
[oo% &
$stroo& 0
]oo0 1
.oo1 2
ToStringoo2 :
(oo: ;
)oo; <
,oo< =
Passpp 
=pp 
drpp !
[pp! "
$strpp" (
]pp( )
.pp) *
ToStringpp* 2
(pp2 3
)pp3 4
,pp4 5
Activoqq 
=qq  
Convertqq! (
.qq( )
	ToBooleanqq) 2
(qq2 3
drqq3 5
[qq5 6
$strqq6 >
]qq> ?
)qq? @
}rr 
;rr 
	EntUbigeoss 
uss 
=ss  !
newss" %
	EntUbigeoss& /
{tt 
	Provinciauu !
=uu" #
druu$ &
[uu& '
$struu' 2
]uu2 3
.uu3 4
ToStringuu4 <
(uu< =
)uu= >
,uu> ?
}vv 
;vv 
Cliww 
.ww 
Ubigeoww 
=ww  
uww! "
;ww" #
listaxx 
.xx 
Addxx 
(xx 
Clixx !
)xx! "
;xx" #
}yy 
}zz 
catch{{ 
({{ 
	Exception{{ 
e{{ 
){{ 
{|| 

MessageBox~~ 
.~~ 
Show~~ 
(~~  
e~~  !
.~~! "
Message~~" )
,~~) *
$str~~+ c
,~~c d
MessageBoxButtons~~e v
.~~v w
OK~~w y
,~~y z
MessageBoxIcon	~~{ â
.
~~â ä
Error
~~ä è
)
~~è ê
;
~~ê ë
} 
finally
ÄÄ 
{
ÅÅ 
cmd
ÇÇ 
.
ÇÇ 

Connection
ÇÇ 
.
ÇÇ 
Close
ÇÇ $
(
ÇÇ$ %
)
ÇÇ% &
;
ÇÇ& '
}
ÉÉ 
return
ÑÑ 
lista
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
public
áá 
bool
áá 
EditarCliente
áá !
(
áá! "

EntUsuario
áá" ,
u
áá- .
)
áá. /
{
àà 	

SqlCommand
ââ 
cmd
ââ 
=
ââ 
null
ââ !
;
ââ! "
bool
ää 
	actualiza
ää 
=
ää 
false
ää "
;
ää" #
try
ãã 
{
åå 
SqlConnection
çç 
cn
çç  
=
çç! "
Conexion
çç# +
.
çç+ ,
	Instancia
çç, 5
.
çç5 6
Conectar
çç6 >
(
çç> ?
)
çç? @
;
çç@ A
cmd
éé 
=
éé 
new
éé 

SqlCommand
éé $
(
éé$ %
$str
éé% :
,
éé: ;
cn
éé< >
)
éé> ?
;
éé? @
cmd
èè 
.
èè 
CommandType
èè 
=
èè  !
CommandType
èè" -
.
èè- .
StoredProcedure
èè. =
;
èè= >
cmd
êê 
.
êê 

Parameters
êê 
.
êê 
AddWithValue
êê +
(
êê+ ,
$str
êê, 8
,
êê8 9
u
êê: ;
.
êê; <
	IdUsuario
êê< E
)
êêE F
;
êêF G
cmd
ëë 
.
ëë 

Parameters
ëë 
.
ëë 
AddWithValue
ëë +
(
ëë+ ,
$str
ëë, :
,
ëë: ;
u
ëë< =
.
ëë= >
RazonSocial
ëë> I
)
ëëI J
;
ëëJ K
cmd
íí 
.
íí 

Parameters
íí 
.
íí 
AddWithValue
íí +
(
íí+ ,
$str
íí, 7
,
íí7 8
u
íí9 :
.
íí: ;
UserName
íí; C
)
ííC D
;
ííD E
cmd
ìì 
.
ìì 

Parameters
ìì 
.
ìì 
AddWithValue
ìì +
(
ìì+ ,
$str
ìì, 5
,
ìì5 6
u
ìì7 8
.
ìì8 9
Activo
ìì9 ?
)
ìì? @
;
ìì@ A
cn
îî 
.
îî 
Open
îî 
(
îî 
)
îî 
;
îî 
int
ïï 
i
ïï 
=
ïï 
cmd
ïï 
.
ïï 
ExecuteNonQuery
ïï +
(
ïï+ ,
)
ïï, -
;
ïï- .
if
ññ 
(
ññ 
i
ññ 
>
ññ 
$num
ññ 
)
ññ 
{
óó 
	actualiza
òò 
=
òò 
true
òò  $
;
òò$ %
}
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
e
õõ 
)
õõ 
{
úú 

MessageBox
ùù 
.
ùù 
Show
ùù 
(
ùù  
e
ùù  !
.
ùù! "
Message
ùù" )
)
ùù) *
;
ùù* +
}
ûû 
finally
üü 
{
üü 
cmd
üü 
.
üü 

Connection
üü $
.
üü$ %
Close
üü% *
(
üü* +
)
üü+ ,
;
üü, -
}
üü. /
return
°° 
	actualiza
°° 
;
°° 
}
££ 	
public
¶¶ 
List
¶¶ 
<
¶¶ 

EntUsuario
¶¶ 
>
¶¶ #
ListarAdministradores
¶¶  5
(
¶¶5 6
)
¶¶6 7
{
ßß 	

SqlCommand
®® 
cmd
®® 
=
®® 
null
®® !
;
®®! "
List
©© 
<
©© 

EntUsuario
©© 
>
©© 
lista
©© "
=
©©# $
new
©©% (
List
©©) -
<
©©- .

EntUsuario
©©. 8
>
©©8 9
(
©©9 :
)
©©: ;
;
©©; <
try
™™ 
{
´´ 
SqlConnection
¨¨ 
cn
¨¨  
=
¨¨! "
Conexion
¨¨# +
.
¨¨+ ,
	Instancia
¨¨, 5
.
¨¨5 6
Conectar
¨¨6 >
(
¨¨> ?
)
¨¨? @
;
¨¨@ A
cmd
≠≠ 
=
≠≠ 
new
≠≠ 

SqlCommand
≠≠ $
(
≠≠$ %
$str
≠≠% >
,
≠≠> ?
cn
≠≠@ B
)
≠≠B C
;
≠≠C D
cmd
ÆÆ 
.
ÆÆ 
CommandType
ÆÆ 
=
ÆÆ  !
CommandType
ÆÆ" -
.
ÆÆ- .
StoredProcedure
ÆÆ. =
;
ÆÆ= >
cn
ØØ 
.
ØØ 
Open
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
SqlDataReader
∞∞ 
dr
∞∞  
=
∞∞! "
cmd
∞∞# &
.
∞∞& '
ExecuteReader
∞∞' 4
(
∞∞4 5
)
∞∞5 6
;
∞∞6 7
while
±± 
(
±± 
dr
±± 
.
±± 
Read
±± 
(
±± 
)
±±  
)
±±  !
{
≤≤ 

EntUsuario
≥≥ 
Cli
≥≥ "
=
≥≥# $
new
≥≥% (

EntUsuario
≥≥) 3
{
¥¥ 
	IdUsuario
µµ !
=
µµ" #
Convert
µµ$ +
.
µµ+ ,
ToInt32
µµ, 3
(
µµ3 4
dr
µµ4 6
[
µµ6 7
$str
µµ7 B
]
µµB C
)
µµC D
,
µµD E
RazonSocial
∂∂ #
=
∂∂$ %
dr
∂∂& (
[
∂∂( )
$str
∂∂) 6
]
∂∂6 7
.
∂∂7 8
ToString
∂∂8 @
(
∂∂@ A
)
∂∂A B
,
∂∂B C
Telefono
∑∑  
=
∑∑! "
dr
∑∑# %
[
∑∑% &
$str
∑∑& 0
]
∑∑0 1
.
∑∑1 2
ToString
∑∑2 :
(
∑∑: ;
)
∑∑; <
,
∑∑< =
	Direccion
∏∏ !
=
∏∏" #
dr
∏∏$ &
[
∏∏& '
$str
∏∏' 2
]
∏∏2 3
.
∏∏3 4
ToString
∏∏4 <
(
∏∏< =
)
∏∏= >
,
∏∏> ?
Correo
ππ 
=
ππ  
dr
ππ! #
[
ππ# $
$str
ππ$ ,
]
ππ, -
.
ππ- .
ToString
ππ. 6
(
ππ6 7
)
ππ7 8
,
ππ8 9
UserName
∫∫  
=
∫∫! "
dr
∫∫# %
[
∫∫% &
$str
∫∫& 0
]
∫∫0 1
.
∫∫1 2
ToString
∫∫2 :
(
∫∫: ;
)
∫∫; <
,
∫∫< =
Pass
ªª 
=
ªª 
dr
ªª !
[
ªª! "
$str
ªª" (
]
ªª( )
.
ªª) *
ToString
ªª* 2
(
ªª2 3
)
ªª3 4
,
ªª4 5
Activo
ºº 
=
ºº  
Convert
ºº! (
.
ºº( )
	ToBoolean
ºº) 2
(
ºº2 3
dr
ºº3 5
[
ºº5 6
$str
ºº6 >
]
ºº> ?
)
ºº? @
}
ΩΩ 
;
ΩΩ 
	EntUbigeo
ææ 
u
ææ 
=
ææ  !
new
ææ" %
	EntUbigeo
ææ& /
{
øø 
	Provincia
¿¿ !
=
¿¿" #
dr
¿¿$ &
[
¿¿& '
$str
¿¿' 2
]
¿¿2 3
.
¿¿3 4
ToString
¿¿4 <
(
¿¿< =
)
¿¿= >
,
¿¿> ?
}
¡¡ 
;
¡¡ 
Cli
√√ 
.
√√ 
Ubigeo
√√ 
=
√√  
u
√√! "
;
√√" #
lista
ƒƒ 
.
ƒƒ 
Add
ƒƒ 
(
ƒƒ 
Cli
ƒƒ !
)
ƒƒ! "
;
ƒƒ" #
}
≈≈ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
e
»» 
)
»» 
{
…… 

MessageBox
   
.
   
Show
   
(
    
e
    !
.
  ! "
Message
  " )
,
  ) *
$str
  + F
,
  F G
MessageBoxButtons
  H Y
.
  Y Z
OK
  Z \
,
  \ ]
MessageBoxIcon
  ^ l
.
  l m
Error
  m r
)
  r s
;
  s t
}
ÃÃ 
finally
ÕÕ 
{
ŒŒ 
cmd
œœ 
.
œœ 

Connection
œœ 
.
œœ 
Close
œœ $
(
œœ$ %
)
œœ% &
;
œœ& '
}
–– 
return
—— 
lista
—— 
;
—— 
}
““ 	
public
‘‘ 
bool
‘‘ %
ActualizarAdministrador
‘‘ +
(
‘‘+ ,

EntUsuario
‘‘, 6
ad
‘‘7 9
)
‘‘9 :
{
’’ 	

SqlCommand
÷÷ 
cmd
÷÷ 
=
÷÷ 
null
÷÷ !
;
÷÷! "
bool
◊◊ 
actualizado
◊◊ 
=
◊◊ 
false
◊◊ $
;
◊◊$ %
try
ÿÿ 
{
ŸŸ 
SqlConnection
⁄⁄ 
cn
⁄⁄  
=
⁄⁄! "
Conexion
⁄⁄# +
.
⁄⁄+ ,
	Instancia
⁄⁄, 5
.
⁄⁄5 6
Conectar
⁄⁄6 >
(
⁄⁄> ?
)
⁄⁄? @
;
⁄⁄@ A
cmd
€€ 
=
€€ 
new
€€ 

SqlCommand
€€ $
(
€€$ %
$str
€€% @
,
€€@ A
cn
€€B D
)
€€D E
;
€€E F
cmd
‹‹ 
.
‹‹ 
CommandType
‹‹ 
=
‹‹  !
CommandType
‹‹" -
.
‹‹- .
StoredProcedure
‹‹. =
;
‹‹= >
cmd
›› 
.
›› 

Parameters
›› 
.
›› 
AddWithValue
›› +
(
››+ ,
$str
››, 8
,
››8 9
ad
››: <
.
››< =
	IdUsuario
››= F
)
››F G
;
››G H
cmd
ﬁﬁ 
.
ﬁﬁ 

Parameters
ﬁﬁ 
.
ﬁﬁ 
AddWithValue
ﬁﬁ +
(
ﬁﬁ+ ,
$str
ﬁﬁ, :
,
ﬁﬁ: ;
ad
ﬁﬁ< >
.
ﬁﬁ> ?
RazonSocial
ﬁﬁ? J
)
ﬁﬁJ K
;
ﬁﬁK L
cmd
ﬂﬂ 
.
ﬂﬂ 

Parameters
ﬂﬂ 
.
ﬂﬂ 
AddWithValue
ﬂﬂ +
(
ﬂﬂ+ ,
$str
ﬂﬂ, 7
,
ﬂﬂ7 8
ad
ﬂﬂ9 ;
.
ﬂﬂ; <
UserName
ﬂﬂ< D
)
ﬂﬂD E
;
ﬂﬂE F
cmd
‡‡ 
.
‡‡ 

Parameters
‡‡ 
.
‡‡ 
AddWithValue
‡‡ +
(
‡‡+ ,
$str
‡‡, 7
,
‡‡7 8
ad
‡‡9 ;
.
‡‡; <
Telefono
‡‡< D
)
‡‡D E
;
‡‡E F
cmd
·· 
.
·· 

Parameters
·· 
.
·· 
AddWithValue
·· +
(
··+ ,
$str
··, 8
,
··8 9
ad
··: <
.
··< =
	Direccion
··= F
)
··F G
;
··G H
cmd
‚‚ 
.
‚‚ 

Parameters
‚‚ 
.
‚‚ 
AddWithValue
‚‚ +
(
‚‚+ ,
$str
‚‚, 5
,
‚‚5 6
ad
‚‚7 9
.
‚‚9 :
Activo
‚‚: @
)
‚‚@ A
;
‚‚A B
cmd
„„ 
.
„„ 

Parameters
„„ 
.
„„ 
AddWithValue
„„ +
(
„„+ ,
$str
„„, 7
,
„„7 8
ad
„„9 ;
.
„„; <
Ubigeo
„„< B
.
„„B C
IdUbigeo
„„C K
)
„„K L
;
„„L M
cn
‰‰ 
.
‰‰ 
Open
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
int
ÂÂ 
i
ÂÂ 
=
ÂÂ 
cmd
ÂÂ 
.
ÂÂ 
ExecuteNonQuery
ÂÂ +
(
ÂÂ+ ,
)
ÂÂ, -
;
ÂÂ- .
if
ÊÊ 
(
ÊÊ 
i
ÊÊ 
>
ÊÊ 
$num
ÊÊ 
)
ÊÊ 
{
ÁÁ 
actualizado
ËË 
=
ËË  !
true
ËË" &
;
ËË& '
}
ÈÈ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
e
ÎÎ 
)
ÎÎ 
{
ÏÏ 

MessageBox
ÓÓ 
.
ÓÓ 
Show
ÓÓ 
(
ÓÓ  
e
ÓÓ  !
.
ÓÓ! "
Message
ÓÓ" )
)
ÓÓ) *
;
ÓÓ* +
}
ÔÔ 
finally
 
{
ÒÒ 
cmd
ÚÚ 
.
ÚÚ 

Connection
ÚÚ 
.
ÚÚ 
Close
ÚÚ $
(
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 
return
ÙÙ 
actualizado
ÙÙ 
;
ÙÙ 
}
ıı 	
public
˜˜ 
List
˜˜ 
<
˜˜ 

EntUsuario
˜˜ 
>
˜˜ $
BuscaraAdministradores
˜˜  6
(
˜˜6 7
string
˜˜7 =
busqueda
˜˜> F
)
˜˜F G
{
¯¯ 	
List
˘˘ 
<
˘˘ 

EntUsuario
˘˘ 
>
˘˘ 
lista
˘˘ "
=
˘˘# $
new
˘˘% (
List
˘˘) -
<
˘˘- .

EntUsuario
˘˘. 8
>
˘˘8 9
(
˘˘9 :
)
˘˘: ;
;
˘˘; <

SqlCommand
˙˙ 
cmd
˙˙ 
=
˙˙ 
null
˙˙ !
;
˙˙! "
try
˚˚ 
{
¸¸ 
SqlConnection
˝˝ 
cn
˝˝  
=
˝˝! "
Conexion
˝˝# +
.
˝˝+ ,
	Instancia
˝˝, 5
.
˝˝5 6
Conectar
˝˝6 >
(
˝˝> ?
)
˝˝? @
;
˝˝@ A
cmd
˛˛ 
=
˛˛ 
new
˛˛ 

SqlCommand
˛˛ $
(
˛˛$ %
$str
˛˛% >
,
˛˛> ?
cn
˛˛@ B
)
˛˛B C
;
˛˛C D
cmd
ˇˇ 
.
ˇˇ 
CommandType
ˇˇ 
=
ˇˇ  !
CommandType
ˇˇ" -
.
ˇˇ- .
StoredProcedure
ˇˇ. =
;
ˇˇ= >
cmd
ÄÄ 
.
ÄÄ 

Parameters
ÄÄ 
.
ÄÄ 
AddWithValue
ÄÄ +
(
ÄÄ+ ,
$str
ÄÄ, 4
,
ÄÄ4 5
busqueda
ÄÄ6 >
)
ÄÄ> ?
;
ÄÄ? @
cn
ÅÅ 
.
ÅÅ 
Open
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
SqlDataReader
ÇÇ 
dr
ÇÇ  
=
ÇÇ! "
cmd
ÇÇ# &
.
ÇÇ& '
ExecuteReader
ÇÇ' 4
(
ÇÇ4 5
)
ÇÇ5 6
;
ÇÇ6 7
while
ÉÉ 
(
ÉÉ 
dr
ÉÉ 
.
ÉÉ 
Read
ÉÉ 
(
ÉÉ 
)
ÉÉ  
)
ÉÉ  !
{
ÑÑ 

EntUsuario
ÖÖ 
Cli
ÖÖ "
=
ÖÖ# $
new
ÖÖ% (

EntUsuario
ÖÖ) 3
{
ÜÜ 
	IdUsuario
áá !
=
áá" #
Convert
áá$ +
.
áá+ ,
ToInt32
áá, 3
(
áá3 4
dr
áá4 6
[
áá6 7
$str
áá7 B
]
ááB C
)
ááC D
,
ááD E
RazonSocial
àà #
=
àà$ %
dr
àà& (
[
àà( )
$str
àà) 6
]
àà6 7
.
àà7 8
ToString
àà8 @
(
àà@ A
)
ààA B
,
ààB C
Telefono
ââ  
=
ââ! "
dr
ââ# %
[
ââ% &
$str
ââ& 0
]
ââ0 1
.
ââ1 2
ToString
ââ2 :
(
ââ: ;
)
ââ; <
,
ââ< =
	Direccion
ää !
=
ää" #
dr
ää$ &
[
ää& '
$str
ää' 2
]
ää2 3
.
ää3 4
ToString
ää4 <
(
ää< =
)
ää= >
,
ää> ?
Correo
ãã 
=
ãã  
dr
ãã! #
[
ãã# $
$str
ãã$ ,
]
ãã, -
.
ãã- .
ToString
ãã. 6
(
ãã6 7
)
ãã7 8
,
ãã8 9
UserName
åå  
=
åå! "
dr
åå# %
[
åå% &
$str
åå& 0
]
åå0 1
.
åå1 2
ToString
åå2 :
(
åå: ;
)
åå; <
,
åå< =
Pass
çç 
=
çç 
dr
çç !
[
çç! "
$str
çç" (
]
çç( )
.
çç) *
ToString
çç* 2
(
çç2 3
)
çç3 4
,
çç4 5
Activo
éé 
=
éé  
Convert
éé! (
.
éé( )
	ToBoolean
éé) 2
(
éé2 3
dr
éé3 5
[
éé5 6
$str
éé6 >
]
éé> ?
)
éé? @
}
èè 
;
èè 
	EntUbigeo
êê 
u
êê 
=
êê  !
new
êê" %
	EntUbigeo
êê& /
{
ëë 
	Provincia
íí !
=
íí" #
dr
íí$ &
[
íí& '
$str
íí' 2
]
íí2 3
.
íí3 4
ToString
íí4 <
(
íí< =
)
íí= >
,
íí> ?
}
ìì 
;
ìì 
Cli
îî 
.
îî 
Ubigeo
îî 
=
îî  
u
îî! "
;
îî" #
lista
ïï 
.
ïï 
Add
ïï 
(
ïï 
Cli
ïï !
)
ïï! "
;
ïï" #
}
ññ 
}
óó 
catch
òò 
(
òò 
	Exception
òò 
e
òò 
)
òò 
{
ôô 

MessageBox
õõ 
.
õõ 
Show
õõ 
(
õõ  
e
õõ  !
.
õõ! "
Message
õõ" )
,
õõ) *
$str
õõ+ c
,
õõc d
MessageBoxButtons
õõe v
.
õõv w
OK
õõw y
,
õõy z
MessageBoxIconõõ{ â
.õõâ ä
Errorõõä è
)õõè ê
;õõê ë
}
úú 
finally
ùù 
{
ûû 
cmd
üü 
.
üü 

Connection
üü 
.
üü 
Close
üü $
(
üü$ %
)
üü% &
;
üü& '
}
†† 
return
°° 
lista
°° 
;
°° 
}
¢¢ 	
public
•• 

EntUsuario
•• 
IniciarSesion
•• '
(
••' (
string
••( .
campo
••/ 4
,
••4 5
string
••6 <
contra
••= C
)
••C D
{
¶¶ 	

SqlCommand
ßß 
cmd
ßß 
=
ßß 
null
ßß !
;
ßß! "

EntUsuario
®® 
c
®® 
=
®® 
null
®® 
;
®®  
try
©© 
{
™™ 
SqlConnection
´´ 
cn
´´  
=
´´! "
Conexion
´´# +
.
´´+ ,
	Instancia
´´, 5
.
´´5 6
Conectar
´´6 >
(
´´> ?
)
´´? @
;
´´@ A
cmd
¨¨ 
=
¨¨ 
new
¨¨ 

SqlCommand
¨¨ $
(
¨¨$ %
$str
¨¨% 6
,
¨¨6 7
cn
¨¨8 :
)
¨¨: ;
;
¨¨; <
cmd
≠≠ 
.
≠≠ 
CommandType
≠≠ 
=
≠≠  !
CommandType
≠≠" -
.
≠≠- .
StoredProcedure
≠≠. =
;
≠≠= >
cmd
ÆÆ 
.
ÆÆ 

Parameters
ÆÆ 
.
ÆÆ 
AddWithValue
ÆÆ +
(
ÆÆ+ ,
$str
ÆÆ, 3
,
ÆÆ3 4
campo
ÆÆ5 :
)
ÆÆ: ;
;
ÆÆ; <
cmd
ØØ 
.
ØØ 

Parameters
ØØ 
.
ØØ 
AddWithValue
ØØ +
(
ØØ+ ,
$str
ØØ, 5
,
ØØ5 6
encrypt
ØØ7 >
.
ØØ> ?
	GetSHA256
ØØ? H
(
ØØH I
contra
ØØI O
)
ØØO P
)
ØØP Q
;
ØØQ R
cn
∞∞ 
.
∞∞ 
Open
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
using
±± 
(
±± 
SqlDataReader
±± $
dr
±±% '
=
±±( )
cmd
±±* -
.
±±- .
ExecuteReader
±±. ;
(
±±; <
)
±±< =
)
±±= >
{
≤≤ 
if
≥≥ 
(
≥≥ 
dr
≥≥ 
.
≥≥ 
Read
≥≥ 
(
≥≥  
)
≥≥  !
)
≥≥! "
{
¥¥ 
c
µµ 
=
µµ 
new
µµ 

EntUsuario
µµ  *
{
∂∂ 
	IdUsuario
∑∑ %
=
∑∑& '
Convert
∑∑( /
.
∑∑/ 0
ToInt16
∑∑0 7
(
∑∑7 8
dr
∑∑8 :
[
∑∑: ;
$str
∑∑; F
]
∑∑F G
)
∑∑G H
,
∑∑H I
RazonSocial
∏∏ '
=
∏∏( )
dr
∏∏* ,
[
∏∏, -
$str
∏∏- :
]
∏∏: ;
.
∏∏; <
ToString
∏∏< D
(
∏∏D E
)
∏∏E F
,
∏∏F G
UserName
ππ $
=
ππ% &
dr
ππ' )
[
ππ) *
$str
ππ* 4
]
ππ4 5
.
ππ5 6
ToString
ππ6 >
(
ππ> ?
)
ππ? @
,
ππ@ A
Correo
∫∫ "
=
∫∫# $
dr
∫∫% '
[
∫∫' (
$str
∫∫( 0
]
∫∫0 1
.
∫∫1 2
ToString
∫∫2 :
(
∫∫: ;
)
∫∫; <
,
∫∫< =
Telefono
ªª $
=
ªª% &
dr
ªª' )
[
ªª) *
$str
ªª* 4
]
ªª4 5
.
ªª5 6
ToString
ªª6 >
(
ªª> ?
)
ªª? @
,
ªª@ A
	Direccion
ºº %
=
ºº& '
dr
ºº( *
[
ºº* +
$str
ºº+ 6
]
ºº6 7
.
ºº7 8
ToString
ºº8 @
(
ºº@ A
)
ººA B
,
ººB C
Rol
ΩΩ 
=
ΩΩ  !
(
ΩΩ" #
entRol
ΩΩ# )
)
ΩΩ) *
dr
ΩΩ* ,
[
ΩΩ, -
$str
ΩΩ- 4
]
ΩΩ4 5
,
ΩΩ5 6
Activo
ææ "
=
ææ# $
Convert
ææ% ,
.
ææ, -
	ToBoolean
ææ- 6
(
ææ6 7
dr
ææ7 9
[
ææ9 :
$str
ææ: B
]
ææB C
)
ææC D
,
ææD E
}
øø 
;
øø 
	EntUbigeo
¿¿ !
ubigeo
¿¿" (
=
¿¿) *
new
¿¿+ .
	EntUbigeo
¿¿/ 8
{
¡¡ 
Distrito
¬¬ $
=
¬¬% &
dr
¬¬' )
[
¬¬) *
$str
¬¬* 4
]
¬¬4 5
.
¬¬5 6
ToString
¬¬6 >
(
¬¬> ?
)
¬¬? @
}
√√ 
;
√√ 
c
ƒƒ 
.
ƒƒ 
Ubigeo
ƒƒ  
=
ƒƒ! "
ubigeo
ƒƒ# )
;
ƒƒ) *
}
≈≈ 
}
∆∆ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»» 
{
…… 
throw
   
new
   
	Exception
   "
(
  " #
$str
  # =
+
  = >
ex
  > @
.
  @ A
Message
  A H
)
  H I
;
  I J
}
ÀÀ 
finally
ÃÃ 
{
ÕÕ 
cmd
ŒŒ 
.
ŒŒ 

Connection
ŒŒ 
.
ŒŒ 
Close
ŒŒ $
(
ŒŒ$ %
)
ŒŒ% &
;
ŒŒ& '
}
œœ 
return
–– 
c
–– 
;
–– 
}
—— 	
public
”” 
bool
”” 
EliminarUsuarios
”” $
(
””$ %
int
””% (
id
””) +
)
””+ ,
{
‘‘ 	

SqlCommand
’’ 
cmd
’’ 
=
’’ 
null
’’ !
;
’’! "
bool
÷÷ 
	eliminado
÷÷ 
=
÷÷ 
false
÷÷ "
;
÷÷" #
try
◊◊ 
{
ÿÿ 
SqlConnection
ŸŸ 
cn
ŸŸ  
=
ŸŸ! "
Conexion
ŸŸ# +
.
ŸŸ+ ,
	Instancia
ŸŸ, 5
.
ŸŸ5 6
Conectar
ŸŸ6 >
(
ŸŸ> ?
)
ŸŸ? @
;
ŸŸ@ A
cmd
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 

SqlCommand
⁄⁄ $
(
⁄⁄$ %
$str
⁄⁄% 9
,
⁄⁄9 :
cn
⁄⁄; =
)
⁄⁄= >
{
€€ 
CommandType
‹‹ 
=
‹‹  !
CommandType
‹‹" -
.
‹‹- .
StoredProcedure
‹‹. =
}
›› 
;
›› 
cmd
ﬁﬁ 
.
ﬁﬁ 

Parameters
ﬁﬁ 
.
ﬁﬁ 
AddWithValue
ﬁﬁ +
(
ﬁﬁ+ ,
$str
ﬁﬁ, 8
,
ﬁﬁ8 9
id
ﬁﬁ: <
)
ﬁﬁ< =
;
ﬁﬁ= >
cn
ﬂﬂ 
.
ﬂﬂ 
Open
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
int
‡‡ 
i
‡‡ 
=
‡‡ 
cmd
‡‡ 
.
‡‡ 
ExecuteNonQuery
‡‡ +
(
‡‡+ ,
)
‡‡, -
;
‡‡- .
if
·· 
(
·· 
i
·· 
>
·· 
$num
·· 
)
·· 
{
‚‚ 
	eliminado
„„ 
=
„„ 
true
„„  $
;
„„$ %
}
‰‰ 
}
ÂÂ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
e
ÊÊ 
)
ÊÊ 
{
ÁÁ 

MessageBox
ÈÈ 
.
ÈÈ 
Show
ÈÈ 
(
ÈÈ  
e
ÈÈ  !
.
ÈÈ! "
Message
ÈÈ" )
,
ÈÈ) *
$str
ÈÈ+ f
,
ÈÈf g
MessageBoxButtons
ÈÈh y
.
ÈÈy z
OK
ÈÈz |
,
ÈÈ| }
MessageBoxIconÈÈ~ å
.ÈÈå ç
ErrorÈÈç í
)ÈÈí ì
;ÈÈì î
}
ÍÍ 
finally
ÎÎ 
{
ÎÎ 
cmd
ÎÎ 
.
ÎÎ 

Connection
ÎÎ $
.
ÎÎ$ %
Close
ÎÎ% *
(
ÎÎ* +
)
ÎÎ+ ,
;
ÎÎ, -
}
ÎÎ. /
return
ÏÏ 
	eliminado
ÏÏ 
;
ÏÏ 
}
ÌÌ 	
public
ÓÓ 

EntUsuario
ÓÓ 
BuscarIdUsuario
ÓÓ )
(
ÓÓ) *
int
ÓÓ* -
busqueda
ÓÓ. 6
)
ÓÓ6 7
{
ÔÔ 	

SqlCommand
 
cmd
 
=
 
null
 !
;
! "

EntUsuario
ÒÒ 
c
ÒÒ 
=
ÒÒ 
new
ÒÒ 

EntUsuario
ÒÒ )
(
ÒÒ) *
)
ÒÒ* +
;
ÒÒ+ ,
try
ÚÚ 
{
ÛÛ 
SqlConnection
ÙÙ 
cn
ÙÙ  
=
ÙÙ! "
Conexion
ÙÙ# +
.
ÙÙ+ ,
	Instancia
ÙÙ, 5
.
ÙÙ5 6
Conectar
ÙÙ6 >
(
ÙÙ> ?
)
ÙÙ? @
;
ÙÙ@ A
cmd
ıı 
=
ıı 
new
ıı 

SqlCommand
ıı $
(
ıı$ %
$str
ıı% 8
,
ıı8 9
cn
ıı: <
)
ıı< =
;
ıı= >
cmd
ˆˆ 
.
ˆˆ 
CommandType
ˆˆ 
=
ˆˆ  !
CommandType
ˆˆ" -
.
ˆˆ- .
StoredProcedure
ˆˆ. =
;
ˆˆ= >
cmd
˜˜ 
.
˜˜ 

Parameters
˜˜ 
.
˜˜ 
AddWithValue
˜˜ +
(
˜˜+ ,
$str
˜˜, 8
,
˜˜8 9
busqueda
˜˜: B
)
˜˜B C
;
˜˜C D
cn
¯¯ 
.
¯¯ 
Open
¯¯ 
(
¯¯ 
)
¯¯ 
;
¯¯ 
SqlDataReader
˘˘ 
dr
˘˘  
=
˘˘! "
cmd
˘˘# &
.
˘˘& '
ExecuteReader
˘˘' 4
(
˘˘4 5
)
˘˘5 6
;
˘˘6 7
while
˙˙ 
(
˙˙ 
dr
˙˙ 
.
˙˙ 
Read
˙˙ 
(
˙˙ 
)
˙˙  
)
˙˙  !
{
˚˚ 
c
¸¸ 
.
¸¸ 
	IdUsuario
¸¸ 
=
¸¸  !
Convert
¸¸" )
.
¸¸) *
ToInt32
¸¸* 1
(
¸¸1 2
dr
¸¸2 4
[
¸¸4 5
$str
¸¸5 @
]
¸¸@ A
)
¸¸A B
;
¸¸B C
c
˝˝ 
.
˝˝ 
RazonSocial
˝˝ !
=
˝˝" #
dr
˝˝$ &
[
˝˝& '
$str
˝˝' 4
]
˝˝4 5
.
˝˝5 6
ToString
˝˝6 >
(
˝˝> ?
)
˝˝? @
;
˝˝@ A
c
˛˛ 
.
˛˛ 
Telefono
˛˛ 
=
˛˛  
dr
˛˛! #
[
˛˛# $
$str
˛˛$ .
]
˛˛. /
.
˛˛/ 0
ToString
˛˛0 8
(
˛˛8 9
)
˛˛9 :
;
˛˛: ;
c
ˇˇ 
.
ˇˇ 
	Direccion
ˇˇ 
=
ˇˇ  !
dr
ˇˇ" $
[
ˇˇ$ %
$str
ˇˇ% 0
]
ˇˇ0 1
.
ˇˇ1 2
ToString
ˇˇ2 :
(
ˇˇ: ;
)
ˇˇ; <
;
ˇˇ< =
c
ÄÄ 
.
ÄÄ 
Correo
ÄÄ 
=
ÄÄ 
dr
ÄÄ !
[
ÄÄ! "
$str
ÄÄ" *
]
ÄÄ* +
.
ÄÄ+ ,
ToString
ÄÄ, 4
(
ÄÄ4 5
)
ÄÄ5 6
;
ÄÄ6 7
c
ÅÅ 
.
ÅÅ 
UserName
ÅÅ 
=
ÅÅ  
dr
ÅÅ! #
[
ÅÅ# $
$str
ÅÅ$ .
]
ÅÅ. /
.
ÅÅ/ 0
ToString
ÅÅ0 8
(
ÅÅ8 9
)
ÅÅ9 :
;
ÅÅ: ;
c
ÇÇ 
.
ÇÇ 
Pass
ÇÇ 
=
ÇÇ 
dr
ÇÇ 
[
ÇÇ  
$str
ÇÇ  &
]
ÇÇ& '
.
ÇÇ' (
ToString
ÇÇ( 0
(
ÇÇ0 1
)
ÇÇ1 2
;
ÇÇ2 3
c
ÉÉ 
.
ÉÉ 
Activo
ÉÉ 
=
ÉÉ 
Convert
ÉÉ &
.
ÉÉ& '
	ToBoolean
ÉÉ' 0
(
ÉÉ0 1
dr
ÉÉ1 3
[
ÉÉ3 4
$str
ÉÉ4 <
]
ÉÉ< =
)
ÉÉ= >
;
ÉÉ> ?
c
ÑÑ 
.
ÑÑ 
Roll
ÑÑ 
=
ÑÑ 
new
ÑÑ  
entRoll
ÑÑ! (
(
ÑÑ( )
)
ÑÑ) *
{
ÖÖ 
Descripcion
ÜÜ #
=
ÜÜ$ %
dr
ÜÜ& (
[
ÜÜ( )
$str
ÜÜ) 6
]
ÜÜ6 7
.
ÜÜ7 8
ToString
ÜÜ8 @
(
ÜÜ@ A
)
ÜÜA B
,
ÜÜB C
}
áá 
;
áá 
c
àà 
.
àà 
Ubigeo
àà 
=
àà 
new
àà "
	EntUbigeo
àà# ,
(
àà, -
)
àà- .
{
ââ 
Departamento
ää $
=
ää% &
dr
ää' )
[
ää) *
$str
ää* 8
]
ää8 9
.
ää9 :
ToString
ää: B
(
ääB C
)
ääC D
,
ääD E
	Provincia
ãã !
=
ãã" #
dr
ãã$ &
[
ãã& '
$str
ãã' 2
]
ãã2 3
.
ãã3 4
ToString
ãã4 <
(
ãã< =
)
ãã= >
,
ãã> ?
Distrito
åå  
=
åå! "
dr
åå# %
[
åå% &
$str
åå& 0
]
åå0 1
.
åå1 2
ToString
åå2 :
(
åå: ;
)
åå; <
}
çç 
;
çç 
}
éé 
}
èè 
catch
êê 
(
êê 
	Exception
êê 
e
êê 
)
êê 
{
ëë 

MessageBox
íí 
.
íí 
Show
íí 
(
íí  
e
íí  !
.
íí! "
Message
íí" )
,
íí) *
$str
íí+ e
,
ííe f
MessageBoxButtons
ííg x
.
ííx y
OK
ííy {
,
íí{ |
MessageBoxIconíí} ã
.ííã å
Errorííå ë
)ííë í
;ííí ì
}
îî 
finally
ïï 
{
ïï 
cmd
ïï 
.
ïï 

Connection
ïï $
.
ïï$ %
Close
ïï% *
(
ïï* +
)
ïï+ ,
;
ïï, -
}
ïï. /
return
ññ 
c
ññ 
;
ññ 
}
óó 	
}
öö 
}úú ∏Ü
ZC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatCompra.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
	DatCompra 
: 

IDatCompra %
{ 
public 
int 
CrearCompra 
( 
	EntCompra (
comp) -
)- .
{ 	

SqlCommand 
cmd 
= 
null !
;! "
int 
idCompra 
= 
- 
$num 
; 
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 4
,4 5
cn6 8
)8 9
{ 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
comp6 :
.: ;
Total; @
)@ A
;A B
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
comp: >
.> ?
Usuario? F
.F G
	IdUsuarioG P
)P Q
;Q R
SqlParameter 
id 
=  !
new" %
SqlParameter& 2
(2 3
$str3 8
,8 9
$num: ;
); <
{ 
	Direction 
= 
ParameterDirection  2
.2 3
Output3 9
} 
; 
cmd   
.   

Parameters   
.   
Add   "
(  " #
id  # %
)  % &
;  & '
cn"" 
."" 
Open"" 
("" 
)"" 
;"" 
int## 
i## 
=## 
cmd## 
.## 
ExecuteNonQuery## +
(##+ ,
)##, -
;##- .
if$$ 
($$ 
i$$ 
>$$ 
$num$$ 
)$$ 
{%% 
idCompra&& 
=&& 
Convert&& &
.&&& '
ToInt32&&' .
(&&. /
cmd&&/ 2
.&&2 3

Parameters&&3 =
[&&= >
$str&&> C
]&&C D
.&&D E
Value&&E J
)&&J K
;&&K L
}'' 
if(( 
((( 
idCompra(( 
==(( 
-((  !
$num((! "
)((" #
{)) 

MessageBox** 
.** 
Show** #
(**# $
$str**$ 1
)**1 2
;**2 3
}++ 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 

MessageBox00 
.00 
Show00 
(00  
e00  !
.00! "
Message00" )
,00) *
$str00+ e
,00e f
MessageBoxButtons00g x
.00x y
OK00y {
,00{ |
MessageBoxIcon	00} ã
.
00ã å
Error
00å ë
)
00ë í
;
00í ì
}11 
finally22 
{33 
cmd44 
.44 

Connection44 
.44 
Close44 $
(44$ %
)44% &
;44& '
}55 
return66 
idCompra66 
;66 
}77 	
public99 
List99 
<99 
	EntCompra99 
>99 
ListarCompra99 +
(99+ ,
int99, /
id990 2
)992 3
{:: 	
List;; 
<;; 
	EntCompra;; 
>;; 
lista;; !
=;;" #
new;;$ '
List;;( ,
<;;, -
	EntCompra;;- 6
>;;6 7
(;;7 8
);;8 9
;;;9 :

SqlCommand<< 
cmd<< 
=<< 
null<< !
;<<! "
try== 
{>> 
SqlConnection?? 
cn??  
=??! "
Conexion??# +
.??+ ,
	Instancia??, 5
.??5 6
Conectar??6 >
(??> ?
)??? @
;??@ A
cmd@@ 
=@@ 
new@@ 

SqlCommand@@ $
(@@$ %
$str@@% 5
,@@5 6
cn@@7 9
)@@9 :
;@@: ;
cmdAA 
.AA 

ParametersAA 
.AA 
AddWithValueAA +
(AA+ ,
$strAA, 1
,AA1 2
idAA3 5
)AA5 6
;AA6 7
cmdBB 
.BB 
CommandTypeBB 
=BB  !
CommandTypeBB" -
.BB- .
StoredProcedureBB. =
;BB= >
cnCC 
.CC 
OpenCC 
(CC 
)CC 
;CC 
SqlDataReaderDD 
drDD  
=DD! "
cmdDD# &
.DD& '
ExecuteReaderDD' 4
(DD4 5
)DD5 6
;DD6 7
whileEE 
(EE 
drEE 
.EE 
ReadEE 
(EE 
)EE  
)EE  !
{FF 
	EntCompraGG 
	objCompraGG '
=GG( )
newGG* -
	EntCompraGG. 7
{HH 
IdCompraII  
=II! "
ConvertII# *
.II* +
ToInt32II+ 2
(II2 3
drII3 5
[II5 6
$strII6 @
]II@ A
)IIA B
,IIB C
FechaJJ 
=JJ 
ConvertJJ  '
.JJ' (

ToDateTimeJJ( 2
(JJ2 3
drJJ3 5
[JJ5 6
$strJJ6 =
]JJ= >
)JJ> ?
,JJ? @
TotalKK 
=KK 
ConvertKK  '
.KK' (
ToDoubleKK( 0
(KK0 1
drKK1 3
[KK3 4
$strKK4 ;
]KK; <
)KK< =
,KK= >
UsuarioLL 
=LL  
newLL  #

EntUsuarioLL$ .
{MM 
UserNameNN $
=NN% &
drNN' )
[NN) *
$strNN* 4
]NN4 5
.NN5 6
ToStringNN6 >
(NN> ?
)NN? @
,NN@ A
}OO 
,OO 
EstadoPP 
=PP  
drPP! #
[PP# $
$strPP$ ,
]PP, -
.PP- .
ToStringPP. 6
(PP6 7
)PP7 8
}QQ 
;QQ 
listaSS 
.SS 
AddSS 
(SS 
	objCompraSS '
)SS' (
;SS( )
}TT 
}UU 
catchVV 
(VV 
	ExceptionVV 
eVV 
)VV 
{WW 

MessageBoxXX 
.XX 
ShowXX 
(XX  
eXX  !
.XX! "
MessageXX" )
,XX) *
$strXX+ ;
,XX; <
MessageBoxButtonsXX= N
.XXN O
OKXXO Q
,XXQ R
MessageBoxIconXXS a
.XXa b
ErrorXXb g
)XXg h
;XXh i
}YY 
finallyZZ 
{[[ 
cmd\\ 
.\\ 

Connection\\ 
.\\ 
Close\\ $
(\\$ %
)\\% &
;\\& '
}]] 
return^^ 
lista^^ 
;^^ 
}__ 	
publicaa 
Listaa 
<aa 
	EntCompraaa 
>aa !
ListarTodasLasComprasaa 4
(aa4 5
)aa5 6
{bb 	
Listcc 
<cc 
	EntCompracc 
>cc 
listacc !
=cc" #
newcc$ '
Listcc( ,
<cc, -
	EntCompracc- 6
>cc6 7
(cc7 8
)cc8 9
;cc9 :

SqlCommanddd 
cmddd 
=dd 
nulldd !
;dd! "
tryee 
{ff 
SqlConnectiongg 
cngg  
=gg! "
Conexiongg# +
.gg+ ,
	Instanciagg, 5
.gg5 6
Conectargg6 >
(gg> ?
)gg? @
;gg@ A
cmdhh 
=hh 
newhh 

SqlCommandhh $
(hh$ %
$strhh% =
,hh= >
cnhh? A
)hhA B
;hhB C
cmdii 
.ii 
CommandTypeii 
=ii  !
CommandTypeii" -
.ii- .
StoredProcedureii. =
;ii= >
cnjj 
.jj 
Openjj 
(jj 
)jj 
;jj 
SqlDataReaderkk 
drkk  
=kk! "
cmdkk# &
.kk& '
ExecuteReaderkk' 4
(kk4 5
)kk5 6
;kk6 7
whilell 
(ll 
drll 
.ll 
Readll 
(ll 
)ll  
)ll  !
{mm 
	EntComprann 
	objComprann '
=nn( )
newnn* -
	EntComprann. 7
{oo 
IdComprapp  
=pp! "
Convertpp# *
.pp* +
ToInt32pp+ 2
(pp2 3
drpp3 5
[pp5 6
$strpp6 @
]pp@ A
)ppA B
,ppB C
Fechaqq 
=qq 
Convertqq  '
.qq' (

ToDateTimeqq( 2
(qq2 3
drqq3 5
[qq5 6
$strqq6 =
]qq= >
)qq> ?
,qq? @
Totalrr 
=rr 
Convertrr  '
.rr' (
ToDoublerr( 0
(rr0 1
drrr1 3
[rr3 4
$strrr4 ;
]rr; <
)rr< =
,rr= >
Usuarioss 
=ss  !
newss" %

EntUsuarioss& 0
{tt 
Correouu "
=uu# $
druu% '
[uu' (
$struu( 0
]uu0 1
.uu1 2
ToStringuu2 :
(uu: ;
)uu; <
,uu< =
UserNamevv $
=vv% &
drvv' )
[vv) *
$strvv* 4
]vv4 5
.vv5 6
ToStringvv6 >
(vv> ?
)vv? @
}ww 
,ww 
Estadoxx 
=xx  
drxx! #
[xx# $
$strxx$ ,
]xx, -
.xx- .
ToStringxx. 6
(xx6 7
)xx7 8
}yy 
;yy 
lista{{ 
.{{ 
Add{{ 
({{ 
	objCompra{{ '
){{' (
;{{( )
}|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
e~~ 
)~~ 
{ 

MessageBox
ÄÄ 
.
ÄÄ 
Show
ÄÄ 
(
ÄÄ  
e
ÄÄ  !
.
ÄÄ! "
Message
ÄÄ" )
,
ÄÄ) *
$str
ÄÄ+ @
,
ÄÄ@ A
MessageBoxButtons
ÄÄB S
.
ÄÄS T
OK
ÄÄT V
,
ÄÄV W
MessageBoxIcon
ÄÄX f
.
ÄÄf g
Error
ÄÄg l
)
ÄÄl m
;
ÄÄm n
}
ÅÅ 
finally
ÇÇ 
{
ÉÉ 
cmd
ÑÑ 
.
ÑÑ 

Connection
ÑÑ 
.
ÑÑ 
Close
ÑÑ $
(
ÑÑ$ %
)
ÑÑ% &
;
ÑÑ& '
}
ÖÖ 
return
ÜÜ 
lista
ÜÜ 
;
ÜÜ 
}
áá 	
public
ââ 
bool
ââ 
EliminarCompra
ââ "
(
ââ" #
int
ââ# &
idcompra
ââ' /
)
ââ/ 0
{
ää 	

SqlCommand
ãã 
cmd
ãã 
=
ãã 
null
ãã !
;
ãã! "
bool
åå 
	eliminado
åå 
=
åå 
false
åå "
;
åå" #
try
çç 
{
éé 
SqlConnection
èè 
cn
èè  
=
èè! "
Conexion
èè# +
.
èè+ ,
	Instancia
èè, 5
.
èè5 6
Conectar
èè6 >
(
èè> ?
)
èè? @
;
èè@ A
cmd
êê 
=
êê 
new
êê 

SqlCommand
êê $
(
êê$ %
$str
êê% 7
,
êê7 8
cn
êê9 ;
)
êê; <
;
êê< =
cmd
ëë 
.
ëë 
CommandType
ëë 
=
ëë  !
CommandType
ëë" -
.
ëë- .
StoredProcedure
ëë. =
;
ëë= >
cmd
íí 
.
íí 

Parameters
íí 
.
íí 
AddWithValue
íí +
(
íí+ ,
$str
íí, 7
,
íí7 8
idcompra
íí9 A
)
ííA B
;
ííB C
cn
ìì 
.
ìì 
Open
ìì 
(
ìì 
)
ìì 
;
ìì 
int
îî 
i
îî 
=
îî 
cmd
îî 
.
îî 
ExecuteNonQuery
îî +
(
îî+ ,
)
îî, -
;
îî- .
if
ïï 
(
ïï 
i
ïï 
>
ïï 
$num
ïï 
)
ïï 
{
ññ 
	eliminado
óó 
=
óó 
true
óó  $
;
óó$ %
}
òò 
}
ôô 
catch
öö 
(
öö 
	Exception
öö 
e
öö 
)
öö 
{
õõ 

MessageBox
úú 
.
úú 
Show
úú 
(
úú  
e
úú  !
.
úú! "
Message
úú" )
)
úú) *
;
úú* +
}
ùù 
finally
ûû 
{
ûû 
cmd
ûû 
.
ûû 

Connection
ûû $
.
ûû$ %
Close
ûû% *
(
ûû* +
)
ûû+ ,
;
ûû, -
}
ûû. /
return
üü 
	eliminado
üü 
;
üü 
}
†† 	
public
¢¢ 
List
¢¢ 
<
¢¢ 
	EntCompra
¢¢ 
>
¢¢ 
BuscarCompra
¢¢ +
(
¢¢+ ,
string
¢¢, 2
busqueda
¢¢3 ;
)
¢¢; <
{
££ 	
List
§§ 
<
§§ 
	EntCompra
§§ 
>
§§ 
lista
§§ !
=
§§" #
new
§§$ '
List
§§( ,
<
§§, -
	EntCompra
§§- 6
>
§§6 7
(
§§7 8
)
§§8 9
;
§§9 :

SqlCommand
•• 
cmd
•• 
=
•• 
null
•• !
;
••! "
try
¶¶ 
{
ßß 
SqlConnection
®® 
cn
®®  
=
®®! "
Conexion
®®# +
.
®®+ ,
	Instancia
®®, 5
.
®®5 6
Conectar
®®6 >
(
®®> ?
)
®®? @
;
®®@ A
cmd
©© 
=
©© 
new
©© 

SqlCommand
©© $
(
©©$ %
$str
©©% 5
,
©©5 6
cn
©©7 9
)
©©9 :
;
©©: ;
cmd
™™ 
.
™™ 
CommandType
™™ 
=
™™  !
CommandType
™™" -
.
™™- .
StoredProcedure
™™. =
;
™™= >
cmd
´´ 
.
´´ 

Parameters
´´ 
.
´´ 
AddWithValue
´´ +
(
´´+ ,
$str
´´, 4
,
´´4 5
busqueda
´´6 >
)
´´> ?
;
´´? @
cn
¨¨ 
.
¨¨ 
Open
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
SqlDataReader
≠≠ 
dr
≠≠  
=
≠≠! "
cmd
≠≠# &
.
≠≠& '
ExecuteReader
≠≠' 4
(
≠≠4 5
)
≠≠5 6
;
≠≠6 7
while
ÆÆ 
(
ÆÆ 
dr
ÆÆ 
.
ÆÆ 
Read
ÆÆ 
(
ÆÆ 
)
ÆÆ  
)
ÆÆ  !
{
ØØ 
	EntCompra
∞∞ 
Prod
∞∞ "
=
∞∞# $
new
∞∞% (
	EntCompra
∞∞) 2
(
∞∞2 3
)
∞∞3 4
;
∞∞4 5
Prod
±± 
.
±± 
IdCompra
±± !
=
±±" #
Convert
±±$ +
.
±±+ ,
ToInt32
±±, 3
(
±±3 4
dr
±±4 6
[
±±6 7
$str
±±7 A
]
±±A B
)
±±B C
;
±±C D
Prod
≤≤ 
.
≤≤ 
Fecha
≤≤ 
=
≤≤  
Convert
≤≤! (
.
≤≤( )

ToDateTime
≤≤) 3
(
≤≤3 4
dr
≤≤4 6
[
≤≤6 7
$str
≤≤7 >
]
≤≤> ?
)
≤≤? @
;
≤≤@ A
Prod
≥≥ 
.
≥≥ 
Total
≥≥ 
=
≥≥  
Convert
≥≥! (
.
≥≥( )
ToDouble
≥≥) 1
(
≥≥1 2
dr
≥≥2 4
[
≥≥4 5
$str
≥≥5 <
]
≥≥< =
)
≥≥= >
;
≥≥> ?
lista
µµ 
.
µµ 
Add
µµ 
(
µµ 
Prod
µµ "
)
µµ" #
;
µµ# $
}
∂∂ 
}
∑∑ 
catch
∏∏ 
(
∏∏ 
	Exception
∏∏ 
e
∏∏ 
)
∏∏ 
{
ππ 

MessageBox
ªª 
.
ªª 
Show
ªª 
(
ªª  
e
ªª  !
.
ªª! "
Message
ªª" )
)
ªª) *
;
ªª* +
}
ºº 
finally
ΩΩ 
{
ææ 
cmd
øø 
.
øø 

Connection
øø 
.
øø 
Close
øø $
(
øø$ %
)
øø% &
;
øø& '
}
¿¿ 
return
¡¡ 
lista
¡¡ 
;
¡¡ 
}
¬¬ 	
}
√√ 
}ƒƒ ÉF
]C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatDetCompra.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatDetCompra 
: 
IDatDetCompra  -
{ 
public 
bool 
CrearDetCompra "
(" #
EntDetCompra# /
Det0 3
)3 4
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 7
,7 8
cn9 ;
); <
;< =
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Det9 <
.< =
Compra= C
.C D
IdCompraD L
)L M
;M N
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
Det< ?
.? @
ProveedorProducto@ Q
.Q R
	ProveedorR [
.[ \
IdProveedor\ g
)g h
;h i
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
Det; >
.> ?
ProveedorProducto? P
.P Q
ProductoQ Y
.Y Z

IdProductoZ d
)d e
;e f
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Det9 <
.< =
Cantidad= E
)E F
;F G
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Det9 <
.< =
Subtotal= E
)E F
;F G
cn 
. 
Open 
( 
) 
; 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if 
( 
i 
!= 
$num 
) 
{   
creado!! 
=!! 
true!! !
;!!! "
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
e$$ 
)$$ 
{%% 

MessageBox&& 
.&& 
Show&& 
(&&  
e&&  !
.&&! "
Message&&" )
)&&) *
;&&* +
}'' 
finally(( 
{)) 
cmd** 
.** 

Connection** 
.** 
Close** $
(**$ %
)**% &
;**& '
}++ 
return,, 
creado,, 
;,, 
}-- 	
public// 
List// 
<// 
EntDetCompra//  
>//  !"
MostrarDetalleCompraId//" 8
(//8 9
int//9 <
id//= ?
)//? @
{00 	
List11 
<11 
EntDetCompra11 
>11 
list11 #
=11$ %
new11& )
List11* .
<11. /
EntDetCompra11/ ;
>11; <
(11< =
)11= >
;11> ?

SqlCommand22 
cmd22 
=22 
null22 !
;22! "
try33 
{44 
SqlConnection55 
cn55  
=55! "
Conexion55# +
.55+ ,
	Instancia55, 5
.555 6
Conectar556 >
(55> ?
)55? @
;55@ A
cmd66 
=66 
new66 

SqlCommand66 $
(66$ %
$str66% >
,66> ?
cn66@ B
)66B C
;66C D
cmd77 
.77 
CommandType77 
=77  !
CommandType77" -
.77- .
StoredProcedure77. =
;77= >
cmd88 
.88 

Parameters88 
.88 
AddWithValue88 +
(88+ ,
$str88, 7
,887 8
id889 ;
)88; <
;88< =
cn99 
.99 
Open99 
(99 
)99 
;99 
SqlDataReader:: 
dr::  
=::! "
cmd::# &
.::& '
ExecuteReader::' 4
(::4 5
)::5 6
;::6 7
while;; 
(;; 
dr;; 
.;; 
Read;; 
(;; 
);;  
);;  !
{<< 
EntDetCompra==  
detalle==! (
===) *
new==+ .
EntDetCompra==/ ;
{>> 
Compra?? 
=??  
new??! $
	EntCompra??% .
{@@ 
IdCompraAA $
=AA% &
ConvertAA' .
.AA. /
ToInt32AA/ 6
(AA6 7
drAA7 9
[AA9 :
$strAA: D
]AAD E
)AAE F
}BB 
,BB 
ProveedorProductoCC )
=CC* +
newCC, / 
EntProveedorProductoCC0 D
{DD 
	ProveedorEE %
=EE& '
newEE( +
EntProveedorEE, 8
{FF 
IdProveedorGG  +
=GG, -
ConvertGG. 5
.GG5 6
ToInt32GG6 =
(GG= >
drGG> @
[GG@ A
$strGGA N
]GGN O
)GGO P
,GGP Q
RazonSocialHH  +
=HH, -
drHH. 0
[HH0 1
$strHH1 >
]HH> ?
.HH? @
ToStringHH@ H
(HHH I
)HHI J
,HHJ K
DescripcionII  +
=II, -
drII. 0
[II0 1
$strII1 >
]II> ?
.II? @
ToStringII@ H
(IIH I
)III J
,IIJ K
}KK 
,KK 
ProductoLL $
=LL% &
newLL' *
EntProductoLL+ 6
{MM 

IdProductoNN  *
=NN+ ,
ConvertNN- 4
.NN4 5
ToInt32NN5 <
(NN< =
drNN= ?
[NN? @
$strNN@ L
]NNL M
)NNM N
,NNN O
NombreOO  &
=OO' (
drOO) +
[OO+ ,
$strOO, 4
]OO4 5
.OO5 6
ToStringOO6 >
(OO> ?
)OO? @
,OO@ A
LongitudPP  (
=PP) *
ConvertPP+ 2
.PP2 3
ToDoublePP3 ;
(PP; <
drPP< >
[PP> ?
$strPP? I
]PPI J
)PPJ K
,PPK L
DiametroQQ  (
=QQ) *
ConvertQQ+ 2
.QQ2 3
ToDoubleQQ3 ;
(QQ; <
drQQ< >
[QQ> ?
$strQQ? I
]QQI J
)QQJ K
,QQK L
TipoRR  $
=RR% &
newRR' *
EntTipoProductoRR+ :
{SS  !
NombreTT$ *
=TT+ ,
drTT- /
[TT/ 0
$strTT0 6
]TT6 7
.TT7 8
ToStringTT8 @
(TT@ A
)TTA B
}UU  !
}WW 
,WW 
PrecioCompraXX (
=XX) *
ConvertXX+ 2
.XX2 3
ToDoubleXX3 ;
(XX; <
drXX< >
[XX> ?
$strXX? M
]XXM N
)XXN O
}YY 
,YY 
CantidadZZ  
=ZZ! "
ConvertZZ# *
.ZZ* +
ToInt32ZZ+ 2
(ZZ2 3
drZZ3 5
[ZZ5 6
$strZZ6 @
]ZZ@ A
)ZZA B
,ZZB C
Subtotal[[  
=[[! "
Convert[[# *
.[[* +
ToDouble[[+ 3
([[3 4
dr[[4 6
[[[6 7
$str[[7 A
][[A B
)[[B C
}]] 
;]] 
list^^ 
.^^ 
Add^^ 
(^^ 
detalle^^ $
)^^$ %
;^^% &
}__ 
}`` 
catchaa 
(aa 
	Exceptionaa 
eaa 
)aa 
{bb 

MessageBoxdd 
.dd 
Showdd 
(dd  
edd  !
.dd! "
Messagedd" )
)dd) *
;dd* +
}ee 
finallyff 
{gg 
cmdhh 
.hh 

Connectionhh 
.hh 
Closehh $
(hh$ %
)hh% &
;hh& '
}ii 
returnjj 
listjj 
;jj 
}kk 	
}ll 
}mm ª@
\C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatDetVenta.cs
	namespace

 	
CapaAccesoDatos


 
{ 
public 

class 
DatDetVenta 
: 
IDatDetVenta +
{ 
private 
List 
< 
EntDetVenta  
>  !
detalle" )
=* +
new, /
List0 4
<4 5
EntDetVenta5 @
>@ A
(A B
)B C
;C D
private 
static 
readonly 
DatDetVenta  +

_instancia, 6
=7 8
new9 <
DatDetVenta= H
(H I
)I J
;J K
public 
static 
DatDetVenta !
	Instancia" +
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearDetVenta !
(! "
EntDetVenta" -
Det. 1
)1 2
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 6
,6 7
cn8 :
): ;
;; <
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 6
,6 7
Det8 ;
.; <
Venta< A
.A B
IdVentaB I
)I J
;J K
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 9
,  9 :
Det  ; >
.  > ?
Producto  ? G
.  G H

IdProducto  H R
)  R S
;  S T
cmd!! 
.!! 

Parameters!! 
.!! 
AddWithValue!! +
(!!+ ,
$str!!, 7
,!!7 8
Det!!9 <
.!!< =
Cantidad!!= E
)!!E F
;!!F G
cmd"" 
."" 

Parameters"" 
."" 
AddWithValue"" +
(""+ ,
$str"", 7
,""7 8
Det""9 <
.""< =
SubTotal""= E
)""E F
;""F G
cn## 
.## 
Open## 
(## 
)## 
;## 
int$$ 
i$$ 
=$$ 
cmd$$ 
.$$ 
ExecuteNonQuery$$ +
($$+ ,
)$$, -
;$$- .
if%% 
(%% 
i%% 
!=%% 
$num%% 
)%% 
{&& 
creado'' 
='' 
true'' !
;''! "
}(( 
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 

MessageBox,, 
.,, 
Show,, 
(,,  
e,,  !
.,,! "
Message,," )
),,) *
;,,* +
}-- 
finally.. 
{// 
cmd00 
.00 

Connection00 
.00 
Close00 $
(00$ %
)00% &
;00& '
}11 
return22 
creado22 
;22 
}33 	
public77 
List77 
<77 
EntDetVenta77 
>77  
Mostrardetventa77! 0
(770 1
int771 4
idVenta775 <
)77< =
{88 	

SqlCommand99 
cmd99 
=99 
null99 !
;99! "
List:: 
<:: 
EntDetVenta:: 
>:: 
list:: "
=::# $
new::% (
List::) -
<::- .
EntDetVenta::. 9
>::9 :
(::: ;
)::; <
;::< =
try;; 
{<< 
SqlConnection== 
cn==  
===! "
Conexion==# +
.==+ ,
	Instancia==, 5
.==5 6
Conectar==6 >
(==> ?
)==? @
;==@ A
cmd>> 
=>> 
new>> 

SqlCommand>> $
(>>$ %
$str>>% >
,>>> ?
cn>>@ B
)>>B C
;>>C D
cmd?? 
.?? 
CommandType?? 
=??  !
CommandType??" -
.??- .
StoredProcedure??. =
;??= >
cmd@@ 
.@@ 

Parameters@@ 
.@@ 
AddWithValue@@ +
(@@+ ,
$str@@, 6
,@@6 7
idVenta@@8 ?
)@@? @
;@@@ A
cnAA 
.AA 
OpenAA 
(AA 
)AA 
;AA 
SqlDataReaderBB 
drBB  
=BB! "
cmdBB# &
.BB& '
ExecuteReaderBB' 4
(BB4 5
)BB5 6
;BB6 7
whileCC 
(CC 
drCC 
.CC 
ReadCC 
(CC 
)CC  
)CC  !
{DD 
EntDetVentaEE 
detEE  #
=EE$ %
newEE& )
EntDetVentaEE* 5
{FF 
VentaGG 
=GG 
newGG !
EntVentaGG" *
{HH 
IdVentaII #
=II# $
ConvertII% ,
.II, -
ToInt32II- 4
(II4 5
drII5 7
[II7 8
$strII8 A
]IIA B
)IIB C
}JJ 
,JJ 
ProductoKK  
=KK! "
newKK# &
EntProductoKK' 2
{LL 
NombreMM "
=MM# $
drMM% '
[MM' (
$strMM( 0
]MM0 1
.MM1 2
ToStringMM2 :
(MM: ;
)MM; <
,MM< =
LongitudNN $
=NN% &
ConvertNN' .
.NN. /
ToDoubleNN/ 7
(NN7 8
drNN8 :
[NN: ;
$strNN; E
]NNE F
)NNF G
,NNG H
DiametroOO $
=OO% &
ConvertOO' .
.OO. /
ToDoubleOO/ 7
(OO7 8
drOO8 :
[OO: ;
$strOO; E
]OOE F
)OOF G
,OOG H
PrecioVentaPP '
=PP( )
ConvertPP* 1
.PP1 2
ToDoublePP2 :
(PP: ;
drPP; =
[PP= >
$strPP> K
]PPK L
)PPL M
,PPM N
TipoRR  
=RR! "
newRR# &
EntTipoProductoRR' 6
{SS 
NombreTT  &
=TT' (
drTT) +
[TT+ ,
$strTT, 2
]TT2 3
.TT3 4
ToStringTT4 <
(TT< =
)TT= >
}UU 
}VV 
,VV 
CantidadWW  
=WW! "
ConvertWW# *
.WW* +
ToInt32WW+ 2
(WW2 3
drWW3 5
[WW5 6
$strWW6 @
]WW@ A
)WWA B
,WWB C
SubTotalXX  
=XX! "
ConvertXX# *
.XX* +
ToDoubleXX+ 3
(XX3 4
drXX4 6
[XX6 7
$strXX7 A
]XXA B
)XXB C
}YY 
;YY 
listZZ 
.ZZ 
AddZZ 
(ZZ 
detZZ  
)ZZ  !
;ZZ! "
}[[ 
}\\ 
catch]] 
(]] 
	Exception]] 
e]] 
)]] 
{^^ 

MessageBox__ 
.__ 
Show__ 
(__  
e__  !
.__! "
Message__" )
)__) *
;__* +
}`` 
finallyaa 
{aa 
cmdaa 
.aa 

Connectionaa $
.aa$ %
Closeaa% *
(aa* +
)aa+ ,
;aa, -
}aa. /
returnbb 
listbb 
;bb 
}cc 	
}
çç 
}éé €
[C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\datGrafEst.cs
	namespace 	
CapaAccesoDatos
 
{ 
public		 

class		 

datGrafEst		 
{

 
private 
static 
readonly 

datGrafEst  *
	_instance+ 4
=5 6
new7 :

datGrafEst; E
(E F
)F G
;G H
public 
static 

datGrafEst  
	Instancia! *
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
	ArrayList 
ProductosPreferidos ,
(, -
object- 3
chart4 9
)9 :
{ 	

SqlCommand 
cmd 
= 
null !
;! "
	ArrayList 
NombreMadera "
=# $
new% (
	ArrayList) 2
(2 3
)3 4
;4 5
	ArrayList 

CantMadera  
=! "
new# &
	ArrayList' 0
(0 1
)1 2
;2 3
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% <
,< =
cn> @
)@ A
;A B
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cn 
. 
Open 
( 
) 
; 
SqlDataReader 
dr  
=! "
cmd# &
.& '
ExecuteReader' 4
(4 5
)5 6
;6 7
while 
( 
dr 
. 
Read 
( 
)  
)  !
{ 
NombreMadera  
.  !
Add! $
($ %
dr% '
.' (
	GetString( 1
(1 2
$num2 3
)3 4
)4 5
;5 6

CantMadera   
.   
Add   "
(  " #
dr  # %
.  % &
GetInt16  & .
(  . /
$num  / 0
)  0 1
)  1 2
;  2 3
}!! 
}## 
catch$$ 
($$ 
	Exception$$ 
e$$ 
)$$ 
{%% 

MessageBox'' 
.'' 
Show'' 
(''  
e''  !
.''! "
Message''" )
)'') *
;''* +
}(( 
finally)) 
{** 
cmd++ 
.++ 

Connection++ 
.++ 
Close++ $
(++$ %
)++% &
;++& '
},, 
return-- 
NombreMadera-- 
;--  
}.. 	
}// 
}00 ≈÷
\C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProducto.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatProducto 
: 
IDatProducto +
{ 
private 
static 
readonly 
DatProducto  +

_instancia, 6
=7 8
new9 <
DatProducto= H
(H I
)I J
;J K
public 
static 
DatProducto !
	Instancia" +
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearProducto !
(! "
EntProducto" -
prod. 2
)2 3
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 6
,6 7
cn8 :
): ;
;; <
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
prod7 ;
.; <
Nombre< B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
prod9 =
.= >
Longitud> F
)F G
;G H
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
prod9 =
.= >
Diametro> F
)F G
;G H
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
prod< @
.@ A
PrecioVentaA L
)L M
;M N
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , >
,  > ?
prod  @ D
.  D E
Tipo  E I
.  I J
IdTipo_producto  J Y
)  Y Z
;  Z [
cn!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
int"" 
i"" 
="" 
cmd"" 
."" 
ExecuteNonQuery"" +
(""+ ,
)"", -
;""- .
if$$ 
($$ 
i$$ 
>$$ 
$num$$ 
)$$ 
creado%% 
=%% 
true%% !
;%%! "
}'' 
catch(( 
((( 
	Exception(( 
e(( 
)(( 
{)) 

MessageBox** 
.** 
Show** 
(**  
e**  !
.**! "
Message**" )
,**) *
$str**+ J
,**J K
MessageBoxButtons**L ]
.**] ^
OK**^ `
,**` a
MessageBoxIcon**b p
.**p q
Error**q v
)**v w
;**w x
}++ 
finally,, 
{-- 
cmd.. 
... 

Connection.. 
... 
Close.. $
(..$ %
)..% &
;..& '
}// 
return00 
creado00 
;00 
}22 	
public44 
List44 
<44 
EntProducto44 
>44  
ListarProducto44! /
(44/ 0
)440 1
{55 	

SqlCommand66 
cmd66 
=66 
null66 !
;66! "
List77 
<77 
EntProducto77 
>77 
lista77 #
=77$ %
new77& )
List77* .
<77. /
EntProducto77/ :
>77: ;
(77; <
)77< =
;77= >
try88 
{99 
SqlConnection:: 
cn::  
=::! "
Conexion::# +
.::+ ,
	Instancia::, 5
.::5 6
Conectar::6 >
(::> ?
)::? @
;::@ A
cmd;; 
=;; 
new;; 

SqlCommand;; $
(;;$ %
$str;;% 7
,;;7 8
cn;;9 ;
);;; <
;;;< =
cmd<< 
.<< 
CommandType<< 
=<<  !
CommandType<<" -
.<<- .
StoredProcedure<<. =
;<<= >
cn== 
.== 
Open== 
(== 
)== 
;== 
SqlDataReader>> 
dr>>  
=>>! "
cmd>># &
.>>& '
ExecuteReader>>' 4
(>>4 5
)>>5 6
;>>6 7
while?? 
(?? 
dr?? 
.?? 
Read?? 
(?? 
)??  
)??  !
{@@ 
EntProductoBB 
ProdBB  $
=BB% &
newBB' *
EntProductoBB+ 6
{CC 

IdProductoDD "
=DD# $
ConvertDD% ,
.DD, -
ToInt32DD- 4
(DD4 5
drDD5 7
[DD7 8
$strDD8 D
]DDD E
)DDE F
,DDF G
NombreEE 
=EE  
drEE! #
[EE# $
$strEE$ ,
]EE, -
.EE- .
ToStringEE. 6
(EE6 7
)EE7 8
,EE8 9
LongitudFF  
=FF! "
ConvertFF# *
.FF* +
ToDoubleFF+ 3
(FF3 4
drFF4 6
[FF6 7
$strFF7 A
]FFA B
)FFB C
,FFC D
DiametroGG  
=GG! "
ConvertGG# *
.GG* +
ToDoubleGG+ 3
(GG3 4
drGG4 6
[GG6 7
$strGG7 A
]GGA B
)GGB C
,GGC D
StockHH 
=HH 
ConvertHH  '
.HH' (
ToInt32HH( /
(HH/ 0
drHH0 2
[HH2 3
$strHH3 :
]HH: ;
)HH; <
,HH< =
ActivoII 
=II  
ConvertII! (
.II( )
	ToBooleanII) 2
(II2 3
drII3 5
[II5 6
$strII6 >
]II> ?
)II? @
,II@ A
PrecioVentaJJ #
=JJ$ %
ConvertJJ& -
.JJ- .
ToDoubleJJ. 6
(JJ6 7
drJJ7 9
[JJ9 :
$strJJ: G
]JJG H
)JJH I
,JJI J
TipoKK 
=KK 
newKK "
EntTipoProductoKK# 2
{LL 
NombreMM "
=MM# $
drMM% '
[MM' (
$strMM( .
]MM. /
.MM/ 0
ToStringMM0 8
(MM8 9
)MM9 :
}NN 
}OO 
;OO 
listaQQ 
.QQ 
AddQQ 
(QQ 
ProdQQ "
)QQ" #
;QQ# $
}RR 
}TT 
catchUU 
(UU 
	ExceptionUU 
eUU 
)UU 
{VV 
throwWW 
newWW 
	ExceptionWW #
(WW# $
eWW$ %
.WW% &
MessageWW& -
)WW- .
;WW. /
}XX 
returnZZ 
listaZZ 
;ZZ 
}[[ 	
public\\ 
bool\\ 
ActualizarProducto\\ &
(\\& '
EntProducto\\' 2
Prod\\3 7
)\\7 8
{]] 	

SqlCommand^^ 
cmd^^ 
=^^ 
null^^ !
;^^! "
bool__ 
	actualiza__ 
=__ 
false__ "
;__" #
try`` 
{aa 
SqlConnectionbb 
cnbb  
=bb! "
Conexionbb# +
.bb+ ,
	Instanciabb, 5
.bb5 6
Conectarbb6 >
(bb> ?
)bb? @
;bb@ A
cmdcc 
=cc 
newcc 

SqlCommandcc $
(cc$ %
$strcc% ;
,cc; <
cncc= ?
)cc? @
{dd 
CommandTypeee 
=ee  !
CommandTypeee" -
.ee- .
StoredProcedureee. =
}ff 
;ff 
cmdgg 
.gg 

Parametersgg 
.gg 
AddWithValuegg +
(gg+ ,
$strgg, 9
,gg9 :
Prodgg: >
.gg> ?

IdProductogg? I
)ggI J
;ggJ K
cmdhh 
.hh 

Parametershh 
.hh 
AddWithValuehh +
(hh+ ,
$strhh, 5
,hh5 6
Prodhh7 ;
.hh; <
Nombrehh< B
)hhB C
;hhC D
cmdii 
.ii 

Parametersii 
.ii 
AddWithValueii +
(ii+ ,
$strii, 7
,ii7 8
Prodii9 =
.ii= >
Longitudii> F
)iiF G
;iiG H
cmdjj 
.jj 

Parametersjj 
.jj 
AddWithValuejj +
(jj+ ,
$strjj, 7
,jj7 8
Prodjj9 =
.jj= >
Diametrojj> F
)jjF G
;jjG H
cmdkk 
.kk 

Parameterskk 
.kk 
AddWithValuekk +
(kk+ ,
$strkk, :
,kk: ;
Prodkk< @
.kk@ A
PrecioVentakkA L
)kkL M
;kkM N
cmdll 
.ll 

Parametersll 
.ll 
AddWithValuell +
(ll+ ,
$strll, >
,ll> ?
Prodll@ D
.llD E
TipollE I
.llI J
IdTipo_productollJ Y
)llY Z
;llZ [
cmdmm 
.mm 

Parametersmm 
.mm 
AddWithValuemm +
(mm+ ,
$strmm, 5
,mm5 6
Prodmm7 ;
.mm; <
Activomm< B
)mmB C
;mmC D
cnnn 
.nn 
Opennn 
(nn 
)nn 
;nn 
intoo 
ioo 
=oo 
cmdoo 
.oo 
ExecuteNonQueryoo +
(oo+ ,
)oo, -
;oo- .
ifpp 
(pp 
ipp 
>pp 
$numpp 
)pp 
{qq 
	actualizarr 
=rr 
truerr  $
;rr$ %
}ss 
}tt 
catchuu 
(uu 
	Exceptionuu 
euu 
)uu 
{vv 

MessageBoxww 
.ww 
Showww 
(ww  
$strww  4
+ww5 6
eww7 8
.ww8 9
Messageww9 @
)ww@ A
;wwA B
}xx 
finallyyy 
{yy 
cmdyy 
.yy 

Connectionyy $
.yy$ %
Closeyy% *
(yy* +
)yy+ ,
;yy, -
}yy. /
returnzz 
	actualizazz 
;zz 
}{{ 	
public~~ 
bool~~ 
EliminarProducto~~ $
(~~$ %
int~~% (
id~~) +
)~~+ ,
{ 	

SqlCommand
ÄÄ 
cmd
ÄÄ 
=
ÄÄ 
null
ÄÄ !
;
ÄÄ! "
bool
ÅÅ 
	eliminado
ÅÅ 
=
ÅÅ 
false
ÅÅ "
;
ÅÅ" #
try
ÇÇ 
{
ÉÉ 
SqlConnection
ÑÑ 
cn
ÑÑ  
=
ÑÑ! "
Conexion
ÑÑ# +
.
ÑÑ+ ,
	Instancia
ÑÑ, 5
.
ÑÑ5 6
Conectar
ÑÑ6 >
(
ÑÑ> ?
)
ÑÑ? @
;
ÑÑ@ A
cmd
ÖÖ 
=
ÖÖ 
new
ÖÖ 

SqlCommand
ÖÖ $
(
ÖÖ$ %
$str
ÖÖ% 9
,
ÖÖ9 :
cn
ÖÖ; =
)
ÖÖ= >
{
ÜÜ 
CommandType
áá 
=
áá  !
CommandType
áá" -
.
áá- .
StoredProcedure
áá. =
}
àà 
;
àà 
cmd
ââ 
.
ââ 

Parameters
ââ 
.
ââ 
AddWithValue
ââ +
(
ââ+ ,
$str
ââ, 9
,
ââ9 :
id
ââ; =
)
ââ= >
;
ââ> ?
cn
ää 
.
ää 
Open
ää 
(
ää 
)
ää 
;
ää 
int
ãã 
i
ãã 
=
ãã 
cmd
ãã 
.
ãã 
ExecuteNonQuery
ãã +
(
ãã+ ,
)
ãã, -
;
ãã- .
if
åå 
(
åå 
i
åå 
>
åå 
$num
åå 
)
åå 
{
çç 
	eliminado
éé 
=
éé 
true
éé  $
;
éé$ %
}
èè 
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
e
ëë 
)
ëë 
{
íí 

MessageBox
ìì 
.
ìì 
Show
ìì 
(
ìì  
e
ìì  !
.
ìì! "
Message
ìì" )
)
ìì) *
;
ìì* +
}
îî 
finally
ïï 
{
ïï 
cmd
ïï 
.
ïï 

Connection
ïï $
.
ïï$ %
Close
ïï% *
(
ïï* +
)
ïï+ ,
;
ïï, -
}
ïï. /
return
ññ 
	eliminado
ññ 
;
ññ 
}
óó 	
public
ôô 
List
ôô 
<
ôô 
EntProducto
ôô 
>
ôô  
BuscarProducto
ôô! /
(
ôô/ 0
string
ôô0 6
busqueda
ôô7 ?
)
ôô? @
{
öö 	
List
õõ 
<
õõ 
EntProducto
õõ 
>
õõ 
lista
õõ #
=
õõ$ %
new
õõ& )
List
õõ* .
<
õõ. /
EntProducto
õõ/ :
>
õõ: ;
(
õõ; <
)
õõ< =
;
õõ= >

SqlCommand
úú 
cmd
úú 
=
úú 
null
úú !
;
úú! "
try
ùù 
{
ûû 
SqlConnection
üü 
cn
üü  
=
üü! "
Conexion
üü# +
.
üü+ ,
	Instancia
üü, 5
.
üü5 6
Conectar
üü6 >
(
üü> ?
)
üü? @
;
üü@ A
cmd
†† 
=
†† 
new
†† 

SqlCommand
†† $
(
††$ %
$str
††% 7
,
††7 8
cn
††9 ;
)
††; <
{
°° 
CommandType
¢¢ 
=
¢¢  !
CommandType
¢¢" -
.
¢¢- .
StoredProcedure
¢¢. =
}
££ 
;
££ 
cmd
§§ 
.
§§ 

Parameters
§§ 
.
§§ 
AddWithValue
§§ +
(
§§+ ,
$str
§§, 4
,
§§4 5
busqueda
§§6 >
)
§§> ?
;
§§? @
cn
•• 
.
•• 
Open
•• 
(
•• 
)
•• 
;
•• 
SqlDataReader
¶¶ 
dr
¶¶  
=
¶¶! "
cmd
¶¶# &
.
¶¶& '
ExecuteReader
¶¶' 4
(
¶¶4 5
)
¶¶5 6
;
¶¶6 7
while
ßß 
(
ßß 
dr
ßß 
.
ßß 
Read
ßß 
(
ßß 
)
ßß  
)
ßß  !
{
®® 
EntProducto
™™ 
Prod
™™  $
=
™™% &
new
™™' *
EntProducto
™™+ 6
{
´´ 

IdProducto
¨¨ "
=
¨¨# $
Convert
¨¨% ,
.
¨¨, -
ToInt32
¨¨- 4
(
¨¨4 5
dr
¨¨5 7
[
¨¨7 8
$str
¨¨8 D
]
¨¨D E
)
¨¨E F
,
¨¨F G
Nombre
≠≠ 
=
≠≠  
dr
≠≠! #
[
≠≠# $
$str
≠≠$ ,
]
≠≠, -
.
≠≠- .
ToString
≠≠. 6
(
≠≠6 7
)
≠≠7 8
,
≠≠8 9
Longitud
ÆÆ  
=
ÆÆ! "
Convert
ÆÆ# *
.
ÆÆ* +
ToDouble
ÆÆ+ 3
(
ÆÆ3 4
dr
ÆÆ4 6
[
ÆÆ6 7
$str
ÆÆ7 A
]
ÆÆA B
)
ÆÆB C
,
ÆÆC D
Diametro
ØØ  
=
ØØ! "
Convert
ØØ# *
.
ØØ* +
ToDouble
ØØ+ 3
(
ØØ3 4
dr
ØØ4 6
[
ØØ6 7
$str
ØØ7 A
]
ØØA B
)
ØØB C
,
ØØC D
Stock
∞∞ 
=
∞∞ 
Convert
∞∞  '
.
∞∞' (
ToInt32
∞∞( /
(
∞∞/ 0
dr
∞∞0 2
[
∞∞2 3
$str
∞∞3 :
]
∞∞: ;
)
∞∞; <
,
∞∞< =
Activo
±± 
=
±±  
Convert
±±! (
.
±±( )
	ToBoolean
±±) 2
(
±±2 3
dr
±±3 5
[
±±5 6
$str
±±6 >
]
±±> ?
)
±±? @
,
±±@ A
PrecioVenta
≤≤ #
=
≤≤$ %
Convert
≤≤& -
.
≤≤- .
ToDouble
≤≤. 6
(
≤≤6 7
dr
≤≤7 9
[
≤≤9 :
$str
≤≤: G
]
≤≤G H
)
≤≤H I
,
≤≤I J
Tipo
≥≥ 
=
≥≥ 
new
≥≥ "
EntTipoProducto
≥≥# 2
{
¥¥ 
Nombre
µµ "
=
µµ# $
dr
µµ% '
[
µµ' (
$str
µµ( .
]
µµ. /
.
µµ/ 0
ToString
µµ0 8
(
µµ8 9
)
µµ9 :
}
∂∂ 
}
∑∑ 
;
∑∑ 
lista
ππ 
.
ππ 
Add
ππ 
(
ππ 
Prod
ππ "
)
ππ" #
;
ππ# $
}
∫∫ 
}
ªª 
catch
ºº 
(
ºº 
	Exception
ºº 
e
ºº 
)
ºº 
{
ΩΩ 

MessageBox
øø 
.
øø 
Show
øø 
(
øø  
e
øø  !
.
øø! "
Message
øø" )
)
øø) *
;
øø* +
}
¿¿ 
finally
¡¡ 
{
¬¬ 
cmd
√√ 
.
√√ 

Connection
√√ 
.
√√ 
Close
√√ $
(
√√$ %
)
√√% &
;
√√& '
}
ƒƒ 
return
≈≈ 
lista
≈≈ 
;
≈≈ 
}
∆∆ 	
public
»» 
EntProducto
»» 
BuscarProductoId
»» +
(
»»+ ,
int
»», /
idprod
»»0 6
)
»»6 7
{
…… 	

SqlCommand
   
cmd
   
=
   
null
   !
;
  ! "
EntProducto
ÀÀ 
Prod
ÀÀ 
=
ÀÀ 
new
ÀÀ "
EntProducto
ÀÀ# .
(
ÀÀ. /
)
ÀÀ/ 0
;
ÀÀ0 1
try
ÃÃ 
{
ÕÕ 
SqlConnection
ŒŒ 
cn
ŒŒ  
=
ŒŒ! "
Conexion
ŒŒ# +
.
ŒŒ+ ,
	Instancia
ŒŒ, 5
.
ŒŒ5 6
Conectar
ŒŒ6 >
(
ŒŒ> ?
)
ŒŒ? @
;
ŒŒ@ A
cmd
œœ 
=
œœ 
new
œœ 

SqlCommand
œœ $
(
œœ$ %
$str
œœ% 9
,
œœ9 :
cn
œœ; =
)
œœ= >
{
–– 
CommandType
—— 
=
——  !
CommandType
——" -
.
——- .
StoredProcedure
——. =
}
““ 
;
““ 
cmd
”” 
.
”” 

Parameters
”” 
.
”” 
AddWithValue
”” +
(
””+ ,
$str
””, ?
,
””? @
idprod
””A G
)
””G H
;
””H I
cn
‘‘ 
.
‘‘ 
Open
‘‘ 
(
‘‘ 
)
‘‘ 
;
‘‘ 
SqlDataReader
’’ 
dr
’’  
=
’’! "
cmd
’’# &
.
’’& '
ExecuteReader
’’' 4
(
’’4 5
)
’’5 6
;
’’6 7
while
÷÷ 
(
÷÷ 
dr
÷÷ 
.
÷÷ 
Read
÷÷ 
(
÷÷ 
)
÷÷  
)
÷÷  !
{
◊◊ 
Prod
⁄⁄ 
.
⁄⁄ 

IdProducto
⁄⁄ #
=
⁄⁄$ %
Convert
⁄⁄& -
.
⁄⁄- .
ToInt32
⁄⁄. 5
(
⁄⁄5 6
dr
⁄⁄6 8
[
⁄⁄8 9
$str
⁄⁄9 E
]
⁄⁄E F
)
⁄⁄F G
;
⁄⁄G H
Prod
€€ 
.
€€ 
Nombre
€€ 
=
€€  !
dr
€€" $
[
€€$ %
$str
€€% -
]
€€- .
.
€€. /
ToString
€€/ 7
(
€€7 8
)
€€8 9
;
€€9 :
Prod
‹‹ 
.
‹‹ 
Longitud
‹‹ !
=
‹‹" #
Convert
‹‹$ +
.
‹‹+ ,
ToDouble
‹‹, 4
(
‹‹4 5
dr
‹‹5 7
[
‹‹7 8
$str
‹‹8 B
]
‹‹B C
)
‹‹C D
;
‹‹D E
Prod
›› 
.
›› 
Diametro
›› !
=
››" #
Convert
››$ +
.
››+ ,
ToDouble
››, 4
(
››4 5
dr
››5 7
[
››7 8
$str
››8 B
]
››B C
)
››C D
;
››D E
Prod
ﬁﬁ 
.
ﬁﬁ 
PrecioVenta
ﬁﬁ $
=
ﬁﬁ% &
Convert
ﬁﬁ' .
.
ﬁﬁ. /
ToDouble
ﬁﬁ/ 7
(
ﬁﬁ7 8
dr
ﬁﬁ8 :
[
ﬁﬁ: ;
$str
ﬁﬁ; H
]
ﬁﬁH I
)
ﬁﬁI J
;
ﬁﬁJ K
Prod
ﬂﬂ 
.
ﬂﬂ 
Activo
ﬂﬂ 
=
ﬂﬂ  !
Convert
ﬂﬂ" )
.
ﬂﬂ) *
	ToBoolean
ﬂﬂ* 3
(
ﬂﬂ3 4
dr
ﬂﬂ4 6
[
ﬂﬂ6 7
$str
ﬂﬂ7 ?
]
ﬂﬂ? @
)
ﬂﬂ@ A
;
ﬂﬂA B
Prod
‡‡ 
.
‡‡ 
Tipo
‡‡ 
=
‡‡ 
new
‡‡  #
EntTipoProducto
‡‡$ 3
{
·· 
IdTipo_producto
‚‚ '
=
‚‚( )
Convert
‚‚* 1
.
‚‚1 2
ToInt32
‚‚2 9
(
‚‚9 :
dr
‚‚: <
[
‚‚< =
$str
‚‚= N
]
‚‚N O
)
‚‚O P
,
‚‚P Q
Nombre
„„ 
=
„„  
dr
„„! #
[
„„# $
$str
„„$ *
]
„„* +
.
„„+ ,
ToString
„„, 4
(
„„4 5
)
„„5 6
}
ÂÂ 
;
ÂÂ 
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
e
ÈÈ 
)
ÈÈ 
{
ÍÍ 

MessageBox
ÏÏ 
.
ÏÏ 
Show
ÏÏ 
(
ÏÏ  
e
ÏÏ  !
.
ÏÏ! "
Message
ÏÏ" )
)
ÏÏ) *
;
ÏÏ* +
}
ÌÌ 
finally
ÓÓ 
{
ÓÓ 
cmd
ÓÓ 
.
ÓÓ 

Connection
ÓÓ $
.
ÓÓ$ %
Close
ÓÓ% *
(
ÓÓ* +
)
ÓÓ+ ,
;
ÓÓ, -
}
ÓÓ. /
return
ÔÔ 
Prod
ÔÔ 
;
ÔÔ 
}
 	
public
ÛÛ 
List
ÛÛ 
<
ÛÛ "
EntProveedorProducto
ÛÛ (
>
ÛÛ( )
Ordenar
ÛÛ* 1
(
ÛÛ1 2
int
ÛÛ2 5
dato
ÛÛ6 :
)
ÛÛ: ;
{
ÙÙ 	
List
ıı 
<
ıı "
EntProveedorProducto
ıı %
>
ıı% &
lista
ıı' ,
=
ıı- .
new
ıı/ 2
List
ıı3 7
<
ıı7 8"
EntProveedorProducto
ıı8 L
>
ııL M
(
ııM N
)
ııN O
;
ııO P

SqlCommand
ˆˆ 
cmd
ˆˆ 
=
ˆˆ 
null
ˆˆ !
;
ˆˆ! "
try
˜˜ 
{
¯¯ 
SqlConnection
˘˘ 
cn
˘˘  
=
˘˘! "
Conexion
˘˘# +
.
˘˘+ ,
	Instancia
˘˘, 5
.
˘˘5 6
Conectar
˘˘6 >
(
˘˘> ?
)
˘˘? @
;
˘˘@ A
cmd
˙˙ 
=
˙˙ 
new
˙˙ 

SqlCommand
˙˙ $
(
˙˙$ %
$str
˙˙% 8
,
˙˙8 9
cn
˙˙: <
)
˙˙< =
{
˚˚ 
CommandType
¸¸ 
=
¸¸  !
CommandType
¸¸" -
.
¸¸- .
StoredProcedure
¸¸. =
}
˝˝ 
;
˝˝ 
cmd
˛˛ 
.
˛˛ 

Parameters
˛˛ 
.
˛˛ 
AddWithValue
˛˛ +
(
˛˛+ ,
$str
˛˛, 3
,
˛˛3 4
dato
˛˛5 9
)
˛˛9 :
;
˛˛: ;
cn
ˇˇ 
.
ˇˇ 
Open
ˇˇ 
(
ˇˇ 
)
ˇˇ 
;
ˇˇ 
SqlDataReader
ÄÄ 
dr
ÄÄ  
=
ÄÄ! "
cmd
ÄÄ# &
.
ÄÄ& '
ExecuteReader
ÄÄ' 4
(
ÄÄ4 5
)
ÄÄ5 6
;
ÄÄ6 7
while
ÅÅ 
(
ÅÅ 
dr
ÅÅ 
.
ÅÅ 
Read
ÅÅ 
(
ÅÅ 
)
ÅÅ  
)
ÅÅ  !
{
ÇÇ "
EntProveedorProducto
ÉÉ (
Prod
ÉÉ) -
=
ÉÉ. /
new
ÉÉ0 3"
EntProveedorProducto
ÉÉ4 H
{
ÑÑ 
PrecioCompra
ÖÖ $
=
ÖÖ% &
Convert
ÖÖ' .
.
ÖÖ. /
ToDouble
ÖÖ/ 7
(
ÖÖ7 8
dr
ÖÖ8 :
[
ÖÖ: ;
$str
ÖÖ; I
]
ÖÖI J
)
ÖÖJ K
,
ÖÖK L
Producto
áá  
=
áá! "
new
áá# &
EntProducto
áá' 2
{
àà 

IdProducto
ââ &
=
ââ' (
Convert
ââ) 0
.
ââ0 1
ToInt32
ââ1 8
(
ââ8 9
dr
ââ9 ;
[
ââ; <
$str
ââ< H
]
ââH I
)
ââI J
,
ââJ K
Nombre
ää "
=
ää# $
dr
ää% '
[
ää' (
$str
ää( 0
]
ää0 1
.
ää1 2
ToString
ää2 :
(
ää: ;
)
ää; <
,
ää< =
Longitud
ãã $
=
ãã% &
Convert
ãã' .
.
ãã. /
ToDouble
ãã/ 7
(
ãã7 8
dr
ãã8 :
[
ãã: ;
$str
ãã; E
]
ããE F
)
ããF G
,
ããG H
PrecioVenta
åå '
=
åå( )
Convert
åå* 1
.
åå1 2
ToDouble
åå2 :
(
åå: ;
dr
åå; =
[
åå= >
$str
åå> K
]
ååK L
)
ååL M
,
ååM N
Stock
çç !
=
çç" #
Convert
çç$ +
.
çç+ ,
ToInt32
çç, 3
(
çç3 4
dr
çç4 6
[
çç6 7
$str
çç7 >
]
çç> ?
)
çç? @
,
çç@ A
Tipo
éé  
=
éé! "
new
éé# &
EntTipoProducto
éé' 6
{
èè 
IdTipo_producto
êê  /
=
êê0 1
Convert
êê2 9
.
êê9 :
ToInt32
êê: A
(
êêA B
dr
êêB D
[
êêD E
$str
êêE V
]
êêV W
)
êêW X
,
êêX Y
Nombre
ëë  &
=
ëë' (
dr
ëë) +
[
ëë+ ,
$str
ëë, 2
]
ëë2 3
.
ëë3 4
ToString
ëë4 <
(
ëë< =
)
ëë= >
}
íí 
}
ìì 
}
îî 
;
îî 
lista
óó 
.
óó 
Add
óó 
(
óó 
Prod
óó "
)
óó" #
;
óó# $
}
òò 
}
ôô 
catch
öö 
(
öö 
	Exception
öö 
e
öö 
)
öö 
{
õõ 

MessageBox
ùù 
.
ùù 
Show
ùù 
(
ùù  
e
ùù  !
.
ùù! "
Message
ùù" )
)
ùù) *
;
ùù* +
}
ûû 
finally
üü 
{
†† 
cmd
°° 
.
°° 

Connection
°° 
.
°° 
Close
°° $
(
°°$ %
)
°°% &
;
°°& '
}
¢¢ 
return
££ 
lista
££ 
;
££ 
}
§§ 	
}
ßß 
}®® ÿÒ
]C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProveedor.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatProveedor 
: 
IDatProveedor  -
{ 
private 
static 
readonly 
DatProveedor  ,
	_instance- 6
=7 8
new9 <
DatProveedor= I
(I J
)J K
;K L
public 
static 
DatProveedor "
	Instancia# ,
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
bool 
CrearProveedor "
(" #
EntProveedor# /
pro0 3
)3 4
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 7
,7 8
cn9 ;
); <
;< =
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
pro< ?
.? @
RazonSocial@ K
)K L
;L M
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 2
,2 3
pro4 7
.7 8
Ruc8 ;
); <
;< =
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 5
,  5 6
pro  7 :
.  : ;
Correo  ; A
)  A B
;  B C
cmd!! 
.!! 

Parameters!! 
.!! 
AddWithValue!! +
(!!+ ,
$str!!, 7
,!!7 8
pro!!9 <
.!!< =
Telefono!!= E
)!!E F
;!!F G
cmd"" 
."" 

Parameters"" 
."" 
AddWithValue"" +
(""+ ,
$str"", :
,"": ;
pro""< ?
.""? @
Descripcion""@ K
)""K L
;""L M
cmd## 
.## 

Parameters## 
.## 
AddWithValue## +
(##+ ,
$str##, ;
,##; <
pro##= @
.##@ A
EstProveedor##A M
)##M N
;##N O
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
AddWithValue$$ +
($$+ ,
$str$$, 7
,$$7 8
pro$$9 <
.$$< =
Ubigeo$$= C
.$$C D
IdUbigeo$$D L
)$$L M
;$$M N
cn%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
int&& 
i&& 
=&& 
cmd&& 
.&& 
ExecuteNonQuery&& +
(&&+ ,
)&&, -
;&&- .
if'' 
('' 
i'' 
>'' 
$num'' 
)'' 
{(( 
creado)) 
=)) 
true)) !
;))! "
}** 
}++ 
catch,, 
(,, 
	Exception,, 
e,, 
),, 
{-- 
throw.. 
new.. 
	Exception.. 
(..  
e..  !
...! "
Message.." )
)..) *
;..* +
}// 
return00 
creado00 
;00 
}11 	
public33 
List33 
<33 
EntProveedor33  
>33  !
ListarProveedor33" 1
(331 2
)332 3
{44 	

SqlCommand55 
cmd55 
=55 
null55 !
;55! "
List66 
<66 
EntProveedor66 
>66 
list66 #
=66$ %
new66& )
List66* .
<66. /
EntProveedor66/ ;
>66; <
(66< =
)66= >
;66> ?
try77 
{88 
SqlConnection99 
cn99  
=99! "
Conexion99# +
.99+ ,
	Instancia99, 5
.995 6
Conectar996 >
(99> ?
)99? @
;99@ A
cmd:: 
=:: 
new:: 

SqlCommand:: $
(::$ %
$str::% 8
,::8 9
cn::: <
)::< =
{;; 
CommandType<< 
=<<  !
CommandType<<" -
.<<- .
StoredProcedure<<. =
}== 
;== 
cn>> 
.>> 
Open>> 
(>> 
)>> 
;>> 
SqlDataReader?? 
dr??  
=??! "
cmd??# &
.??& '
ExecuteReader??' 4
(??4 5
)??5 6
;??6 7
while@@ 
(@@ 
dr@@ 
.@@ 
Read@@ 
(@@ 
)@@  
)@@  !
{AA 
EntProveedorBB  
proBB! $
=BB% &
newBB' *
EntProveedorBB+ 7
{CC 
IdProveedorDD #
=DD$ %
ConvertDD& -
.DD- .
ToInt32DD. 5
(DD5 6
drDD6 8
[DD8 9
$strDD9 F
]DDF G
)DDG H
,DDH I
RazonSocialEE #
=EE$ %
drEE& (
[EE( )
$strEE) 6
]EE6 7
.EE7 8
ToStringEE8 @
(EE@ A
)EEA B
,EEB C
RucFF 
=FF 
drFF  
[FF  !
$strFF! &
]FF& '
.FF' (
ToStringFF( 0
(FF0 1
)FF1 2
,FF2 3
CorreoGG 
=GG  
drGG! #
[GG# $
$strGG$ ,
]GG, -
.GG- .
ToStringGG. 6
(GG6 7
)GG7 8
,GG8 9
TelefonoHH  
=HH! "
drHH# %
[HH% &
$strHH& 0
]HH0 1
.HH1 2
ToStringHH2 :
(HH: ;
)HH; <
,HH< =
DescripcionII #
=II$ %
drII& (
[II( )
$strII) 6
]II6 7
.II7 8
ToStringII8 @
(II@ A
)IIA B
,IIB C
EstProveedorJJ $
=JJ% &
ConvertJJ' .
.JJ. /
	ToBooleanJJ/ 8
(JJ8 9
drJJ9 ;
[JJ; <
$strJJ< J
]JJJ K
)JJK L
}KK 
;KK 
	EntUbigeoMM 
ubiMM !
=MM" #
newMM$ '
	EntUbigeoMM( 1
{NN 
DepartamentoOO $
=OO% &
drOO' )
[OO) *
$strOO* 8
]OO8 9
.OO9 :
ToStringOO: B
(OOB C
)OOC D
,OOD E
	ProvinciaPP !
=PP" #
drPP$ &
[PP& '
$strPP' 2
]PP2 3
.PP3 4
ToStringPP4 <
(PP< =
)PP= >
,PP> ?
DistritoQQ  
=QQ! "
drQQ# %
[QQ% &
$strQQ& 0
]QQ0 1
.QQ1 2
ToStringQQ2 :
(QQ: ;
)QQ; <
}RR 
;RR 
proTT 
.TT 
UbigeoTT 
=TT  
ubiTT! $
;TT$ %
listUU 
.UU 
AddUU 
(UU 
proUU  
)UU  !
;UU! "
}VV 
}WW 
catchXX 
(XX 
	ExceptionXX 
eXX 
)XX 
{YY 

MessageBox[[ 
.[[ 
Show[[ 
([[  
e[[  !
.[[! "
Message[[" )
+[[* +
$str[[, >
)[[> ?
;[[? @
}\\ 
finally]] 
{^^ 
cmd__ 
.__ 

Connection__ 
.__ 
Close__ $
(__$ %
)__% &
;__& '
}`` 
returnaa 
listaa 
;aa 
}bb 	
publicdd 
Listdd 
<dd 
EntProveedordd  
>dd  !
SelectListProveedordd" 5
(dd5 6
)dd6 7
{ee 	

SqlCommandff 
cmdff 
=ff 
nullff !
;ff! "
vargg 
listgg 
=gg 
newgg 
Listgg 
<gg  
EntProveedorgg  ,
>gg, -
(gg- .
)gg. /
;gg/ 0
tryhh 
{ii 
SqlConnectionjj 
cnjj  
=jj! "
Conexionjj# +
.jj+ ,
	Instanciajj, 5
.jj5 6
Conectarjj6 >
(jj> ?
)jj? @
;jj@ A
cmdkk 
=kk 
newkk 

SqlCommandkk $
(kk$ %
$strkk% <
,kk< =
cnkk> @
)kk@ A
{ll 
CommandTypemm 
=mm  !
CommandTypemm" -
.mm- .
StoredProceduremm. =
}nn 
;nn 
cnoo 
.oo 
Openoo 
(oo 
)oo 
;oo 
SqlDataReaderpp 
drpp  
=pp! "
cmdpp# &
.pp& '
ExecuteReaderpp' 4
(pp4 5
)pp5 6
;pp6 7
whileqq 
(qq 
drqq 
.qq 
Readqq 
(qq 
)qq  
)qq  !
{rr 
EntProveedorss  
pross! $
=ss% &
newss' *
EntProveedorss+ 7
{tt 
IdProveedoruu #
=uu$ %
Convertuu& -
.uu- .
ToInt32uu. 5
(uu5 6
druu6 8
[uu8 9
$struu9 F
]uuF G
)uuG H
,uuH I
RazonSocialvv #
=vv$ %
drvv& (
[vv( )
$strvv) 6
]vv6 7
.vv7 8
ToStringvv8 @
(vv@ A
)vvA B
,vvB C
Descripcionww #
=ww$ %
drww& (
[ww( )
$strww) 6
]ww6 7
.ww7 8
ToStringww8 @
(ww@ A
)wwA B
,wwB C
}xx 
;xx 
listyy 
.yy 
Addyy 
(yy 
proyy  
)yy  !
;yy! "
}zz 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 

MessageBox 
. 
Show 
(  
e  !
.! "
Message" )
+* +
$str, >
)> ?
;? @
}
ÄÄ 
finally
ÅÅ 
{
ÇÇ 
cmd
ÉÉ 
.
ÉÉ 

Connection
ÉÉ 
.
ÉÉ 
Close
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÑÑ 
return
ÖÖ 
list
ÖÖ 
;
ÖÖ 
}
áá 	
public
ââ 
bool
ââ !
ActualizarProveedor
ââ '
(
ââ' (
EntProveedor
ââ( 4
pro
ââ5 8
)
ââ8 9
{
ää 	

SqlCommand
ãã 
cmd
ãã 
=
ãã 
null
ãã !
;
ãã! "
bool
åå 
actualizado
åå 
=
åå 
false
åå $
;
åå$ %
try
çç 
{
éé 
SqlConnection
èè 
cn
èè  
=
èè! "
Conexion
èè# +
.
èè+ ,
	Instancia
èè, 5
.
èè5 6
Conectar
èè6 >
(
èè> ?
)
èè? @
;
èè@ A
cmd
êê 
=
êê 
new
êê 

SqlCommand
êê $
(
êê$ %
$str
êê% <
,
êê< =
cn
êê> @
)
êê@ A
{
ëë 
CommandType
íí 
=
íí  !
CommandType
íí" -
.
íí- .
StoredProcedure
íí. =
}
ìì 
;
ìì 
cmd
îî 
.
îî 

Parameters
îî 
.
îî 
AddWithValue
îî +
(
îî+ ,
$str
îî, :
,
îî: ;
pro
îî< ?
.
îî? @
IdProveedor
îî@ K
)
îîK L
;
îîL M
cmd
ïï 
.
ïï 

Parameters
ïï 
.
ïï 
AddWithValue
ïï +
(
ïï+ ,
$str
ïï, :
,
ïï: ;
pro
ïï< ?
.
ïï? @
RazonSocial
ïï@ K
)
ïïK L
;
ïïL M
cmd
ññ 
.
ññ 

Parameters
ññ 
.
ññ 
AddWithValue
ññ +
(
ññ+ ,
$str
ññ, 2
,
ññ2 3
pro
ññ4 7
.
ññ7 8
Ruc
ññ8 ;
)
ññ; <
;
ññ< =
cmd
óó 
.
óó 

Parameters
óó 
.
óó 
AddWithValue
óó +
(
óó+ ,
$str
óó, 5
,
óó5 6
pro
óó7 :
.
óó: ;
Correo
óó; A
)
óóA B
;
óóB C
cmd
òò 
.
òò 

Parameters
òò 
.
òò 
AddWithValue
òò +
(
òò+ ,
$str
òò, 7
,
òò7 8
pro
òò9 <
.
òò< =
Telefono
òò= E
)
òòE F
;
òòF G
cmd
ôô 
.
ôô 

Parameters
ôô 
.
ôô 
AddWithValue
ôô +
(
ôô+ ,
$str
ôô, :
,
ôô: ;
pro
ôô< ?
.
ôô? @
Descripcion
ôô@ K
)
ôôK L
;
ôôL M
cmd
öö 
.
öö 

Parameters
öö 
.
öö 
AddWithValue
öö +
(
öö+ ,
$str
öö, ;
,
öö; <
pro
öö= @
.
öö@ A
EstProveedor
ööA M
)
ööM N
;
ööN O
cmd
õõ 
.
õõ 

Parameters
õõ 
.
õõ 
AddWithValue
õõ +
(
õõ+ ,
$str
õõ, 7
,
õõ7 8
pro
õõ9 <
.
õõ< =
Ubigeo
õõ= C
.
õõC D
IdUbigeo
õõD L
)
õõL M
;
õõM N
cn
úú 
.
úú 
Open
úú 
(
úú 
)
úú 
;
úú 
int
ùù 
i
ùù 
=
ùù 
cmd
ùù 
.
ùù 
ExecuteNonQuery
ùù +
(
ùù+ ,
)
ùù, -
;
ùù- .
if
ûû 
(
ûû 
i
ûû 
>
ûû 
$num
ûû 
)
ûû 
{
üü 
actualizado
†† 
=
††  !
true
††" &
;
††& '
}
°° 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
e
££ 
)
££ 
{
§§ 
throw
¶¶ 
new
¶¶ 
	Exception
¶¶ #
(
¶¶# $
e
¶¶$ %
.
¶¶% &
Message
¶¶& -
)
¶¶- .
;
¶¶. /
}
ßß 
return
©© 
actualizado
©© 
;
©© 
}
™™ 	
public
¨¨ 
bool
¨¨ 
EliminarProveedor
¨¨ %
(
¨¨% &
int
¨¨& )
idProveedor
¨¨* 5
)
¨¨5 6
{
≠≠ 	

SqlCommand
ÆÆ 
cmd
ÆÆ 
=
ÆÆ 
null
ÆÆ !
;
ÆÆ! "
bool
ØØ 
	eliminado
ØØ 
=
ØØ 
false
ØØ "
;
ØØ" #
try
∞∞ 
{
±± 
SqlConnection
≤≤ 
cn
≤≤  
=
≤≤! "
Conexion
≤≤# +
.
≤≤+ ,
	Instancia
≤≤, 5
.
≤≤5 6
Conectar
≤≤6 >
(
≤≤> ?
)
≤≤? @
;
≤≤@ A
cmd
≥≥ 
=
≥≥ 
new
≥≥ 

SqlCommand
≥≥ $
(
≥≥$ %
$str
≥≥% :
,
≥≥: ;
cn
≥≥< >
)
≥≥> ?
;
≥≥? @
cmd
¥¥ 
.
¥¥ 
CommandType
¥¥ 
=
¥¥  !
CommandType
¥¥" -
.
¥¥- .
StoredProcedure
¥¥. =
;
¥¥= >
cmd
µµ 
.
µµ 

Parameters
µµ 
.
µµ 
AddWithValue
µµ +
(
µµ+ ,
$str
µµ, :
,
µµ: ;
idProveedor
µµ< G
)
µµG H
;
µµH I
cn
∂∂ 
.
∂∂ 
Open
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂ 
int
∑∑ 
i
∑∑ 
=
∑∑ 
cmd
∑∑ 
.
∑∑ 
ExecuteNonQuery
∑∑ +
(
∑∑+ ,
)
∑∑, -
;
∑∑- .
if
∏∏ 
(
∏∏ 
i
∏∏ 
>
∏∏ 
$num
∏∏ 
)
∏∏ 
{
ππ 
	eliminado
∫∫ 
=
∫∫ 
true
∫∫  $
;
∫∫$ %
}
ªª 
}
ºº 
catch
ΩΩ 
(
ΩΩ 
	Exception
ΩΩ 
e
ΩΩ 
)
ΩΩ 
{
ææ 

MessageBox
¿¿ 
.
¿¿ 
Show
¿¿ 
(
¿¿  
e
¿¿  !
.
¿¿! "
Message
¿¿" )
)
¿¿) *
;
¿¿* +
}
¡¡ 
finally
¬¬ 
{
√√ 
cmd
ƒƒ 
.
ƒƒ 

Connection
ƒƒ 
.
ƒƒ 
Close
ƒƒ $
(
ƒƒ$ %
)
ƒƒ% &
;
ƒƒ& '
}
≈≈ 
return
∆∆ 
	eliminado
∆∆ 
;
∆∆ 
}
«« 	
public
…… 
List
…… 
<
…… 
EntProveedor
……  
>
……  !$
SelectListProveedordat
……" 8
(
……8 9
int
……9 <
idprov
……= C
)
……C D
{
   	

SqlCommand
ÀÀ 
cmd
ÀÀ 
=
ÀÀ 
null
ÀÀ !
;
ÀÀ! "
var
ÃÃ 
list
ÃÃ 
=
ÃÃ 
new
ÃÃ 
List
ÃÃ 
<
ÃÃ  
EntProveedor
ÃÃ  ,
>
ÃÃ, -
(
ÃÃ- .
)
ÃÃ. /
;
ÃÃ/ 0
try
ÕÕ 
{
ŒŒ 
SqlConnection
œœ 
cn
œœ  
=
œœ! "
Conexion
œœ# +
.
œœ+ ,
	Instancia
œœ, 5
.
œœ5 6
Conectar
œœ6 >
(
œœ> ?
)
œœ? @
;
œœ@ A
cmd
–– 
=
–– 
new
–– 

SqlCommand
–– $
(
––$ %
$str
––% ?
,
––? @
cn
––A C
)
––C D
{
—— 
CommandType
““ 
=
““  !
CommandType
““" -
.
““- .
StoredProcedure
““. =
,
““= >
}
”” 
;
”” 
cmd
‘‘ 
.
‘‘ 

Parameters
‘‘ 
.
‘‘ 
AddWithValue
‘‘ +
(
‘‘+ ,
$str
‘‘, 3
,
‘‘3 4
idprov
‘‘4 :
)
‘‘: ;
;
‘‘; <
cn
’’ 
.
’’ 
Open
’’ 
(
’’ 
)
’’ 
;
’’ 
SqlDataReader
÷÷ 
dr
÷÷  
=
÷÷! "
cmd
÷÷# &
.
÷÷& '
ExecuteReader
÷÷' 4
(
÷÷4 5
)
÷÷5 6
;
÷÷6 7
while
◊◊ 
(
◊◊ 
dr
◊◊ 
.
◊◊ 
Read
◊◊ 
(
◊◊ 
)
◊◊  
)
◊◊  !
{
ÿÿ 
EntProveedor
ŸŸ  
pro
ŸŸ! $
=
ŸŸ% &
new
ŸŸ' *
EntProveedor
ŸŸ+ 7
{
⁄⁄ 
IdProveedor
€€ #
=
€€$ %
Convert
€€& -
.
€€- .
ToInt32
€€. 5
(
€€5 6
dr
€€6 8
[
€€8 9
$str
€€9 F
]
€€F G
)
€€G H
,
€€H I
RazonSocial
‹‹ #
=
‹‹$ %
dr
‹‹& (
[
‹‹( )
$str
‹‹) 6
]
‹‹6 7
.
‹‹7 8
ToString
‹‹8 @
(
‹‹@ A
)
‹‹A B
,
‹‹B C
Descripcion
›› #
=
››$ %
dr
››& (
[
››( )
$str
››) 6
]
››6 7
.
››7 8
ToString
››8 @
(
››@ A
)
››A B
,
››B C
}
ﬁﬁ 
;
ﬁﬁ 
list
ﬂﬂ 
.
ﬂﬂ 
Add
ﬂﬂ 
(
ﬂﬂ 
pro
ﬂﬂ  
)
ﬂﬂ  !
;
ﬂﬂ! "
}
‡‡ 
}
·· 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
e
‚‚ 
)
‚‚ 
{
„„ 

MessageBox
ÂÂ 
.
ÂÂ 
Show
ÂÂ 
(
ÂÂ  
e
ÂÂ  !
.
ÂÂ! "
Message
ÂÂ" )
+
ÂÂ* +
$str
ÂÂ, >
)
ÂÂ> ?
;
ÂÂ? @
}
ÊÊ 
finally
ÁÁ 
{
ËË 
cmd
ÈÈ 
.
ÈÈ 

Connection
ÈÈ 
.
ÈÈ 
Close
ÈÈ $
(
ÈÈ$ %
)
ÈÈ% &
;
ÈÈ& '
}
ÍÍ 
return
ÎÎ 
list
ÎÎ 
;
ÎÎ 
}
ÌÌ 	
public
ÔÔ 
List
ÔÔ 
<
ÔÔ 
EntProveedor
ÔÔ  
>
ÔÔ  !
BuscarProveedor
ÔÔ" 1
(
ÔÔ1 2
string
ÔÔ2 8
busqueda
ÔÔ9 A
)
ÔÔA B
{
 	
List
ÒÒ 
<
ÒÒ 
EntProveedor
ÒÒ 
>
ÒÒ 
list
ÒÒ #
=
ÒÒ$ %
new
ÒÒ& )
List
ÒÒ* .
<
ÒÒ. /
EntProveedor
ÒÒ/ ;
>
ÒÒ; <
(
ÒÒ< =
)
ÒÒ= >
;
ÒÒ> ?

SqlCommand
ÚÚ 
cmd
ÚÚ 
=
ÚÚ 
null
ÚÚ !
;
ÚÚ! "
try
ÛÛ 
{
ÙÙ 
SqlConnection
ıı 
cn
ıı  
=
ıı! "
Conexion
ıı# +
.
ıı+ ,
	Instancia
ıı, 5
.
ıı5 6
Conectar
ıı6 >
(
ıı> ?
)
ıı? @
;
ıı@ A
cmd
ˆˆ 
=
ˆˆ 
new
ˆˆ 

SqlCommand
ˆˆ $
(
ˆˆ$ %
$str
ˆˆ% 8
,
ˆˆ8 9
cn
ˆˆ: <
)
ˆˆ< =
;
ˆˆ= >
cmd
˜˜ 
.
˜˜ 
CommandType
˜˜ 
=
˜˜  !
CommandType
˜˜" -
.
˜˜- .
StoredProcedure
˜˜. =
;
˜˜= >
cmd
¯¯ 
.
¯¯ 

Parameters
¯¯ 
.
¯¯ 
AddWithValue
¯¯ +
(
¯¯+ ,
$str
¯¯, 4
,
¯¯4 5
busqueda
¯¯6 >
)
¯¯> ?
;
¯¯? @
cn
˘˘ 
.
˘˘ 
Open
˘˘ 
(
˘˘ 
)
˘˘ 
;
˘˘ 
SqlDataReader
˙˙ 
dr
˙˙  
=
˙˙! "
cmd
˙˙# &
.
˙˙& '
ExecuteReader
˙˙' 4
(
˙˙4 5
)
˙˙5 6
;
˙˙6 7
while
˚˚ 
(
˚˚ 
dr
˚˚ 
.
˚˚ 
Read
˚˚ 
(
˚˚ 
)
˚˚  
)
˚˚  !
{
¸¸ 
EntProveedor
˝˝  
pro
˝˝! $
=
˝˝% &
new
˝˝' *
EntProveedor
˝˝+ 7
{
˛˛ 
IdProveedor
ˇˇ #
=
ˇˇ$ %
Convert
ˇˇ& -
.
ˇˇ- .
ToInt32
ˇˇ. 5
(
ˇˇ5 6
dr
ˇˇ6 8
[
ˇˇ8 9
$str
ˇˇ9 F
]
ˇˇF G
)
ˇˇG H
,
ˇˇH I
RazonSocial
ÄÄ #
=
ÄÄ$ %
dr
ÄÄ& (
[
ÄÄ( )
$str
ÄÄ) 6
]
ÄÄ6 7
.
ÄÄ7 8
ToString
ÄÄ8 @
(
ÄÄ@ A
)
ÄÄA B
,
ÄÄB C
Ruc
ÅÅ 
=
ÅÅ 
dr
ÅÅ  
[
ÅÅ  !
$str
ÅÅ! &
]
ÅÅ& '
.
ÅÅ' (
ToString
ÅÅ( 0
(
ÅÅ0 1
)
ÅÅ1 2
,
ÅÅ2 3
Correo
ÇÇ 
=
ÇÇ  
dr
ÇÇ! #
[
ÇÇ# $
$str
ÇÇ$ ,
]
ÇÇ, -
.
ÇÇ- .
ToString
ÇÇ. 6
(
ÇÇ6 7
)
ÇÇ7 8
,
ÇÇ8 9
Telefono
ÉÉ  
=
ÉÉ! "
dr
ÉÉ# %
[
ÉÉ% &
$str
ÉÉ& 0
]
ÉÉ0 1
.
ÉÉ1 2
ToString
ÉÉ2 :
(
ÉÉ: ;
)
ÉÉ; <
,
ÉÉ< =
Descripcion
ÑÑ #
=
ÑÑ$ %
dr
ÑÑ& (
[
ÑÑ( )
$str
ÑÑ) 6
]
ÑÑ6 7
.
ÑÑ7 8
ToString
ÑÑ8 @
(
ÑÑ@ A
)
ÑÑA B
,
ÑÑB C
EstProveedor
ÖÖ $
=
ÖÖ% &
Convert
ÖÖ' .
.
ÖÖ. /
	ToBoolean
ÖÖ/ 8
(
ÖÖ8 9
dr
ÖÖ9 ;
[
ÖÖ; <
$str
ÖÖ< J
]
ÖÖJ K
)
ÖÖK L
,
ÖÖL M
Ubigeo
ÜÜ 
=
ÜÜ 
new
ÜÜ "
	EntUbigeo
ÜÜ# ,
{
ÜÜ- .
Departamento
áá (
=
áá) *
dr
áá+ -
[
áá- .
$str
áá. <
]
áá< =
.
áá= >
ToString
áá> F
(
ááF G
)
ááG H
,
ááH I
	Provincia
àà %
=
àà& '
dr
àà( *
[
àà* +
$str
àà+ 6
]
àà6 7
.
àà7 8
ToString
àà8 @
(
àà@ A
)
ààA B
,
ààB C
Distrito
ââ $
=
ââ% &
dr
ââ' )
[
ââ) *
$str
ââ* 4
]
ââ4 5
.
ââ5 6
ToString
ââ6 >
(
ââ> ?
)
ââ? @
}
ää 
}
åå 
;
åå 
list
çç 
.
çç 
Add
çç 
(
çç 
pro
çç  
)
çç  !
;
çç! "
}
éé 
}
èè 
catch
êê 
(
êê 
	Exception
êê 
e
êê 
)
êê 
{
ëë 

MessageBox
ìì 
.
ìì 
Show
ìì 
(
ìì  
e
ìì  !
.
ìì! "
Message
ìì" )
)
ìì) *
;
ìì* +
}
îî 
finally
ïï 
{
ññ 
cmd
óó 
.
óó 

Connection
óó 
.
óó 
Close
óó $
(
óó$ %
)
óó% &
;
óó& '
}
òò 
return
ôô 
list
ôô 
;
ôô 
}
öö 	
public
õõ 
EntProveedor
õõ 
BuscarIdProveedor
õõ -
(
õõ- .
int
õõ. 1
idProveedor
õõ2 =
)
õõ= >
{
úú 	

SqlCommand
ùù 
cmd
ùù 
=
ùù 
null
ùù !
;
ùù! "
EntProveedor
ûû 
pro
ûû 
=
ûû 
new
ûû "
EntProveedor
ûû# /
(
ûû/ 0
)
ûû0 1
;
ûû1 2
try
üü 
{
†† 
SqlConnection
°° 
cn
°°  
=
°°! "
Conexion
°°# +
.
°°+ ,
	Instancia
°°, 5
.
°°5 6
Conectar
°°6 >
(
°°> ?
)
°°? @
;
°°@ A
cmd
¢¢ 
=
¢¢ 
new
¢¢ 

SqlCommand
¢¢ $
(
¢¢$ %
$str
¢¢% :
,
¢¢: ;
cn
¢¢< >
)
¢¢> ?
;
¢¢? @
cmd
££ 
.
££ 
CommandType
££ 
=
££  !
CommandType
££" -
.
££- .
StoredProcedure
££. =
;
££= >
cmd
§§ 
.
§§ 

Parameters
§§ 
.
§§ 
AddWithValue
§§ +
(
§§+ ,
$str
§§, :
,
§§: ;
idProveedor
§§< G
)
§§G H
;
§§H I
cn
•• 
.
•• 
Open
•• 
(
•• 
)
•• 
;
•• 
SqlDataReader
¶¶ 
dr
¶¶  
=
¶¶! "
cmd
¶¶# &
.
¶¶& '
ExecuteReader
¶¶' 4
(
¶¶4 5
)
¶¶5 6
;
¶¶6 7
while
ßß 
(
ßß 
dr
ßß 
.
ßß 
Read
ßß 
(
ßß 
)
ßß  
)
ßß  !
{
®® 
pro
©© 
.
©© 
IdProveedor
©© #
=
©©$ %
Convert
©©& -
.
©©- .
ToInt32
©©. 5
(
©©5 6
dr
©©6 8
[
©©8 9
$str
©©9 F
]
©©F G
)
©©G H
;
©©H I
pro
™™ 
.
™™ 
RazonSocial
™™ #
=
™™$ %
dr
™™& (
[
™™( )
$str
™™) 6
]
™™6 7
.
™™7 8
ToString
™™8 @
(
™™@ A
)
™™A B
;
™™B C
pro
´´ 
.
´´ 
Ruc
´´ 
=
´´ 
dr
´´  
[
´´  !
$str
´´! &
]
´´& '
.
´´' (
ToString
´´( 0
(
´´0 1
)
´´1 2
;
´´2 3
pro
¨¨ 
.
¨¨ 
Correo
¨¨ 
=
¨¨  
dr
¨¨! #
[
¨¨# $
$str
¨¨$ ,
]
¨¨, -
.
¨¨- .
ToString
¨¨. 6
(
¨¨6 7
)
¨¨7 8
;
¨¨8 9
pro
≠≠ 
.
≠≠ 
Telefono
≠≠  
=
≠≠! "
dr
≠≠# %
[
≠≠% &
$str
≠≠& 0
]
≠≠0 1
.
≠≠1 2
ToString
≠≠2 :
(
≠≠: ;
)
≠≠; <
;
≠≠< =
pro
ÆÆ 
.
ÆÆ 
Descripcion
ÆÆ #
=
ÆÆ$ %
dr
ÆÆ& (
[
ÆÆ( )
$str
ÆÆ) 6
]
ÆÆ6 7
.
ÆÆ7 8
ToString
ÆÆ8 @
(
ÆÆ@ A
)
ÆÆA B
;
ÆÆB C
pro
ØØ 
.
ØØ 
EstProveedor
ØØ $
=
ØØ% &
Convert
ØØ' .
.
ØØ. /
	ToBoolean
ØØ/ 8
(
ØØ8 9
dr
ØØ9 ;
[
ØØ; <
$str
ØØ< J
]
ØØJ K
)
ØØK L
;
ØØL M
	EntUbigeo
∞∞ 
ubi
∞∞ !
=
∞∞" #
new
∞∞$ '
	EntUbigeo
∞∞( 1
(
∞∞1 2
)
∞∞2 3
;
∞∞3 4
ubi
±± 
.
±± 
Departamento
±± $
=
±±% &
dr
±±' )
[
±±) *
$str
±±* 8
]
±±8 9
.
±±9 :
ToString
±±: B
(
±±B C
)
±±C D
;
±±D E
ubi
≤≤ 
.
≤≤ 
	Provincia
≤≤ !
=
≤≤" #
dr
≤≤$ &
[
≤≤& '
$str
≤≤' 2
]
≤≤2 3
.
≤≤3 4
ToString
≤≤4 <
(
≤≤< =
)
≤≤= >
;
≤≤> ?
ubi
≥≥ 
.
≥≥ 
Distrito
≥≥  
=
≥≥! "
dr
≥≥# %
[
≥≥% &
$str
≥≥& 0
]
≥≥0 1
.
≥≥1 2
ToString
≥≥2 :
(
≥≥: ;
)
≥≥; <
;
≥≥< =
pro
¥¥ 
.
¥¥ 
Ubigeo
¥¥ 
=
¥¥  
ubi
¥¥! $
;
¥¥$ %
}
µµ 
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
e
∑∑ 
)
∑∑ 
{
∏∏ 
throw
∏∏ 
e
∏∏ 
;
∏∏ 
}
∏∏ 
finally
ππ 
{
ππ 
cmd
ππ 
.
ππ 

Connection
ππ $
.
ππ$ %
Close
ππ% *
(
ππ* +
)
ππ+ ,
;
ππ, -
}
ππ. /
return
∫∫ 
pro
∫∫ 
;
∫∫ 
}
ªª 	
}
ææ 
}øø ±Ÿ
eC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProveedorProducto.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class  
DatProveedorProducto %
:& '!
IDatProveedorProducto( =
{ 
private 
static 
readonly  
DatProveedorProducto  4
	_instance5 >
=? @
newA D 
DatProveedorProductoE Y
(Y Z
)Z [
;[ \
public 
static  
DatProveedorProducto *
	Instancia+ 4
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
bool "
CrearProveedorProducto *
(* + 
EntProveedorProducto+ ?
prod@ D
)D E
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
crear 
= 
false 
; 
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% ?
,? @
cnA C
)C D
;D E
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
prod< @
.@ A
	ProveedorA J
.J K
IdProveedorK V
)V W
;W X
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
prod; ?
.? @
Producto@ H
.H I

IdProductoI S
)S T
;T U
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , ;
,  ; <
prod  = A
.  A B
PrecioCompra  B N
)  N O
;  O P
cn!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
int"" 
i"" 
="" 
cmd"" 
."" 
ExecuteNonQuery"" +
(""+ ,
)"", -
;""- .
if## 
(## 
i## 
!=## 
$num## 
)## 
crear$$ 
=$$ 
true$$  
;$$  !
}&& 
catch'' 
('' 
	Exception'' 
e'' 
)'' 
{(( 

MessageBox)) 
.)) 
Show)) 
())  
e))  !
.))! "
Message))" )
,))) *
$str))+ I
,))I J
MessageBoxButtons))K \
.))\ ]
OK))] _
,))_ `
MessageBoxIcon))a o
.))o p
Error))p u
)))u v
;))v w
}** 
finally++ 
{,, 
cmd-- 
.-- 

Connection-- 
.-- 
Close-- $
(--$ %
)--% &
;--& '
}.. 
return// 
crear// 
;// 
}00 	
public22 
List22 
<22  
EntProveedorProducto22 (
>22( )%
ListarProductoParaComprar22* C
(22C D
)22D E
{33 	

SqlCommand44 
cmd44 
=44 
null44 !
;44! "
List55 
<55  
EntProveedorProducto55 %
>55% &
lista55' ,
=55- .
new55/ 2
List553 7
<557 8 
EntProveedorProducto558 L
>55L M
(55M N
)55N O
;55O P
try66 
{77 
SqlConnection88 
cn88  
=88! "
Conexion88# +
.88+ ,
	Instancia88, 5
.885 6
Conectar886 >
(88> ?
)88? @
;88@ A
cmd99 
=99 
new99 

SqlCommand99 $
(99$ %
$str99% B
,99B C
cn99D F
)99F G
{:: 
CommandType;; 
=;;  !
CommandType;;" -
.;;- .
StoredProcedure;;. =
}<< 
;<< 
cn== 
.== 
Open== 
(== 
)== 
;== 
SqlDataReader>> 
dr>>  
=>>! "
cmd>># &
.>>& '
ExecuteReader>>' 4
(>>4 5
)>>5 6
;>>6 7
while?? 
(?? 
dr?? 
.?? 
Read?? 
(?? 
)??  
)??  !
{@@  
EntProveedorProductoAA (
ProdAA) -
=AA. /
newAA0 3 
EntProveedorProductoAA4 H
{BB 
ProductoDD  
=DD! "
newDD# &
EntProductoDD' 2
{EE 

IdProductoFF &
=FF' (
ConvertFF) 0
.FF0 1
ToInt32FF1 8
(FF8 9
drFF9 ;
[FF; <
$strFF< H
]FFH I
)FFI J
,FFJ K
NombreGG "
=GG# $
drGG% '
[GG' (
$strGG( 0
]GG0 1
.GG1 2
ToStringGG2 :
(GG: ;
)GG; <
,GG< =
LongitudHH $
=HH% &
ConvertHH' .
.HH. /
ToDoubleHH/ 7
(HH7 8
drHH8 :
[HH: ;
$strHH; E
]HHE F
)HHF G
,HHG H
DiametroII $
=II% &
ConvertII' .
.II. /
ToDoubleII/ 7
(II7 8
drII8 :
[II: ;
$strII; E
]IIE F
)IIF G
,IIG H
StockJJ !
=JJ" #
ConvertJJ$ +
.JJ+ ,
ToInt32JJ, 3
(JJ3 4
drJJ4 6
[JJ6 7
$strJJ7 >
]JJ> ?
)JJ? @
,JJ@ A
PrecioVentaKK '
=KK( )
ConvertKK* 1
.KK1 2
ToDoubleKK2 :
(KK: ;
drKK; =
[KK= >
$strKK> K
]KKK L
)KKL M
,KKM N
ActivoLL "
=LL# $
ConvertLL% ,
.LL, -
	ToBooleanLL- 6
(LL6 7
drLL7 9
[LL9 :
$strLL: B
]LLB C
)LLC D
,LLD E
TipoNN  
=NN! "
newNN# &
EntTipoProductoNN' 6
{OO 
NombrePP  &
=PP' (
drPP) +
[PP+ ,
$strPP, 2
]PP2 3
.PP3 4
ToStringPP4 <
(PP< =
)PP= >
}RR 
}SS 
,SS 
	ProveedorTT !
=TT" #
newTT$ '
EntProveedorTT( 4
{UU 
IdProveedorVV '
=VV( )
ConvertVV* 1
.VV1 2
ToInt32VV2 9
(VV9 :
drVV: <
[VV< =
$strVV= J
]VVJ K
)VVK L
,VVL M
RazonSocialWW '
=WW( )
drWW* ,
[WW, -
$strWW- :
]WW: ;
.WW; <
ToStringWW< D
(WWD E
)WWE F
}XX 
,XX 
PrecioCompraYY $
=YY% &
ConvertYY' .
.YY. /
ToDoubleYY/ 7
(YY7 8
drYY8 :
[YY: ;
$strYY; I
]YYI J
)YYJ K
}ZZ 
;ZZ 
lista[[ 
.[[ 
Add[[ 
([[ 
Prod[[ "
)[[" #
;[[# $
}\\ 
;\\ 
}^^ 
catch__ 
(__ 
	Exception__ 
e__ 
)__ 
{`` 

MessageBoxaa 
.aa 
Showaa 
(aa  
eaa  !
.aa! "
Messageaa" )
,aa) *
$straa+ J
,aaJ K
MessageBoxButtonsaaL ]
.aa] ^
OKaa^ `
,aa` a
MessageBoxIconaab p
.aap q
Erroraaq v
)aav w
;aaw x
}bb 
finallycc 
{dd 
cmdee 
.ee 

Connectionee 
.ee 
Closeee $
(ee$ %
)ee% &
;ee& '
}ff 
returngg 
listagg 
;gg 
}hh 	
publickk 
Listkk 
<kk  
EntProveedorProductokk (
>kk( )$
MostarDetalleProveedorIdkk* B
(kkB C
intkkC F
idProveedorkkG R
)kkR S
{ll 	

SqlCommandmm 
cmdmm 
=mm 
nullmm !
;mm! "
Listnn 
<nn  
EntProveedorProductonn %
>nn% &
listnn' +
=nn, -
newnn. 1
Listnn2 6
<nn6 7 
EntProveedorProductonn7 K
>nnK L
(nnL M
)nnM N
;nnN O
tryoo 
{pp 
SqlConnectionqq 
cnqq  
=qq! "
Conexionqq# +
.qq+ ,
	Instanciaqq, 5
.qq5 6
Conectarqq6 >
(qq> ?
)qq? @
;qq@ A
cmdrr 
=rr 
newrr 

SqlCommandrr $
(rr$ %
$strrr% B
,rrB C
cnrrD F
)rrF G
;rrG H
cmdss 
.ss 
CommandTypess 
=ss  !
CommandTypess" -
.ss- .
StoredProceduress. =
;ss= >
cmdtt 
.tt 

Parameterstt 
.tt 
AddWithValuett +
(tt+ ,
$strtt, :
,tt: ;
idProveedortt< G
)ttG H
;ttH I
cnuu 
.uu 
Openuu 
(uu 
)uu 
;uu 
SqlDataReadervv 
drvv  
=vv! "
cmdvv# &
.vv& '
ExecuteReadervv' 4
(vv4 5
)vv5 6
;vv6 7
whileww 
(ww 
drww 
.ww 
Readww 
(ww 
)ww  
)ww  !
{xx  
EntProveedorProductoyy (
detyy) ,
=yy- .
newyy/ 2 
EntProveedorProductoyy3 G
{zz 
	Proveedor{{ !
={{" #
new{{$ '
EntProveedor{{( 4
{|| 
IdProveedor}} '
=}}( )
Convert}}* 1
.}}1 2
ToInt32}}2 9
(}}9 :
dr}}: <
[}}< =
$str}}= J
]}}J K
)}}K L
,}}L M
RazonSocial~~ '
=~~( )
dr~~* ,
[~~, -
$str~~- :
]~~: ;
.~~; <
ToString~~< D
(~~D E
)~~E F
,~~F G
Descripcion '
=( )
dr* ,
[, -
$str- :
]: ;
.; <
ToString< D
(D E
)E F
}
ÄÄ 
,
ÄÄ 
Producto
ÅÅ  
=
ÅÅ! "
new
ÅÅ# &
EntProducto
ÅÅ' 2
{
ÇÇ 

IdProducto
ÉÉ &
=
ÉÉ' (
Convert
ÉÉ) 0
.
ÉÉ0 1
ToInt32
ÉÉ1 8
(
ÉÉ8 9
dr
ÉÉ9 ;
[
ÉÉ; <
$str
ÉÉ< H
]
ÉÉH I
)
ÉÉI J
,
ÉÉJ K
Nombre
ÑÑ "
=
ÑÑ# $
dr
ÑÑ% '
[
ÑÑ' (
$str
ÑÑ( 0
]
ÑÑ0 1
.
ÑÑ1 2
ToString
ÑÑ2 :
(
ÑÑ: ;
)
ÑÑ; <
,
ÑÑ< =
Longitud
ÖÖ $
=
ÖÖ% &
Convert
ÖÖ' .
.
ÖÖ. /
ToDouble
ÖÖ/ 7
(
ÖÖ7 8
dr
ÖÖ8 :
[
ÖÖ: ;
$str
ÖÖ; E
]
ÖÖE F
)
ÖÖF G
,
ÖÖG H
Stock
ÜÜ !
=
ÜÜ" #
Convert
ÜÜ$ +
.
ÜÜ+ ,
ToInt32
ÜÜ, 3
(
ÜÜ3 4
dr
ÜÜ4 6
[
ÜÜ6 7
$str
ÜÜ7 >
]
ÜÜ> ?
)
ÜÜ? @
}
áá 
,
áá 
PrecioCompra
ââ $
=
ââ% &
Convert
ââ' .
.
ââ. /
ToDouble
ââ/ 7
(
ââ7 8
dr
ââ8 :
[
ââ: ;
$str
ââ; I
]
ââI J
)
ââJ K
,
ââK L
}
ää 
;
ää 
list
åå 
.
åå 
Add
åå 
(
åå 
det
åå  
)
åå  !
;
åå! "
}
çç 
}
éé 
catch
èè 
(
èè 
	Exception
èè 
e
èè 
)
èè 
{
êê 
throw
êê 
e
êê 
;
êê 
}
êê 
finally
ëë 
{
ëë 
cmd
ëë 
.
ëë 

Connection
ëë $
.
ëë$ %
Close
ëë% *
(
ëë* +
)
ëë+ ,
;
ëë, -
}
ëë. /
return
íí 
list
íí 
;
íí 
}
ìì 	
public
ïï 
bool
ïï &
EliminarDetalleProveedor
ïï ,
(
ïï, -
int
ïï- 0
prov
ïï1 5
,
ïï5 6
int
ïï7 :
prod
ïï; ?
)
ïï? @
{
ññ 	

SqlCommand
óó 
cmd
óó 
=
óó 
null
óó !
;
óó! "
bool
òò 
	eliminado
òò 
=
òò 
false
òò "
;
òò" #
try
ôô 
{
öö 
SqlConnection
õõ 
cn
õõ  
=
õõ! "
Conexion
õõ# +
.
õõ+ ,
	Instancia
õõ, 5
.
õõ5 6
Conectar
õõ6 >
(
õõ> ?
)
õõ? @
;
õõ@ A
cmd
úú 
=
úú 
new
úú 

SqlCommand
úú $
(
úú$ %
$str
úú% A
,
úúA B
cn
úúC E
)
úúE F
;
úúF G
cmd
ùù 
.
ùù 
CommandType
ùù 
=
ùù  !
CommandType
ùù" -
.
ùù- .
StoredProcedure
ùù. =
;
ùù= >
cmd
ûû 
.
ûû 

Parameters
ûû 
.
ûû 
AddWithValue
ûû +
(
ûû+ ,
$str
ûû, :
,
ûû: ;
prov
ûû< @
)
ûû@ A
;
ûûA B
cmd
üü 
.
üü 

Parameters
üü 
.
üü 
AddWithValue
üü +
(
üü+ ,
$str
üü, 9
,
üü9 :
prod
üü; ?
)
üü? @
;
üü@ A
cn
†† 
.
†† 
Open
†† 
(
†† 
)
†† 
;
†† 
int
°° 
i
°° 
=
°° 
cmd
°° 
.
°° 
ExecuteNonQuery
°° +
(
°°+ ,
)
°°, -
;
°°- .
if
¢¢ 
(
¢¢ 
i
¢¢ 
>
¢¢ 
$num
¢¢ 
)
¢¢ 
{
££ 
	eliminado
§§ 
=
§§ 
true
§§  $
;
§§$ %
}
•• 
}
¶¶ 
catch
ßß 
(
ßß 
	Exception
ßß 
e
ßß 
)
ßß 
{
®® 

MessageBox
™™ 
.
™™ 
Show
™™ 
(
™™  
e
™™  !
.
™™! "
Message
™™" )
)
™™) *
;
™™* +
}
´´ 
finally
¨¨ 
{
≠≠ 
cmd
ÆÆ 
.
ÆÆ 

Connection
ÆÆ 
.
ÆÆ 
Close
ÆÆ $
(
ÆÆ$ %
)
ÆÆ% &
;
ÆÆ& '
}
ØØ 
return
∞∞ 
	eliminado
∞∞ 
;
∞∞ 
}
≤≤ 	
public
¥¥ 
List
¥¥ 
<
¥¥ "
EntProveedorProducto
¥¥ (
>
¥¥( )'
BuscarProductoParaComprar
¥¥* C
(
¥¥C D
string
¥¥D J
busqueda
¥¥K S
)
¥¥S T
{
µµ 	
List
∂∂ 
<
∂∂ "
EntProveedorProducto
∂∂ %
>
∂∂% &
lista
∂∂' ,
=
∂∂- .
new
∂∂/ 2
List
∂∂3 7
<
∂∂7 8"
EntProveedorProducto
∂∂8 L
>
∂∂L M
(
∂∂M N
)
∂∂N O
;
∂∂O P

SqlCommand
∑∑ 
cmd
∑∑ 
=
∑∑ 
null
∑∑ !
;
∑∑! "
try
∏∏ 
{
ππ 
SqlConnection
∫∫ 
cn
∫∫  
=
∫∫! "
Conexion
∫∫# +
.
∫∫+ ,
	Instancia
∫∫, 5
.
∫∫5 6
Conectar
∫∫6 >
(
∫∫> ?
)
∫∫? @
;
∫∫@ A
cmd
ªª 
=
ªª 
new
ªª 

SqlCommand
ªª $
(
ªª$ %
$str
ªª% B
,
ªªB C
cn
ªªD F
)
ªªF G
;
ªªG H
cmd
ºº 
.
ºº 
CommandType
ºº 
=
ºº  !
CommandType
ºº" -
.
ºº- .
StoredProcedure
ºº. =
;
ºº= >
cmd
ΩΩ 
.
ΩΩ 

Parameters
ΩΩ 
.
ΩΩ 
AddWithValue
ΩΩ +
(
ΩΩ+ ,
$str
ΩΩ, 4
,
ΩΩ4 5
busqueda
ΩΩ6 >
)
ΩΩ> ?
;
ΩΩ? @
cn
ææ 
.
ææ 
Open
ææ 
(
ææ 
)
ææ 
;
ææ 
SqlDataReader
øø 
dr
øø  
=
øø! "
cmd
øø# &
.
øø& '
ExecuteReader
øø' 4
(
øø4 5
)
øø5 6
;
øø6 7
while
¿¿ 
(
¿¿ 
dr
¿¿ 
.
¿¿ 
Read
¿¿ 
(
¿¿ 
)
¿¿  
)
¿¿  !
{
¡¡ "
EntProveedorProducto
¬¬ (
Prod
¬¬) -
=
¬¬. /
new
¬¬0 3"
EntProveedorProducto
¬¬4 H
{
√√ 
Producto
ƒƒ  
=
ƒƒ! "
new
ƒƒ# &
EntProducto
ƒƒ' 2
{
≈≈ 

IdProducto
∆∆ &
=
∆∆' (
Convert
∆∆) 0
.
∆∆0 1
ToInt32
∆∆1 8
(
∆∆8 9
dr
∆∆9 ;
[
∆∆; <
$str
∆∆< H
]
∆∆H I
)
∆∆I J
,
∆∆J K
Nombre
«« "
=
««# $
dr
««% '
[
««' (
$str
««( 0
]
««0 1
.
««1 2
ToString
««2 :
(
««: ;
)
««; <
,
««< =
Longitud
»» $
=
»»% &
Convert
»»' .
.
»». /
ToDouble
»»/ 7
(
»»7 8
dr
»»8 :
[
»»: ;
$str
»»; E
]
»»E F
)
»»F G
,
»»G H
Diametro
…… $
=
……% &
Convert
……' .
.
……. /
ToDouble
……/ 7
(
……7 8
dr
……8 :
[
……: ;
$str
……; E
]
……E F
)
……F G
,
……G H
Stock
   !
=
  " #
Convert
  $ +
.
  + ,
ToInt32
  , 3
(
  3 4
dr
  4 6
[
  6 7
$str
  7 >
]
  > ?
)
  ? @
,
  @ A
PrecioVenta
ÀÀ '
=
ÀÀ( )
Convert
ÀÀ* 1
.
ÀÀ1 2
ToDouble
ÀÀ2 :
(
ÀÀ: ;
dr
ÀÀ; =
[
ÀÀ= >
$str
ÀÀ> K
]
ÀÀK L
)
ÀÀL M
,
ÀÀM N
Activo
ÃÃ "
=
ÃÃ# $
Convert
ÃÃ% ,
.
ÃÃ, -
	ToBoolean
ÃÃ- 6
(
ÃÃ6 7
dr
ÃÃ7 9
[
ÃÃ9 :
$str
ÃÃ: B
]
ÃÃB C
)
ÃÃC D
,
ÃÃD E
Tipo
ÕÕ  
=
ÕÕ! "
new
ÕÕ# &
EntTipoProducto
ÕÕ' 6
{
ŒŒ 
Nombre
œœ  &
=
œœ' (
dr
œœ) +
[
œœ+ ,
$str
œœ, 2
]
œœ2 3
.
œœ3 4
ToString
œœ4 <
(
œœ< =
)
œœ= >
}
–– 
,
–– 
}
—— 
,
—— 
}
““ 
;
““ 
if
‘‘ 
(
‘‘ 
dr
‘‘ 
[
‘‘ 
$str
‘‘ (
]
‘‘( )
!=
‘‘* ,
DBNull
‘‘- 3
.
‘‘3 4
Value
‘‘4 9
)
‘‘9 :
{
’’ 
Prod
÷÷ 
.
÷÷ 
	Proveedor
÷÷ &
=
÷÷' (
new
÷÷) ,
EntProveedor
÷÷- 9
{
◊◊ 
IdProveedor
ÿÿ '
=
ÿÿ( )
Convert
ÿÿ* 1
.
ÿÿ1 2
ToInt32
ÿÿ2 9
(
ÿÿ9 :
dr
ÿÿ: <
[
ÿÿ< =
$str
ÿÿ= J
]
ÿÿJ K
)
ÿÿK L
,
ÿÿL M
RazonSocial
ŸŸ '
=
ŸŸ( )
dr
ŸŸ* ,
[
ŸŸ, -
$str
ŸŸ- :
]
ŸŸ: ;
.
ŸŸ; <
ToString
ŸŸ< D
(
ŸŸD E
)
ŸŸE F
}
⁄⁄ 
;
⁄⁄ 
}
€€ 
if
‹‹ 
(
‹‹ 
dr
‹‹ 
[
‹‹ 
$str
‹‹ )
]
‹‹) *
!=
‹‹+ -
DBNull
‹‹. 4
.
‹‹4 5
Value
‹‹5 :
)
‹‹: ;
Prod
›› 
.
›› 
PrecioCompra
›› )
=
››* +
Convert
››, 3
.
››3 4
ToDouble
››4 <
(
››< =
dr
››= ?
[
››? @
$str
››@ N
]
››N O
)
››O P
;
››P Q
lista
ﬁﬁ 
.
ﬁﬁ 
Add
ﬁﬁ 
(
ﬁﬁ 
Prod
ﬁﬁ "
)
ﬁﬁ" #
;
ﬁﬁ# $
}
ﬂﬂ 
}
‡‡ 
catch
·· 
(
·· 
	Exception
·· 
e
·· 
)
·· 
{
‚‚ 

MessageBox
‰‰ 
.
‰‰ 
Show
‰‰ 
(
‰‰  
e
‰‰  !
.
‰‰! "
Message
‰‰" )
)
‰‰) *
;
‰‰* +
}
ÂÂ 
finally
ÊÊ 
{
ÁÁ 
cmd
ËË 
.
ËË 

Connection
ËË 
.
ËË 
Close
ËË $
(
ËË$ %
)
ËË% &
;
ËË& '
}
ÈÈ 
return
ÍÍ 
lista
ÍÍ 
;
ÍÍ 
}
ÎÎ 	
public
ÌÌ "
EntProveedorProducto
ÌÌ #&
BuscarProvedorProductoId
ÌÌ$ <
(
ÌÌ< =
int
ÌÌ= @
idprod
ÌÌA G
,
ÌÌG H
int
ÌÌI L
idprov
ÌÌM S
)
ÌÌS T
{
ÓÓ 	

SqlCommand
ÔÔ 
cmd
ÔÔ 
=
ÔÔ 
null
ÔÔ !
;
ÔÔ! ""
EntProveedorProducto
  
Prod
! %
=
& '
new
( +"
EntProveedorProducto
, @
(
@ A
)
A B
;
B C
try
ÒÒ 
{
ÚÚ 
SqlConnection
ÛÛ 
cn
ÛÛ  
=
ÛÛ! "
Conexion
ÛÛ# +
.
ÛÛ+ ,
	Instancia
ÛÛ, 5
.
ÛÛ5 6
Conectar
ÛÛ6 >
(
ÛÛ> ?
)
ÛÛ? @
;
ÛÛ@ A
cmd
ÙÙ 
=
ÙÙ 
new
ÙÙ 

SqlCommand
ÙÙ $
(
ÙÙ$ %
$str
ÙÙ% A
,
ÙÙA B
cn
ÙÙC E
)
ÙÙE F
{
ıı 
CommandType
ˆˆ 
=
ˆˆ  !
CommandType
ˆˆ" -
.
ˆˆ- .
StoredProcedure
ˆˆ. =
}
˜˜ 
;
˜˜ 
cmd
¯¯ 
.
¯¯ 

Parameters
¯¯ 
.
¯¯ 
AddWithValue
¯¯ +
(
¯¯+ ,
$str
¯¯, ?
,
¯¯? @
idprod
¯¯A G
)
¯¯G H
;
¯¯H I
cmd
˘˘ 
.
˘˘ 

Parameters
˘˘ 
.
˘˘ 
AddWithValue
˘˘ +
(
˘˘+ ,
$str
˘˘, @
,
˘˘@ A
idprov
˘˘B H
)
˘˘H I
;
˘˘I J
cn
˙˙ 
.
˙˙ 
Open
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
SqlDataReader
˚˚ 
dr
˚˚  
=
˚˚! "
cmd
˚˚# &
.
˚˚& '
ExecuteReader
˚˚' 4
(
˚˚4 5
)
˚˚5 6
;
˚˚6 7
while
¸¸ 
(
¸¸ 
dr
¸¸ 
.
¸¸ 
Read
¸¸ 
(
¸¸ 
)
¸¸  
)
¸¸  !
{
˝˝ 
Prod
˛˛ 
.
˛˛ 
Producto
˛˛ !
=
˛˛" #
new
˛˛$ '
EntProducto
˛˛( 3
{
ˇˇ 

IdProducto
ÄÄ "
=
ÄÄ# $
Convert
ÄÄ% ,
.
ÄÄ, -
ToInt32
ÄÄ- 4
(
ÄÄ4 5
dr
ÄÄ5 7
[
ÄÄ7 8
$str
ÄÄ8 D
]
ÄÄD E
)
ÄÄE F
,
ÄÄF G
Nombre
ÅÅ 
=
ÅÅ  
dr
ÅÅ! #
[
ÅÅ# $
$str
ÅÅ$ ,
]
ÅÅ, -
.
ÅÅ- .
ToString
ÅÅ. 6
(
ÅÅ6 7
)
ÅÅ7 8
,
ÅÅ8 9
Longitud
ÇÇ  
=
ÇÇ! "
Convert
ÇÇ# *
.
ÇÇ* +
ToDouble
ÇÇ+ 3
(
ÇÇ3 4
dr
ÇÇ4 6
[
ÇÇ6 7
$str
ÇÇ7 A
]
ÇÇA B
)
ÇÇB C
,
ÇÇC D
Diametro
ÉÉ  
=
ÉÉ! "
Convert
ÉÉ# *
.
ÉÉ* +
ToDouble
ÉÉ+ 3
(
ÉÉ3 4
dr
ÉÉ4 6
[
ÉÉ6 7
$str
ÉÉ7 A
]
ÉÉA B
)
ÉÉB C
,
ÉÉC D
PrecioVenta
ÑÑ #
=
ÑÑ$ %
Convert
ÑÑ& -
.
ÑÑ- .
ToDouble
ÑÑ. 6
(
ÑÑ6 7
dr
ÑÑ7 9
[
ÑÑ9 :
$str
ÑÑ: G
]
ÑÑG H
)
ÑÑH I
,
ÑÑI J
Activo
ÖÖ 
=
ÖÖ  
Convert
ÖÖ! (
.
ÖÖ( )
	ToBoolean
ÖÖ) 2
(
ÖÖ2 3
dr
ÖÖ3 5
[
ÖÖ5 6
$str
ÖÖ6 >
]
ÖÖ> ?
)
ÖÖ? @
,
ÖÖ@ A
Tipo
ÜÜ 
=
ÜÜ 
new
ÜÜ "
EntTipoProducto
ÜÜ# 2
{
áá 
IdTipo_producto
àà +
=
àà, -
Convert
àà. 5
.
àà5 6
ToInt32
àà6 =
(
àà= >
dr
àà> @
[
àà@ A
$str
ààA R
]
ààR S
)
ààS T
,
ààT U
Nombre
ââ "
=
ââ# $
dr
ââ% '
[
ââ' (
$str
ââ( .
]
ââ. /
.
ââ/ 0
ToString
ââ0 8
(
ââ8 9
)
ââ9 :
}
ãã 
}
åå 
;
åå 
if
éé 
(
éé 
dr
éé 
[
éé 
$str
éé (
]
éé( )
!=
éé* ,
DBNull
éé- 3
.
éé3 4
Value
éé4 9
)
éé9 :
{
èè 
Prod
êê 
.
êê 
	Proveedor
êê &
=
êê' (
new
êê) ,
EntProveedor
êê- 9
{
ëë 
IdProveedor
íí '
=
íí( )
Convert
íí* 1
.
íí1 2
ToInt32
íí2 9
(
íí9 :
dr
íí: <
[
íí< =
$str
íí= J
]
ííJ K
)
ííK L
,
ííL M
RazonSocial
ìì '
=
ìì( )
dr
ìì* ,
[
ìì, -
$str
ìì- :
]
ìì: ;
.
ìì; <
ToString
ìì< D
(
ììD E
)
ììE F
}
îî 
;
îî 
}
ïï 
if
ññ 
(
ññ 
dr
ññ 
[
ññ 
$str
ññ )
]
ññ) *
!=
ññ+ -
DBNull
ññ. 4
.
ññ4 5
Value
ññ5 :
)
ññ: ;
Prod
óó 
.
óó 
PrecioCompra
óó )
=
óó* +
Convert
óó, 3
.
óó3 4
ToDouble
óó4 <
(
óó< =
dr
óó= ?
[
óó? @
$str
óó@ N
]
óóN O
)
óóO P
;
óóP Q
}
öö 
}
õõ 
catch
úú 
(
úú 
	Exception
úú 
e
úú 
)
úú 
{
ùù 

MessageBox
üü 
.
üü 
Show
üü 
(
üü  
e
üü  !
.
üü! "
Message
üü" )
)
üü) *
;
üü* +
}
†† 
finally
°° 
{
°° 
cmd
°° 
.
°° 

Connection
°° $
.
°°$ %
Close
°°% *
(
°°* +
)
°°+ ,
;
°°, -
}
°°. /
return
¢¢ 
Prod
¢¢ 
;
¢¢ 
}
££ 	
}
§§ 
}•• ß
XC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\datRoll.cs
	namespace 	
CapaAccesoDatos
 
{		 
public

 

class

 
datRoll

 
{ 
private 
static 
readonly 
datRoll  '

_instancia( 2
=3 4
new5 8
datRoll9 @
(@ A
)A B
;B C
public 
static 
datRoll 
	Instancia '
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
List 
< 
entRoll 
> 

ListarRoll '
(' (
)( )
{ 	

SqlCommand 
cmd 
= 
null !
;! "
List 
< 
entRoll 
> 
lista 
=  !
new" %
List& *
<* +
entRoll+ 2
>2 3
(3 4
)4 5
;5 6
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 2
,2 3
cn4 6
)6 7
;7 8
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cn 
. 
Open 
( 
) 
; 
SqlDataReader 
dr  
=! "
cmd# &
.& '
ExecuteReader' 4
(4 5
)5 6
;6 7
while 
( 
dr 
. 
Read 
( 
)  
)  !
{ 
entRoll 
rol 
=  !
new" %
entRoll& -
{   
IdRoll!! 
=!!  
Convert!!! (
.!!( )
ToInt32!!) 0
(!!0 1
dr!!1 3
[!!3 4
$str!!4 ;
]!!; <
)!!< =
,!!= >
Descripcion"" #
=""$ %
dr""& (
[""( )
$str"") 6
]""6 7
.""7 8
ToString""8 @
(""@ A
)""A B
,""B C
}## 
;## 
lista%% 
.%% 
Add%% 
(%% 
rol%% !
)%%! "
;%%" #
}&& 
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 

MessageBox,, 
.,, 
Show,, 
(,,  
e,,  !
.,,! "
Message,," )
,,,) *
$str,,+ D
,,,D E
MessageBoxButtons,,F W
.,,W X
OK,,X Z
,,,Z [
MessageBoxIcon,,\ j
.,,j k
Error,,k p
),,p q
;,,q r
}-- 
finally.. 
{// 
cmd00 
.00 

Connection00 
.00 
Close00 $
(00$ %
)00% &
;00& '
}11 
return22 
lista22 
;22 
}33 	
}44 
}55 ÷k
`C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatTipoProducto.cs
	namespace 	
CapaAccesoDatos
 
{		 
public

 

class

 
DatTipoProducto

  
:

! "
IDatTipoProducto

# 3
{ 
private 
static 
readonly 
DatTipoProducto  /

_instancia0 :
=; <
new= @
DatTipoProductoA P
(P Q
)Q R
;R S
public 
static 
DatTipoProducto %
	Instancia& /
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearTipoProducto %
(% &
EntTipoProducto& 5
tip6 9
)9 :
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% :
,: ;
cn< >
)> ?
;? @
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
tip7 :
.: ;
Nombre; A
)A B
;B C
cn 
. 
Open 
( 
) 
; 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if 
( 
i 
!= 
$num 
) 
{ 
creado   
=   
true   !
;  ! "
}!! 
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 

MessageBox%% 
.%% 
Show%% 
(%%  
e%%  !
.%%! "
Message%%" )
,%%) *
$str%%+ F
,%%F G
MessageBoxButtons%%H Y
.%%Y Z
OK%%Z \
,%%\ ]
MessageBoxIcon%%^ l
.%%l m
Error%%m r
)%%r s
;%%s t
}&& 
finally'' 
{(( 
cmd)) 
.)) 

Connection)) 
.)) 
Close)) $
())$ %
)))% &
;))& '
}** 
return++ 
creado++ 
;++ 
}-- 	
public// 
List// 
<// 
EntTipoProducto// #
>//# $"
SelectListTipoProducto//% ;
(//; <
)//< =
{00 	

SqlCommand11 
cmd11 
=11 
null11 !
;11! "
List22 
<22 
EntTipoProducto22  
>22  !
lista22" '
=22( )
new22* -
List22. 2
<222 3
EntTipoProducto223 B
>22B C
(22C D
)22D E
;22E F
try33 
{44 
SqlConnection55 
cn55  
=55! "
Conexion55# +
.55+ ,
	Instancia55, 5
.555 6
Conectar556 >
(55> ?
)55? @
;55@ A
cmd66 
=66 
new66 

SqlCommand66 $
(66$ %
$str66% ?
,66? @
cn66A C
)66C D
;66D E
cmd77 
.77 
CommandType77 
=77  !
CommandType77" -
.77- .
StoredProcedure77. =
;77= >
cn88 
.88 
Open88 
(88 
)88 
;88 
SqlDataReader99 
dr99  
=99! "
cmd99# &
.99& '
ExecuteReader99' 4
(994 5
)995 6
;996 7
while:: 
(:: 
dr:: 
.:: 
Read:: 
(:: 
)::  
)::  !
{;; 
EntTipoProducto<< #
tip<<$ '
=<<( )
new<<* -
EntTipoProducto<<. =
(<<= >
)<<> ?
;<<? @
tip== 
.== 
IdTipo_producto== '
===( )
Convert==* 1
.==1 2
ToInt32==2 9
(==9 :
dr==: <
[==< =
$str=== N
]==N O
)==O P
;==P Q
tip>> 
.>> 
Nombre>> 
=>>  
dr>>! #
[>># $
$str>>$ ,
]>>, -
.>>- .
ToString>>. 6
(>>6 7
)>>7 8
;>>8 9
lista?? 
.?? 
Add?? 
(?? 
tip?? !
)??! "
;??" #
}@@ 
}BB 
catchCC 
(CC 
	ExceptionCC 
eCC 
)CC 
{DD 

MessageBoxEE 
.EE 
ShowEE 
(EE  
eEE  !
.EE! "
MessageEE" )
,EE) *
$strEE+ F
,EEF G
MessageBoxButtonsEEH Y
.EEY Z
OKEEZ \
,EE\ ]
MessageBoxIconEE^ l
.EEl m
ErrorEEm r
)EEr s
;EEs t
}FF 
finallyGG 
{HH 
cmdII 
.II 

ConnectionII 
.II 
CloseII $
(II$ %
)II% &
;II& '
}JJ 
returnKK 
listaKK 
;KK 
}LL 	
publicNN 
ListNN 
<NN 
EntTipoProductoNN #
>NN# $%
SelectListTipoProductodatNN% >
(NN> ?
intNN? B
idNNC E
)NNE F
{OO 	

SqlCommandPP 
cmdPP 
=PP 
nullPP !
;PP! "
ListQQ 
<QQ 
EntTipoProductoQQ  
>QQ  !
listaQQ" '
=QQ( )
newQQ* -
ListQQ. 2
<QQ2 3
EntTipoProductoQQ3 B
>QQB C
(QQC D
)QQD E
;QQE F
tryRR 
{SS 
SqlConnectionTT 
cnTT  
=TT! "
ConexionTT# +
.TT+ ,
	InstanciaTT, 5
.TT5 6
ConectarTT6 >
(TT> ?
)TT? @
;TT@ A
cmdUU 
=UU 
newUU 

SqlCommandUU $
(UU$ %
$strUU% B
,UUB C
cnUUD F
)UUF G
;UUG H
cmdVV 
.VV 
CommandTypeVV 
=VV  !
CommandTypeVV" -
.VV- .
StoredProcedureVV. =
;VV= >
cmdWW 
.WW 

ParametersWW 
.WW 
AddWithValueWW +
(WW+ ,
$strWW, 1
,WW1 2
idWW3 5
)WW5 6
;WW6 7
cnXX 
.XX 
OpenXX 
(XX 
)XX 
;XX 
SqlDataReaderYY 
drYY  
=YY! "
cmdYY# &
.YY& '
ExecuteReaderYY' 4
(YY4 5
)YY5 6
;YY6 7
whileZZ 
(ZZ 
drZZ 
.ZZ 
ReadZZ 
(ZZ 
)ZZ  
)ZZ  !
{[[ 
EntTipoProducto\\ #
tip\\$ '
=\\( )
new\\* -
EntTipoProducto\\. =
{]] 
IdTipo_producto^^ '
=^^( )
Convert^^* 1
.^^1 2
ToInt32^^2 9
(^^9 :
dr^^: <
[^^< =
$str^^= N
]^^N O
)^^O P
,^^P Q
Nombre__ 
=__  
dr__! #
[__# $
$str__$ ,
]__, -
.__- .
ToString__. 6
(__6 7
)__7 8
}`` 
;`` 
listaaa 
.aa 
Addaa 
(aa 
tipaa !
)aa! "
;aa" #
}bb 
}dd 
catchee 
(ee 
	Exceptionee 
eee 
)ee 
{ff 

MessageBoxgg 
.gg 
Showgg 
(gg  
egg  !
.gg! "
Messagegg" )
,gg) *
$strgg+ F
,ggF G
MessageBoxButtonsggH Y
.ggY Z
OKggZ \
,gg\ ]
MessageBoxIcongg^ l
.ggl m
Errorggm r
)ggr s
;ggs t
}hh 
finallyii 
{jj 
cmdkk 
.kk 

Connectionkk 
.kk 
Closekk $
(kk$ %
)kk% &
;kk& '
}ll 
returnmm 
listamm 
;mm 
}nn 	
publicoo 
booloo "
ActualizarTipoProductooo *
(oo* +
EntTipoProductooo+ :
tipoo; >
)oo> ?
{pp 	

SqlCommandqq 
cmdqq 
=qq 
nullqq !
;qq! "
boolrr 
	actualizarr 
=rr 
falserr "
;rr" #
tryss 
{tt 
SqlConnectionuu 
cnuu  
=uu! "
Conexionuu# +
.uu+ ,
	Instanciauu, 5
.uu5 6
Conectaruu6 >
(uu> ?
)uu? @
;uu@ A
cmdvv 
=vv 
newvv 

SqlCommandvv $
(vv$ %
$strvv% ?
,vv? @
cnvvA C
)vvC D
;vvD E
cmdww 
.ww 
CommandTypeww 
=ww  !
CommandTypeww" -
.ww- .
StoredProcedureww. =
;ww= >
cmdxx 
.xx 

Parametersxx 
.xx 
AddWithValuexx +
(xx+ ,
$strxx, >
,xx> ?
tipxx@ C
.xxC D
IdTipo_productoxxD S
)xxS T
;xxT U
cmdyy 
.yy 

Parametersyy 
.yy 
AddWithValueyy +
(yy+ ,
$stryy, 5
,yy5 6
tipyy7 :
.yy: ;
Nombreyy; A
)yyA B
;yyB C
cnzz 
.zz 
Openzz 
(zz 
)zz 
;zz 
int{{ 
i{{ 
={{ 
cmd{{ 
.{{ 
ExecuteNonQuery{{ +
({{+ ,
){{, -
;{{- .
if|| 
(|| 
i|| 
>|| 
$num|| 
)|| 
{}} 
	actualiza~~ 
=~~ 
true~~  $
;~~$ %
} 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
e
ÅÅ 
)
ÅÅ 
{
ÇÇ 

MessageBox
ÉÉ 
.
ÉÉ 
Show
ÉÉ 
(
ÉÉ  
e
ÉÉ  !
.
ÉÉ! "
Message
ÉÉ" )
)
ÉÉ) *
;
ÉÉ* +
}
ÑÑ 
finally
ÖÖ 
{
ÖÖ 
cmd
ÖÖ 
.
ÖÖ 

Connection
ÖÖ $
.
ÖÖ$ %
Close
ÖÖ% *
(
ÖÖ* +
)
ÖÖ+ ,
;
ÖÖ, -
}
ÖÖ. /
return
ÜÜ 
	actualiza
ÜÜ 
;
ÜÜ 
}
áá 	
public
ää 
bool
ää "
EliminarTipoProducto
ää (
(
ää( )
int
ää) ,
id
ää- /
)
ää/ 0
{
ãã 	

SqlCommand
åå 
cmd
åå 
=
åå 
null
åå !
;
åå! "
bool
çç 
	eliminado
çç 
=
çç 
false
çç "
;
çç" #
try
éé 
{
èè 
SqlConnection
êê 
cn
êê  
=
êê! "
Conexion
êê# +
.
êê+ ,
	Instancia
êê, 5
.
êê5 6
Conectar
êê6 >
(
êê> ?
)
êê? @
;
êê@ A
cmd
ëë 
=
ëë 
new
ëë 

SqlCommand
ëë $
(
ëë$ %
$str
ëë% =
,
ëë= >
cn
ëë? A
)
ëëA B
;
ëëB C
cmd
íí 
.
íí 
CommandType
íí 
=
íí  !
CommandType
íí" -
.
íí- .
StoredProcedure
íí. =
;
íí= >
cmd
ìì 
.
ìì 

Parameters
ìì 
.
ìì 
AddWithValue
ìì +
(
ìì+ ,
$str
ìì, >
,
ìì> ?
id
ìì@ B
)
ììB C
;
ììC D
cn
îî 
.
îî 
Open
îî 
(
îî 
)
îî 
;
îî 
int
ïï 
i
ïï 
=
ïï 
cmd
ïï 
.
ïï 
ExecuteNonQuery
ïï +
(
ïï+ ,
)
ïï, -
;
ïï- .
if
ññ 
(
ññ 
i
ññ 
>
ññ 
$num
ññ 
)
ññ 
{
óó 
	eliminado
òò 
=
òò 
true
òò  $
;
òò$ %
}
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
e
õõ 
)
õõ 
{
úú 

MessageBox
ùù 
.
ùù 
Show
ùù 
(
ùù  
e
ùù  !
.
ùù! "
Message
ùù" )
)
ùù) *
;
ùù* +
}
ûû 
finally
üü 
{
üü 
cmd
üü 
.
üü 

Connection
üü $
.
üü$ %
Close
üü% *
(
üü* +
)
üü+ ,
;
üü, -
}
üü. /
return
†† 
	eliminado
†† 
;
†† 
}
°° 	
}
££ 
}§§ Óí
ZC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatUbigeo.cs
	namespace 	
CapaAccesoDatos
 
{		 
public

 

class

 
	DatUbigeo

 
:

 

IDatUbigeo

 '
{ 
private 
static 
readonly 
	DatUbigeo  )

_instancia* 4
=5 6
new7 :
	DatUbigeo; D
(D E
)E F
;F G
public 
static 
	DatUbigeo 
	Instancia  )
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearUbigeo 
(  
	EntUbigeo  )
ubi* -
)- .
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 4
,4 5
cn6 8
)8 9
;9 :
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
ubi9 <
.< =
IdUbigeo= E
)E F
;F G
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, ;
,; <
ubi= @
.@ A
DepartamentoA M
)M N
;N O
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
ubi: =
.= >
	Provincia> G
)G H
;H I
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
ubi9 <
.< =
Distrito= E
)E F
;F G
cn 
. 
Open 
( 
) 
; 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if   
(   
i   
!=   
$num   
)   
{!! 
creado"" 
="" 
true"" !
;""! "
}## 
}$$ 
catch%% 
(%% 
	Exception%% 
e%% 
)%% 
{&& 

MessageBox'' 
.'' 
Show'' 
(''  
e''  !
.''! "
Message''" )
,'') *
$str''+ E
,''E F
MessageBoxButtons''G X
.''X Y
OK''Y [
,''[ \
MessageBoxIcon''] k
.''k l
Error''l q
)''q r
;''r s
}(( 
finally)) 
{** 
cmd++ 
.++ 

Connection++ 
.++ 
Close++ $
(++$ %
)++% &
;++& '
},, 
return-- 
creado-- 
;-- 
}// 	
public11 
List11 
<11 
	EntUbigeo11 
>11 
ListarUbigeo11 +
(11+ ,
)11, -
{22 	

SqlCommand33 
cmd33 
=33 
null33 !
;33! "
List44 
<44 
	EntUbigeo44 
>44 
lista44 !
=44" #
new44$ '
List44( ,
<44, -
	EntUbigeo44- 6
>446 7
(447 8
)448 9
;449 :
try55 
{66 
SqlConnection77 
cn77  
=77! "
Conexion77# +
.77+ ,
	Instancia77, 5
.775 6
Conectar776 >
(77> ?
)77? @
;77@ A
cmd88 
=88 
new88 

SqlCommand88 $
(88$ %
$str88% 5
,885 6
cn887 9
)889 :
;88: ;
cmd99 
.99 
CommandType99 
=99  !
CommandType99" -
.99- .
StoredProcedure99. =
;99= >
cn:: 
.:: 
Open:: 
(:: 
):: 
;:: 
SqlDataReader;; 
dr;;  
=;;! "
cmd;;# &
.;;& '
ExecuteReader;;' 4
(;;4 5
);;5 6
;;;6 7
while<< 
(<< 
dr<< 
.<< 
Read<< 
(<< 
)<<  
)<<  !
{== 
	EntUbigeo>> 
ubi>> !
=>>" #
new>>$ '
	EntUbigeo>>( 1
(>>1 2
)>>2 3
;>>3 4
ubi?? 
.?? 
IdUbigeo??  
=??! "
dr??# %
[??% &
$str??& 0
]??0 1
.??1 2
ToString??2 :
(??: ;
)??; <
;??< =
ubi@@ 
.@@ 
Departamento@@ $
=@@% &
dr@@' )
[@@) *
$str@@* 8
]@@8 9
.@@9 :
ToString@@: B
(@@B C
)@@C D
;@@D E
ubiAA 
.AA 
	ProvinciaAA !
=AA" #
drAA$ &
[AA& '
$strAA' 2
]AA2 3
.AA3 4
ToStringAA4 <
(AA< =
)AA= >
;AA> ?
ubiBB 
.BB 
DistritoBB  
=BB! "
drBB# %
[BB% &
$strBB& 0
]BB0 1
.BB1 2
ToStringBB2 :
(BB: ;
)BB; <
;BB< =
listaCC 
.CC 
AddCC 
(CC 
ubiCC !
)CC! "
;CC" #
}DD 
}FF 
catchGG 
(GG 
	ExceptionGG 
eGG 
)GG 
{HH 

MessageBoxII 
.II 
ShowII 
(II  
eII  !
.II! "
MessageII" )
,II) *
$strII+ C
,IIC D
MessageBoxButtonsIIE V
.IIV W
OKIIW Y
,IIY Z
MessageBoxIconII[ i
.IIi j
ErrorIIj o
)IIo p
;IIp q
}JJ 
finallyKK 
{LL 
cmdMM 
.MM 

ConnectionMM 
.MM 
CloseMM $
(MM$ %
)MM% &
;MM& '
}NN 
returnOO 
listaOO 
;OO 
}PP 	
publicRR 
ListRR 
<RR 
	EntUbigeoRR 
>RR 
ListarDistritoRR -
(RR- .
)RR. /
{SS 	

SqlCommandTT 
cmdTT 
=TT 
nullTT !
;TT! "
ListUU 
<UU 
	EntUbigeoUU 
>UU 
listaUU !
=UU" #
newUU$ '
ListUU( ,
<UU, -
	EntUbigeoUU- 6
>UU6 7
(UU7 8
)UU8 9
;UU9 :
tryVV 
{WW 
SqlConnectionXX 
cnXX  
=XX! "
ConexionXX# +
.XX+ ,
	InstanciaXX, 5
.XX5 6
ConectarXX6 >
(XX> ?
)XX? @
;XX@ A
cmdYY 
=YY 
newYY 

SqlCommandYY $
(YY$ %
$strYY% 7
,YY7 8
cnYY9 ;
)YY; <
;YY< =
cmdZZ 
.ZZ 
CommandTypeZZ 
=ZZ  !
CommandTypeZZ" -
.ZZ- .
StoredProcedureZZ. =
;ZZ= >
cn[[ 
.[[ 
Open[[ 
([[ 
)[[ 
;[[ 
SqlDataReader\\ 
dr\\  
=\\! "
cmd\\# &
.\\& '
ExecuteReader\\' 4
(\\4 5
)\\5 6
;\\6 7
while]] 
(]] 
dr]] 
.]] 
Read]] 
(]] 
)]]  
)]]  !
{^^ 
	EntUbigeo__ 
ubi__ !
=__" #
new__$ '
	EntUbigeo__( 1
(__1 2
)__2 3
;__3 4
ubi`` 
.`` 
IdUbigeo``  
=``! "
dr``# %
[``% &
$str``& 0
]``0 1
.``1 2
ToString``2 :
(``: ;
)``; <
;``< =
ubiaa 
.aa 
Distritoaa  
=aa! "
draa# %
[aa% &
$straa& 0
]aa0 1
.aa1 2
ToStringaa2 :
(aa: ;
)aa; <
;aa< =
listabb 
.bb 
Addbb 
(bb 
ubibb !
)bb! "
;bb" #
}cc 
}dd 
catchee 
(ee 
	Exceptionee 
eee 
)ee 
{ff 

MessageBoxgg 
.gg 
Showgg 
(gg  
egg  !
.gg! "
Messagegg" )
,gg) *
$strgg+ E
,ggE F
MessageBoxButtonsggG X
.ggX Y
OKggY [
,gg[ \
MessageBoxIcongg] k
.ggk l
Errorggl q
)ggq r
;ggr s
}hh 
finallyii 
{jj 
cmdkk 
.kk 

Connectionkk 
.kk 
Closekk $
(kk$ %
)kk% &
;kk& '
}ll 
returnmm 
listamm 
;mm 
}nn 	
publicqq 
boolqq 
ActualizarUbigeoqq $
(qq$ %
	EntUbigeoqq% .
ubiqq/ 2
)qq2 3
{rr 	

SqlCommandss 
cmdss 
=ss 
nullss !
;ss! "
booltt 
	actualizatt 
=tt 
falsett "
;tt" #
tryuu 
{vv 
SqlConnectionww 
cnww  
=ww! "
Conexionww# +
.ww+ ,
	Instanciaww, 5
.ww5 6
Conectarww6 >
(ww> ?
)ww? @
;ww@ A
cmdxx 
=xx 
newxx 

SqlCommandxx $
(xx$ %
$strxx% 9
,xx9 :
cnxx; =
)xx= >
;xx> ?
cmdyy 
.yy 
CommandTypeyy 
=yy  !
CommandTypeyy" -
.yy- .
StoredProcedureyy. =
;yy= >
cmdzz 
.zz 

Parameterszz 
.zz 
AddWithValuezz +
(zz+ ,
$strzz, 7
,zz7 8
ubizz9 <
.zz< =
IdUbigeozz= E
)zzE F
;zzF G
cmd{{ 
.{{ 

Parameters{{ 
.{{ 
AddWithValue{{ +
({{+ ,
$str{{, ;
,{{; <
ubi{{= @
.{{@ A
Departamento{{A M
){{M N
;{{N O
cmd|| 
.|| 

Parameters|| 
.|| 
AddWithValue|| +
(||+ ,
$str||, 8
,||8 9
ubi||: =
.||= >
	Provincia||> G
)||G H
;||H I
cmd}} 
.}} 

Parameters}} 
.}} 
AddWithValue}} +
(}}+ ,
$str}}, 7
,}}7 8
ubi}}9 <
.}}< =
Distrito}}= E
)}}E F
;}}F G
cn~~ 
.~~ 
Open~~ 
(~~ 
)~~ 
;~~ 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if
ÄÄ 
(
ÄÄ 
i
ÄÄ 
>
ÄÄ 
$num
ÄÄ 
)
ÄÄ 
{
ÅÅ 
	actualiza
ÇÇ 
=
ÇÇ 
true
ÇÇ  $
;
ÇÇ$ %
}
ÉÉ 
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
e
ÖÖ 
)
ÖÖ 
{
ÜÜ 

MessageBox
áá 
.
áá 
Show
áá 
(
áá  
e
áá  !
.
áá! "
Message
áá" )
)
áá) *
;
áá* +
}
àà 
finally
ââ 
{
ââ 
cmd
ââ 
.
ââ 

Connection
ââ $
.
ââ$ %
Close
ââ% *
(
ââ* +
)
ââ+ ,
;
ââ, -
}
ââ. /
return
ää 
	actualiza
ää 
;
ää 
}
ãã 	
public
éé 
bool
éé 
EliminarUbigeo
éé "
(
éé" #
int
éé# &
id
éé' )
)
éé) *
{
èè 	

SqlCommand
êê 
cmd
êê 
=
êê 
null
êê !
;
êê! "
bool
ëë 
	eliminado
ëë 
=
ëë 
false
ëë "
;
ëë" #
try
íí 
{
ìì 
SqlConnection
îî 
cn
îî  
=
îî! "
Conexion
îî# +
.
îî+ ,
	Instancia
îî, 5
.
îî5 6
Conectar
îî6 >
(
îî> ?
)
îî? @
;
îî@ A
cmd
ïï 
=
ïï 
new
ïï 

SqlCommand
ïï $
(
ïï$ %
$str
ïï% 7
,
ïï7 8
cn
ïï9 ;
)
ïï; <
;
ïï< =
cmd
ññ 
.
ññ 
CommandType
ññ 
=
ññ  !
CommandType
ññ" -
.
ññ- .
StoredProcedure
ññ. =
;
ññ= >
cmd
óó 
.
óó 

Parameters
óó 
.
óó 
AddWithValue
óó +
(
óó+ ,
$str
óó, 7
,
óó7 8
id
óó9 ;
)
óó; <
;
óó< =
cn
òò 
.
òò 
Open
òò 
(
òò 
)
òò 
;
òò 
int
ôô 
i
ôô 
=
ôô 
cmd
ôô 
.
ôô 
ExecuteNonQuery
ôô +
(
ôô+ ,
)
ôô, -
;
ôô- .
if
öö 
(
öö 
i
öö 
>
öö 
$num
öö 
)
öö 
{
õõ 
	eliminado
úú 
=
úú 
true
úú  $
;
úú$ %
}
ùù 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
e
üü 
)
üü 
{
†† 

MessageBox
°° 
.
°° 
Show
°° 
(
°°  
e
°°  !
.
°°! "
Message
°°" )
)
°°) *
;
°°* +
}
¢¢ 
finally
££ 
{
££ 
cmd
££ 
.
££ 

Connection
££ $
.
££$ %
Close
££% *
(
££* +
)
££+ ,
;
££, -
}
££. /
return
§§ 
	eliminado
§§ 
;
§§ 
}
•• 	
public
ßß 
List
ßß 
<
ßß 
	EntUbigeo
ßß 
>
ßß 
BuscarUbigeo
ßß +
(
ßß+ ,
string
ßß, 2
busqueda
ßß3 ;
)
ßß; <
{
®® 	
List
©© 
<
©© 
	EntUbigeo
©© 
>
©© 
lista
©© !
=
©©" #
new
©©$ '
List
©©( ,
<
©©, -
	EntUbigeo
©©- 6
>
©©6 7
(
©©7 8
)
©©8 9
;
©©9 :

SqlCommand
™™ 
cmd
™™ 
=
™™ 
null
™™ !
;
™™! "
try
´´ 
{
¨¨ 
SqlConnection
≠≠ 
cn
≠≠  
=
≠≠! "
Conexion
≠≠# +
.
≠≠+ ,
	Instancia
≠≠, 5
.
≠≠5 6
Conectar
≠≠6 >
(
≠≠> ?
)
≠≠? @
;
≠≠@ A
cmd
ÆÆ 
=
ÆÆ 
new
ÆÆ 

SqlCommand
ÆÆ $
(
ÆÆ$ %
$str
ÆÆ% 5
,
ÆÆ5 6
cn
ÆÆ7 9
)
ÆÆ9 :
;
ÆÆ: ;
cmd
ØØ 
.
ØØ 
CommandType
ØØ 
=
ØØ  !
CommandType
ØØ" -
.
ØØ- .
StoredProcedure
ØØ. =
;
ØØ= >
cmd
∞∞ 
.
∞∞ 

Parameters
∞∞ 
.
∞∞ 
AddWithValue
∞∞ +
(
∞∞+ ,
$str
∞∞, 4
,
∞∞4 5
busqueda
∞∞6 >
)
∞∞> ?
;
∞∞? @
cn
±± 
.
±± 
Open
±± 
(
±± 
)
±± 
;
±± 
SqlDataReader
≤≤ 
dr
≤≤  
=
≤≤! "
cmd
≤≤# &
.
≤≤& '
ExecuteReader
≤≤' 4
(
≤≤4 5
)
≤≤5 6
;
≤≤6 7
while
≥≥ 
(
≥≥ 
dr
≥≥ 
.
≥≥ 
Read
≥≥ 
(
≥≥ 
)
≥≥  
)
≥≥  !
{
¥¥ 
	EntUbigeo
µµ 
ubi
µµ !
=
µµ" #
new
µµ$ '
	EntUbigeo
µµ( 1
(
µµ1 2
)
µµ2 3
;
µµ3 4
ubi
∂∂ 
.
∂∂ 
IdUbigeo
∂∂  
=
∂∂! "
dr
∂∂# %
[
∂∂% &
$str
∂∂& 0
]
∂∂0 1
.
∂∂1 2
ToString
∂∂2 :
(
∂∂: ;
)
∂∂; <
;
∂∂< =
ubi
∑∑ 
.
∑∑ 
Departamento
∑∑ $
=
∑∑% &
dr
∑∑' )
[
∑∑) *
$str
∑∑* 8
]
∑∑8 9
.
∑∑9 :
ToString
∑∑: B
(
∑∑B C
)
∑∑C D
;
∑∑D E
ubi
∏∏ 
.
∏∏ 
	Provincia
∏∏ !
=
∏∏" #
dr
∏∏$ &
[
∏∏& '
$str
∏∏' 2
]
∏∏2 3
.
∏∏3 4
ToString
∏∏4 <
(
∏∏< =
)
∏∏= >
;
∏∏> ?
ubi
ππ 
.
ππ 
Distrito
ππ  
=
ππ! "
dr
ππ# %
[
ππ% &
$str
ππ& 0
]
ππ0 1
.
ππ1 2
ToString
ππ2 :
(
ππ: ;
)
ππ; <
;
ππ< =
lista
∫∫ 
.
∫∫ 
Add
∫∫ 
(
∫∫ 
ubi
∫∫ !
)
∫∫! "
;
∫∫" #
}
ªª 
}
ºº 
catch
ΩΩ 
(
ΩΩ 
	Exception
ΩΩ 
e
ΩΩ 
)
ΩΩ 
{
ææ 

MessageBox
¿¿ 
.
¿¿ 
Show
¿¿ 
(
¿¿  
e
¿¿  !
.
¿¿! "
Message
¿¿" )
)
¿¿) *
;
¿¿* +
}
¡¡ 
finally
¬¬ 
{
√√ 
cmd
ƒƒ 
.
ƒƒ 

Connection
ƒƒ 
.
ƒƒ 
Close
ƒƒ $
(
ƒƒ$ %
)
ƒƒ% &
;
ƒƒ& '
}
≈≈ 
return
∆∆ 
lista
∆∆ 
;
∆∆ 
}
«« 	
}
   
}ÀÀ ·X
YC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatVenta.cs
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatVenta 
: 
	IDatVenta %
{ 
private 
static 
readonly 
DatVenta  (

_instancia) 3
=4 5
new6 9
DatVenta: B
(B C
)C D
;D E
public 
static 
DatVenta 
	Instancia (
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
int 

CrearVenta 
( 
EntVenta &
venta' ,
), -
{ 	

SqlCommand 
cmd 
= 
null !
;! "
int 
idVenta 
= 
- 
$num 
; 
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 3
,3 4
cn5 7
)7 8
;8 9
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
venta6 ;
.; <
Total< A
)A B
;B C
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
venta: ?
.? @
Cliente@ G
.G H
	IdUsuarioH Q
)Q R
;R S
SqlParameter 
id 
=  !
new" %
SqlParameter& 2
(2 3
$str3 =
,= >
$num? @
)@ A
{ 
	Direction   
=   
ParameterDirection    2
.  2 3
Output  3 9
}!! 
;!! 
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
id""# %
)""% &
;""& '
cn$$ 
.$$ 
Open$$ 
($$ 
)$$ 
;$$ 
int%% 
i%% 
=%% 
cmd%% 
.%% 
ExecuteNonQuery%% +
(%%+ ,
)%%, -
;%%- .
if&& 
(&& 
i&& 
>&& 
$num&& 
)&& 
{'' 
idVenta(( 
=(( 
Convert(( %
.((% &
ToInt32((& -
(((- .
cmd((. 1
.((1 2

Parameters((2 <
[((< =
$str((= G
]((G H
.((H I
Value((I N
)((N O
;((O P
})) 
if** 
(** 
idVenta** 
==** 
-**  
$num**  !
)**! "
{++ 

MessageBox,, 
.,, 
Show,, #
(,,# $
$str,,$ 1
),,1 2
;,,2 3
}-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
{00 

MessageBox11 
.11 
Show11 
(11  
e11  !
.11! "
Message11" )
,11) *
$str11+ c
,11c d
MessageBoxButtons11e v
.11v w
OK11w y
,11y z
MessageBoxIcon	11{ â
.
11â ä
Error
11ä è
)
11è ê
;
11ê ë
}22 
finally33 
{44 
cmd55 
.55 

Connection55 
.55 
Close55 $
(55$ %
)55% &
;55& '
}66 
return77 
idVenta77 
;77 
}88 	
public:: 
List:: 
<:: 
EntVenta:: 
>:: 
ListarVenta:: )
(::) *
int::* -
id::. 0
)::0 1
{;; 	

SqlCommand<< 
cmd<< 
=<< 
null<< !
;<<! "
List== 
<== 
EntVenta== 
>== 
lista==  
===! "
new==# &
List==' +
<==+ ,
EntVenta==, 4
>==4 5
(==5 6
)==6 7
;==7 8
try>> 
{?? 
SqlConnection@@ 
cn@@  
=@@! "
Conexion@@# +
.@@+ ,
	Instancia@@, 5
.@@5 6
Conectar@@6 >
(@@> ?
)@@? @
;@@@ A
cmdAA 
=AA 
newAA 

SqlCommandAA $
(AA$ %
$strAA% 4
,AA4 5
cnAA6 8
)AA8 9
;AA9 :
cmdBB 
.BB 

ParametersBB 
.BB 
AddWithValueBB +
(BB+ ,
$strBB, 1
,BB1 2
idBB3 5
)BB5 6
;BB6 7
cmdCC 
.CC 
CommandTypeCC 
=CC  !
CommandTypeCC" -
.CC- .
StoredProcedureCC. =
;CC= >
cnDD 
.DD 
OpenDD 
(DD 
)DD 
;DD 
SqlDataReaderEE 
drEE  
=EE! "
cmdEE# &
.EE& '
ExecuteReaderEE' 4
(EE4 5
)EE5 6
;EE6 7
whileFF 
(FF 
drFF 
.FF 
ReadFF 
(FF 
)FF  
)FF  !
{GG 
EntVentaHH 
venHH  
=HH! "
newHH# &
EntVentaHH' /
{II 
IdVentaJJ 
=JJ  !
ConvertJJ" )
.JJ) *
ToInt32JJ* 1
(JJ1 2
drJJ2 4
[JJ4 5
$strJJ5 >
]JJ> ?
)JJ? @
,JJ@ A
FechaKK 
=KK 
ConvertKK  '
.KK' (

ToDateTimeKK( 2
(KK2 3
drKK3 5
[KK5 6
$strKK6 =
]KK= >
)KK> ?
,KK? @
TotalLL 
=LL 
ConvertLL  '
.LL' (
ToDoubleLL( 0
(LL0 1
drLL1 3
[LL3 4
$strLL4 ;
]LL; <
)LL< =
,LL= >
EstadoMM 
=MM  
drMM! #
[MM# $
$strMM$ ,
]MM, -
.MM- .
ToStringMM. 6
(MM6 7
)MM7 8
,MM8 9
ClienteNN 
=NN  !
newNN" %

EntUsuarioNN& 0
{OO 
	IdUsuarioPP %
=PP& '
ConvertPP( /
.PP/ 0
ToInt32PP0 7
(PP7 8
drPP8 :
[PP: ;
$strPP; F
]PPF G
)PPG H
,PPH I
}QQ 
}RR 
;RR 
listaSS 
.SS 
AddSS 
(SS 
venSS !
)SS! "
;SS" #
}TT 
}UU 
catchVV 
(VV 
	ExceptionVV 
eVV 
)VV 
{WW 

MessageBoxYY 
.YY 
ShowYY 
(YY  
eYY  !
.YY! "
MessageYY" )
)YY) *
;YY* +
}ZZ 
finally[[ 
{\\ 
cmd]] 
.]] 

Connection]] 
.]] 
Close]] $
(]]$ %
)]]% &
;]]& '
}^^ 
return__ 
lista__ 
;__ 
}`` 	
publicbb 
Listbb 
<bb 
EntVentabb 
>bb 
ListarTodasLasVentabb 1
(bb1 2
)bb2 3
{cc 	

SqlCommanddd 
cmddd 
=dd 
nulldd !
;dd! "
Listee 
<ee 
EntVentaee 
>ee 
listaee  
=ee! "
newee# &
Listee' +
<ee+ ,
EntVentaee, 4
>ee4 5
(ee5 6
)ee6 7
;ee7 8
tryff 
{gg 
SqlConnectionhh 
cnhh  
=hh! "
Conexionhh# +
.hh+ ,
	Instanciahh, 5
.hh5 6
Conectarhh6 >
(hh> ?
)hh? @
;hh@ A
cmdii 
=ii 
newii 

SqlCommandii $
(ii$ %
$strii% <
,ii< =
cnii> @
)ii@ A
;iiA B
cmdjj 
.jj 
CommandTypejj 
=jj  !
CommandTypejj" -
.jj- .
StoredProcedurejj. =
;jj= >
cnkk 
.kk 
Openkk 
(kk 
)kk 
;kk 
SqlDataReaderll 
drll  
=ll! "
cmdll# &
.ll& '
ExecuteReaderll' 4
(ll4 5
)ll5 6
;ll6 7
whilemm 
(mm 
drmm 
.mm 
Readmm 
(mm 
)mm  
)mm  !
{nn 
EntVentaoo 
venoo  
=oo! "
newoo# &
EntVentaoo' /
{pp 
IdVentaqq 
=qq  !
Convertqq" )
.qq) *
ToInt32qq* 1
(qq1 2
drqq2 4
[qq4 5
$strqq5 >
]qq> ?
)qq? @
,qq@ A
Fecharr 
=rr 
Convertrr  '
.rr' (

ToDateTimerr( 2
(rr2 3
drrr3 5
[rr5 6
$strrr6 =
]rr= >
)rr> ?
,rr? @
Totalss 
=ss 
Convertss  '
.ss' (
ToDoubless( 0
(ss0 1
drss1 3
[ss3 4
$strss4 ;
]ss; <
)ss< =
,ss= >
Estadott 
=tt  
drtt! #
[tt# $
$strtt$ ,
]tt, -
.tt- .
ToStringtt. 6
(tt6 7
)tt7 8
,tt8 9
Clienteuu 
=uu  !
newuu" %

EntUsuariouu& 0
{vv 
Correoww "
=ww# $
drww% '
[ww' (
$strww( 0
]ww0 1
.ww1 2
ToStringww2 :
(ww: ;
)ww; <
,ww< =
UserNamexx $
=xx% &
drxx' )
[xx) *
$strxx* 4
]xx4 5
.xx5 6
ToStringxx6 >
(xx> ?
)xx? @
}yy 
}zz 
;zz 
lista{{ 
.{{ 
Add{{ 
({{ 
ven{{ !
){{! "
;{{" #
}|| 
}}} 
catch~~ 
(~~ 
	Exception~~ 
e~~ 
)~~ 
{ 

MessageBox
ÅÅ 
.
ÅÅ 
Show
ÅÅ 
(
ÅÅ  
e
ÅÅ  !
.
ÅÅ! "
Message
ÅÅ" )
)
ÅÅ) *
;
ÅÅ* +
}
ÇÇ 
finally
ÉÉ 
{
ÑÑ 
cmd
ÖÖ 
.
ÖÖ 

Connection
ÖÖ 
.
ÖÖ 
Close
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
;
ÖÖ& '
}
ÜÜ 
return
áá 
lista
áá 
;
áá 
}
àà 	
}
ÌÌ 
}ÓÓ ¨
XC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\encrypt.cs
	namespace 	
CapaAccesoDatos
 
{ 
public 

class 
encrypt 
{ 
public 
static 
string 
	GetSHA256 &
(& '
string' -
str. 1
)1 2
{		 	
SHA256

 
sha256

 
=

 
SHA256Managed

 )
.

) *
Create

* 0
(

0 1
)

1 2
;

2 3
ASCIIEncoding 
encoding "
=# $
new% (
ASCIIEncoding) 6
(6 7
)7 8
;8 9
byte 
[ 
] 
stream 
= 
null  
;  !
StringBuilder 
sb 
= 
new "
StringBuilder# 0
(0 1
)1 2
;2 3
stream 
= 
sha256 
. 
ComputeHash '
(' (
encoding( 0
.0 1
GetBytes1 9
(9 :
str: =
)= >
)> ?
;? @
for 
( 
int 
i 
= 
$num 
; 
i 
< 
stream  &
.& '
Length' -
;- .
i/ 0
++0 2
)2 3
sb4 6
.6 7
AppendFormat7 C
(C D
$strD L
,L M
streamN T
[T U
iU V
]V W
)W X
;X Y
return 
sb 
. 
ToString 
( 
)  
;  !
} 	
} 
} º
fC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatCompra.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 

IDatCompra

 
{ 
int 
CrearCompra 
( 
	EntCompra !
comp" &
)& '
;' (
List	 
< 
	EntCompra 
> 
ListarCompra %
(% &
int& )
id* ,
), -
;- .
List	 
< 
	EntCompra 
> !
ListarTodasLasCompras .
(. /
)/ 0
;0 1
bool	 
EliminarCompra 
( 
int  
idcompra! )
)) *
;* +
List	 
< 
	EntCompra 
> 
BuscarCompra %
(% &
string& ,
busqueda- 5
)5 6
;6 7
} 
} Ñ
iC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatDetCompra.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{ 
public 

	interface 
IDatDetCompra "
{ 
bool		 
CrearDetCompra		 
(		 
EntDetCompra		 (
Det		) ,
)		, -
;		- .
List

 
<

 
EntDetCompra

 
>

 "
MostrarDetalleCompraId

 1
(

1 2
int

2 5
id

6 8
)

8 9
;

9 :
} 
} ˝
hC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatDetVenta.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatDetVenta

 !
{ 
bool 
CrearDetVenta 
( 
EntDetVenta &
Det' *
)* +
;+ ,
List 
< 
EntDetVenta 
> 
Mostrardetventa )
() *
int* -
idVenta. 5
)5 6
;6 7
} 
} €

hC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatProducto.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatProducto

 !
{ 
bool 
CrearProducto 
( 
EntProducto &
prod' +
)+ ,
;, -
List 
< 
EntProducto 
> 
ListarProducto (
(( )
)) *
;* +
bool 
ActualizarProducto 
(  
EntProducto  +
Prod, 0
)0 1
;1 2
bool 
EliminarProducto 
( 
int !
id" $
)$ %
;% &
List 
< 
EntProducto 
> 
BuscarProducto (
(( )
string) /
busqueda0 8
)8 9
;9 :
EntProducto 
BuscarProductoId $
($ %
int% (
idprod) /
)/ 0
;0 1
List 
<  
EntProveedorProducto !
>! "
Ordenar# *
(* +
int+ .
dato/ 3
)3 4
;4 5
} 
} ï
iC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatProveedor.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatProveedor

 "
{ 
bool 
CrearProveedor 
( 
EntProveedor (
pro) ,
), -
;- .
List 
< 
EntProveedor 
> 
ListarProveedor *
(* +
)+ ,
;, -
List 
< 
EntProveedor 
> 
SelectListProveedor .
(. /
)/ 0
;0 1
bool 
ActualizarProveedor  
(  !
EntProveedor! -
pro. 1
)1 2
;2 3
bool 
EliminarProveedor 
( 
int "
idProveedor# .
). /
;/ 0
List 
< 
EntProveedor 
> "
SelectListProveedordat 1
(1 2
int2 5
idprov6 <
)< =
;= >
List 
< 
EntProveedor 
> 
BuscarProveedor *
(* +
string+ 1
busqueda2 :
): ;
;; <
EntProveedor 
BuscarIdProveedor &
(& '
int' *
idProveedor+ 6
)6 7
;7 8
} 
} ∂
qC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatProveedorProducto.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 !
IDatProveedorProducto

 *
{ 
bool "
CrearProveedorProducto #
(# $ 
EntProveedorProducto$ 8
prod9 =
)= >
;> ?
List 
<  
EntProveedorProducto !
>! "%
ListarProductoParaComprar# <
(< =
)= >
;> ?
List 
<  
EntProveedorProducto !
>! "$
MostarDetalleProveedorId# ;
(; <
int< ?
idProveedor@ K
)K L
;L M
bool $
EliminarDetalleProveedor %
(% &
int& )
prov* .
,. /
int0 3
prod4 8
)8 9
;9 :
List 
<  
EntProveedorProducto !
>! "%
BuscarProductoParaComprar# <
(< =
string= C
busquedaD L
)L M
;M N 
EntProveedorProducto $
BuscarProvedorProductoId 5
(5 6
int6 9
idprod: @
,@ A
intB E
idprovF L
)L M
;M N
} 
} ˙
qC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatTemporaryProducts.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 !
IDatTemporaryProducts

 *
{ 
bool &
CreaarTemporaryProductsCli '
(' ( 
EntTemporaryProducts( <
temp= A
)A B
;B C
bool #
CreaarTemporaryProducts $
($ % 
EntTemporaryProducts% 9
temp: >
)> ?
;? @
List 
<  
EntTemporaryProducts !
>! "$
MostrarTemporaryProducts# ;
(; <
int< ?
	idUsuario@ I
)I J
;J K
List 
<  
EntTemporaryProducts !
>! "'
MostrarTemporaryProductsCli# >
(> ?
int? B
	idUsuarioC L
)L M
;M N
bool %
EliminarTemporaryProducts &
(& '
int' *
idtemp+ 1
)1 2
;2 3
bool '
ActualizarTemporaryProducts (
(( ) 
EntTemporaryProducts) =
temp> B
)B C
;C D 
EntTemporaryProducts %
BuscarTemporaryProductsId 6
(6 7
int7 :
id; =
)= >
;> ? 
EntTemporaryProducts (
BuscarTemporaryProductsIdCli 9
(9 :
int: =
id> @
)@ A
;A B
} 
} «
lC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatTipoProducto.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatTipoProducto

 %
{ 
bool 
CrearTipoProducto 
( 
EntTipoProducto .
tip/ 2
)2 3
;3 4
List 
< 
EntTipoProducto 
> "
SelectListTipoProducto 4
(4 5
)5 6
;6 7
List 
< 
EntTipoProducto 
> %
SelectListTipoProductodat 7
(7 8
int8 ;
id< >
)> ?
;? @
bool "
ActualizarTipoProducto #
(# $
EntTipoProducto$ 3
tip4 7
)7 8
;8 9
bool  
EliminarTipoProducto !
(! "
int" %
id& (
)( )
;) *
} 
} ì	
fC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatUbigeo.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 

IDatUbigeo

 
{ 
bool 
CrearUbigeo 
( 
	EntUbigeo "
ubi# &
)& '
;' (
List 
< 
	EntUbigeo 
> 
ListarUbigeo $
($ %
)% &
;& '
List 
< 
	EntUbigeo 
> 
ListarDistrito &
(& '
)' (
;( )
bool 
ActualizarUbigeo 
( 
	EntUbigeo '
ubi( +
)+ ,
;, -
bool 
EliminarUbigeo 
( 
int 
id  "
)" #
;# $
List 
< 
	EntUbigeo 
> 
BuscarUbigeo $
($ %
string% +
busqueda, 4
)4 5
;5 6
} 
} ∑
gC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatUsuario.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatUsuario

  
{ 
bool 
CrearCliente 
( 

EntUsuario $
Cli% (
)( )
;) *
List 
< 

EntUsuario 
> 
ListarCliente &
(& '
)' (
;( )
List 
< 

EntUsuario 
> 
BuscarCliente &
(& '
string' -
busqueda. 6
)6 7
;7 8
bool 
EditarCliente 
( 

EntUsuario %
u& '
)' (
;( )
List 
< 

EntUsuario 
> !
ListarAdministradores .
(. /
)/ 0
;0 1
bool #
ActualizarAdministrador $
($ %

EntUsuario% /
ad0 2
)2 3
;3 4
List 
< 

EntUsuario 
> "
BuscaraAdministradores /
(/ 0
string0 6
busqueda7 ?
)? @
;@ A

EntUsuario 
IniciarSesion  
(  !
string! '
campo( -
,- .
string/ 5
contra6 <
)< =
;= >
bool 
EliminarUsuarios 
( 
int !
id" $
)$ %
;% &

EntUsuario 
BuscarIdUsuario "
(" #
int# &
busqueda' /
)/ 0
;0 1
} 
} ˙
eC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatVenta.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
	IDatVenta

 
{ 
int 

CrearVenta 
( 
EntVenta 
venta  %
)% &
;& '
List 
< 
EntVenta 
> 
ListarVenta "
(" #
int# &
id' )
)) *
;* +
List 
< 
EntVenta 
> 
ListarTodasLasVenta *
(* +
)+ ,
;, -
} 
} ì
hC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str *
)* +
]+ ,
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *