ı
KD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Conexion.cs
	namespace 	
CapaAccesoDatos
 
{ 
public 

class 
Conexion 
{		 
private

 
static

 
readonly

 
Conexion

  (

_instancia

) 3
=

4 5
new

6 9
Conexion

: B
(

B C
)

C D
;

D E
public 
static 
Conexion 
	Instancia (
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
SqlConnection 
Conectar %
(% &
)& '
{ 	
SqlConnection 
cn 
= 
new "
SqlConnection# 0
(0 1
)1 2
;2 3
try 
{ 
cn 
. 
ConnectionString #
=$ %
$str& 
;	 Ä
cn 
. 
Open 
( 
) 
; 
cn 
. 
Close 
( 
) 
; 
} 
catch 
( 
	Exception 
ex 
)  
{ 
throw 
new 
	Exception #
(# $
$str$ E
+E F
exF H
.H I
MessageI P
)P Q
;Q R
} 
return 
cn 
; 
} 	
}   
<<<<<<< HEAD
}!! •˝
WD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatTemporaryProducts.cs
=======
}!! ≥˝
eC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatTemporaryProducts.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class  
DatTemporaryProducts %
:& '!
IDatTemporaryProducts( =
{ 
private 
static 
readonly  
DatTemporaryProducts  4
	_instance5 >
=? @
newA D 
DatTemporaryProductsE Y
(Y Z
)Z [
;[ \
public 
static  
DatTemporaryProducts *
Instance+ 3
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
bool &
CreaarTemporaryProductsCli .
(. / 
EntTemporaryProducts/ C
tempD H
)H I
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% B
,B C
cnD F
)F G
;G H
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
temp; ?
.? @
ProveedorProducto@ Q
.Q R
ProductoR Z
.Z [

IdProducto[ e
)e f
;f g
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
temp: >
.> ?
Usuario? F
.F G
	IdUsuarioG P
)P Q
;Q R
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
temp9 =
.= >
Cantidad> F
)F G
;G H
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
temp9 =
.= >
Subtotal> F
)F G
;G H
cn 
. 
Open 
( 
) 
; 
int   
i   
=   
cmd   
.   
ExecuteNonQuery   +
(  + ,
)  , -
;  - .
if!! 
(!! 
i!! 
>!! 
$num!! 
)!! 
{"" 
creado## 
=## 
true## !
;##! "
}$$ 
}%% 
catch&& 
(&& 
	Exception&& 
e&& 
)&& 
{'' 

MessageBox)) 
.)) 
Show)) 
())  
e))  !
.))! "
Message))" )
)))) *
;))* +
}** 
return,, 
creado,, 
;,, 
}.. 	
public// 
bool// #
CreaarTemporaryProducts// +
(//+ , 
EntTemporaryProducts//, @
temp//A E
)//E F
{00 	

SqlCommand11 
cmd11 
=11 
null11 !
;11! "
bool22 
creado22 
=22 
false22 
;22  
try33 
{44 
SqlConnection55 
cn55  
=55! "
Conexion55# +
.55+ ,
	Instancia55, 5
.555 6
Conectar556 >
(55> ?
)55? @
;55@ A
cmd66 
=66 
new66 

SqlCommand66 $
(66$ %
$str66% ?
,66? @
cn66A C
)66C D
;66D E
cmd77 
.77 
CommandType77 
=77  !
CommandType77" -
.77- .
StoredProcedure77. =
;77= >
cmd88 
.88 

Parameters88 
.88 
AddWithValue88 +
(88+ ,
$str88, 9
,889 :
temp88; ?
.88? @
ProveedorProducto88@ Q
.88Q R
Producto88R Z
.88Z [

IdProducto88[ e
)88e f
;88f g
cmd99 
.99 

Parameters99 
.99 
AddWithValue99 +
(99+ ,
$str99, :
,99: ;
temp99< @
.99@ A
ProveedorProducto99A R
.99R S
	Proveedor99S \
.99\ ]
IdProveedor99] h
)99h i
;99i j
cmd:: 
.:: 

Parameters:: 
.:: 
AddWithValue:: +
(::+ ,
$str::, 8
,::8 9
temp::: >
.::> ?
Usuario::? F
.::F G
	IdUsuario::G P
)::P Q
;::Q R
cmd;; 
.;; 

Parameters;; 
.;; 
AddWithValue;; +
(;;+ ,
$str;;, 7
,;;7 8
temp;;9 =
.;;= >
Cantidad;;> F
);;F G
;;;G H
cmd<< 
.<< 

Parameters<< 
.<< 
AddWithValue<< +
(<<+ ,
$str<<, 7
,<<7 8
temp<<9 =
.<<= >
Subtotal<<> F
)<<F G
;<<G H
cn== 
.== 
Open== 
(== 
)== 
;== 
int>> 
i>> 
=>> 
cmd>> 
.>> 
ExecuteNonQuery>> +
(>>+ ,
)>>, -
;>>- .
if?? 
(?? 
i?? 
>?? 
$num?? 
)?? 
{@@ 
creadoAA 
=AA 
trueAA !
;AA! "
}BB 
}CC 
catchDD 
(DD 
	ExceptionDD 
eDD 
)DD 
{EE 

MessageBoxGG 
.GG 
ShowGG 
(GG  
eGG  !
.GG! "
MessageGG" )
)GG) *
;GG* +
}HH 
returnII 
creadoII 
;II 
}KK 	
publicMM 
ListMM 
<MM  
EntTemporaryProductsMM (
>MM( )$
MostrarTemporaryProductsMM* B
(MMB C
intMMC F
	idUsuarioMMG P
)MMP Q
{NN 	

SqlCommandOO 
cmdOO 
=OO 
nullOO !
;OO! "
ListPP 
<PP  
EntTemporaryProductsPP %
>PP% &
listPP' +
=PP, -
newPP. 1
ListPP2 6
<PP6 7 
EntTemporaryProductsPP7 K
>PPK L
(PPL M
)PPM N
;PPN O
tryQQ 
{RR 
SqlConnectionSS 
cnSS  
=SS! "
ConexionSS# +
.SS+ ,
	InstanciaSS, 5
.SS5 6
ConectarSS6 >
(SS> ?
)SS? @
;SS@ A
cmdTT 
=TT 
newTT 

SqlCommandTT $
(TT$ %
$strTT% @
,TT@ A
cnTTB D
)TTD E
;TTE F
cmdUU 
.UU 

ParametersUU 
.UU 
AddWithValueUU +
(UU+ ,
$strUU, 8
,UU8 9
	idUsuarioUU: C
)UUC D
;UUD E
cmdVV 
.VV 
CommandTypeVV 
=VV  !
CommandTypeVV" -
.VV- .
StoredProcedureVV. =
;VV= >
cnWW 
.WW 
OpenWW 
(WW 
)WW 
;WW 
SqlDataReaderXX 
drXX  
=XX! "
cmdXX# &
.XX& '
ExecuteReaderXX' 4
(XX4 5
)XX5 6
;XX6 7
whileYY 
(YY 
drYY 
.YY 
ReadYY 
(YY 
)YY  
)YY  !
{ZZ  
EntTemporaryProducts[[ (
temp[[) -
=[[. /
new[[0 3 
EntTemporaryProducts[[4 H
{\\ 
IdTemp]] 
=]]  
Convert]]! (
.]]( )
ToInt32]]) 0
(]]0 1
dr]]1 3
[]]3 4
$str]]4 <
]]]< =
)]]= >
,]]> ?
ProveedorProducto^^ )
=^^) *
new^^* - 
EntProveedorProducto^^. B
{__ 
	Proveedor`` %
=``& '
new``( +
EntProveedor``, 8
{aa 
IdProveedorbb  +
=bb, -
Convertbb. 5
.bb5 6
ToInt32bb6 =
(bb= >
drbb> @
[bb@ A
$strbbA N
]bbN O
)bbO P
,bbP Q
RazonSocialcc  +
=cc, -
drcc. 0
[cc0 1
$strcc1 >
]cc> ?
.cc? @
ToStringcc@ H
(ccH I
)ccI J
,ccJ K
Descripciondd  +
=dd, -
drdd. 0
[dd0 1
$strdd1 >
]dd> ?
.dd? @
ToStringdd@ H
(ddH I
)ddI J
}ee 
,ee 
Productoff $
=ff% &
newff' *
EntProductoff+ 6
{gg 

IdProductohh  *
=hh+ ,
Converthh- 4
.hh4 5
ToInt32hh5 <
(hh< =
drhh= ?
[hh? @
$strhh@ L
]hhL M
)hhM N
,hhN O
Nombreii  &
=ii' (
drii) +
[ii+ ,
$strii, 4
]ii4 5
.ii5 6
ToStringii6 >
(ii> ?
)ii? @
,ii@ A
Longitudjj  (
=jj) *
Convertjj+ 2
.jj2 3
ToDoublejj3 ;
(jj; <
drjj< >
[jj> ?
$strjj? I
]jjI J
)jjJ K
,jjK L
Diametrokk  (
=kk) *
Convertkk+ 2
.kk2 3
ToDoublekk3 ;
(kk; <
drkk< >
[kk> ?
$strkk? I
]kkI J
)kkJ K
,kkK L
PrecioVentall  +
=ll, -
Convertll. 5
.ll5 6
ToDoublell6 >
(ll> ?
drll? A
[llA B
$strllB O
]llO P
)llP Q
,llQ R
Tipomm  $
=mm% &
newmm' *
EntTipoProductomm+ :
{nn  !
Nombreoo$ *
=oo+ ,
droo- /
[oo/ 0
$stroo0 6
]oo6 7
.oo7 8
ToStringoo8 @
(oo@ A
)ooA B
}pp  !
}rr 
,rr 
PrecioComprass (
=ss) *
Convertss+ 2
.ss2 3
ToDoubless3 ;
(ss; <
drss< >
[ss> ?
$strss? M
]ssM N
)ssN O
}tt 
,tt 
Cantidaduu  
=uu! "
Convertuu# *
.uu* +
ToInt32uu+ 2
(uu2 3
druu3 5
[uu5 6
$struu6 @
]uu@ A
)uuA B
,uuB C
Subtotalvv  
=vv! "
Convertvv# *
.vv* +
ToDoublevv+ 3
(vv3 4
drvv4 6
[vv6 7
$strvv7 A
]vvA B
)vvB C
}ww 
;ww 
listxx 
.xx 
Addxx 
(xx 
tempxx !
)xx! "
;xx" #
}yy 
}{{ 
catch|| 
(|| 
	Exception|| 
e|| 
)|| 
{}} 

MessageBox~~ 
.~~ 
Show~~ 
(~~  
e~~  !
.~~! "
Message~~" )
)~~) *
;~~* +
} 
return
ÄÄ 
list
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
List
ÉÉ 
<
ÉÉ "
EntTemporaryProducts
ÉÉ (
>
ÉÉ( ))
MostrarTemporaryProductsCli
ÉÉ* E
(
ÉÉE F
int
ÉÉF I
	idUsuario
ÉÉJ S
)
ÉÉS T
{
ÑÑ 	

SqlCommand
ÖÖ 
cmd
ÖÖ 
=
ÖÖ 
null
ÖÖ !
;
ÖÖ! "
List
ÜÜ 
<
ÜÜ "
EntTemporaryProducts
ÜÜ %
>
ÜÜ% &
list
ÜÜ' +
=
ÜÜ, -
new
ÜÜ. 1
List
ÜÜ2 6
<
ÜÜ6 7"
EntTemporaryProducts
ÜÜ7 K
>
ÜÜK L
(
ÜÜL M
)
ÜÜM N
;
ÜÜN O
try
áá 
{
àà 
SqlConnection
ââ 
cn
ââ  
=
ââ! "
Conexion
ââ# +
.
ââ+ ,
	Instancia
ââ, 5
.
ââ5 6
Conectar
ââ6 >
(
ââ> ?
)
ââ? @
;
ââ@ A
cmd
ää 
=
ää 
new
ää 

SqlCommand
ää $
(
ää$ %
$str
ää% C
,
ääC D
cn
ääE G
)
ääG H
;
ääH I
cmd
ãã 
.
ãã 

Parameters
ãã 
.
ãã 
AddWithValue
ãã +
(
ãã+ ,
$str
ãã, 8
,
ãã8 9
	idUsuario
ãã: C
)
ããC D
;
ããD E
cmd
åå 
.
åå 
CommandType
åå 
=
åå  !
CommandType
åå" -
.
åå- .
StoredProcedure
åå. =
;
åå= >
cn
çç 
.
çç 
Open
çç 
(
çç 
)
çç 
;
çç 
SqlDataReader
éé 
dr
éé  
=
éé! "
cmd
éé# &
.
éé& '
ExecuteReader
éé' 4
(
éé4 5
)
éé5 6
;
éé6 7
while
èè 
(
èè 
dr
èè 
.
èè 
Read
èè 
(
èè 
)
èè  
)
èè  !
{
êê "
EntTemporaryProducts
ëë (
temp
ëë) -
=
ëë. /
new
ëë0 3"
EntTemporaryProducts
ëë4 H
{
íí 
IdTemp
ìì 
=
ìì  
Convert
ìì! (
.
ìì( )
ToInt32
ìì) 0
(
ìì0 1
dr
ìì1 3
[
ìì3 4
$str
ìì4 <
]
ìì< =
)
ìì= >
,
ìì> ?
ProveedorProducto
îî )
=
îî* +
new
îî, /"
EntProveedorProducto
îî0 D
{
ïï 
Producto
ññ $
=
ññ% &
new
ññ' *
EntProducto
ññ+ 6
{
óó 

IdProducto
òò  *
=
òò+ ,
Convert
òò- 4
.
òò4 5
ToInt32
òò5 <
(
òò< =
dr
òò= ?
[
òò? @
$str
òò@ L
]
òòL M
)
òòM N
,
òòN O
Nombre
ôô  &
=
ôô' (
dr
ôô) +
[
ôô+ ,
$str
ôô, 4
]
ôô4 5
.
ôô5 6
ToString
ôô6 >
(
ôô> ?
)
ôô? @
,
ôô@ A
Longitud
öö  (
=
öö) *
Convert
öö+ 2
.
öö2 3
ToDouble
öö3 ;
(
öö; <
dr
öö< >
[
öö> ?
$str
öö? I
]
ööI J
)
ööJ K
,
ööK L
Diametro
õõ  (
=
õõ) *
Convert
õõ+ 2
.
õõ2 3
ToDouble
õõ3 ;
(
õõ; <
dr
õõ< >
[
õõ> ?
$str
õõ? I
]
õõI J
)
õõJ K
,
õõK L
PrecioVenta
úú  +
=
úú, -
Convert
úú. 5
.
úú5 6
ToDouble
úú6 >
(
úú> ?
dr
úú? A
[
úúA B
$str
úúB O
]
úúO P
)
úúP Q
,
úúQ R
Tipo
ùù  $
=
ùù% &
new
ùù' *
EntTipoProducto
ùù+ :
{
ûû  !
Nombre
üü$ *
=
üü+ ,
dr
üü- /
[
üü/ 0
$str
üü0 6
]
üü6 7
.
üü7 8
ToString
üü8 @
(
üü@ A
)
üüA B
}
††  !
}
°° 
,
°° 
}
¢¢ 
,
¢¢ 
Cantidad
££  
=
££! "
Convert
££# *
.
££* +
ToInt32
££+ 2
(
££2 3
dr
££3 5
[
££5 6
$str
££6 @
]
££@ A
)
££A B
,
££B C
Subtotal
§§  
=
§§! "
Convert
§§# *
.
§§* +
ToDouble
§§+ 3
(
§§3 4
dr
§§4 6
[
§§6 7
$str
§§7 A
]
§§A B
)
§§B C
}
•• 
;
•• 
list
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶ 
temp
¶¶ !
)
¶¶! "
;
¶¶" #
}
ßß 
}
©© 
catch
™™ 
(
™™ 
	Exception
™™ 
e
™™ 
)
™™ 
{
´´ 

MessageBox
¨¨ 
.
¨¨ 
Show
¨¨ 
(
¨¨  
e
¨¨  !
.
¨¨! "
Message
¨¨" )
)
¨¨) *
;
¨¨* +
}
≠≠ 
return
ÆÆ 
list
ÆÆ 
;
ÆÆ 
}
ØØ 	
public
≤≤ 
bool
≤≤ '
EliminarTemporaryProducts
≤≤ -
(
≤≤- .
int
≤≤. 1
idtemp
≤≤2 8
)
≤≤8 9
{
≥≥ 	

SqlCommand
¥¥ 
cmd
¥¥ 
=
¥¥ 
null
¥¥ !
;
¥¥! "
bool
µµ 
	eliminado
µµ 
=
µµ 
false
µµ "
;
µµ" #
try
∂∂ 
{
∑∑ 
SqlConnection
∏∏ 
cn
∏∏  
=
∏∏! "
Conexion
∏∏# +
.
∏∏+ ,
	Instancia
∏∏, 5
.
∏∏5 6
Conectar
∏∏6 >
(
∏∏> ?
)
∏∏? @
;
∏∏@ A
cmd
ππ 
=
ππ 
new
ππ 

SqlCommand
ππ $
(
ππ$ %
$str
ππ% B
,
ππB C
cn
ππD F
)
ππF G
;
ππG H
cmd
∫∫ 
.
∫∫ 
CommandType
∫∫ 
=
∫∫  !
CommandType
∫∫" -
.
∫∫- .
StoredProcedure
∫∫. =
;
∫∫= >
cmd
ªª 
.
ªª 

Parameters
ªª 
.
ªª 
AddWithValue
ªª +
(
ªª+ ,
$str
ªª, 2
,
ªª2 3
idtemp
ªª4 :
)
ªª: ;
;
ªª; <
cn
ºº 
.
ºº 
Open
ºº 
(
ºº 
)
ºº 
;
ºº 
int
ΩΩ 
i
ΩΩ 
=
ΩΩ 
cmd
ΩΩ 
.
ΩΩ 
ExecuteNonQuery
ΩΩ +
(
ΩΩ+ ,
)
ΩΩ, -
;
ΩΩ- .
if
ææ 
(
ææ 
i
ææ 
>
ææ 
$num
ææ 
)
ææ 
{
øø 
	eliminado
¿¿ 
=
¿¿ 
true
¿¿  $
;
¿¿$ %
}
¡¡ 
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
e
√√ 
)
√√ 
{
ƒƒ 

MessageBox
∆∆ 
.
∆∆ 
Show
∆∆ 
(
∆∆  
e
∆∆  !
.
∆∆! "
Message
∆∆" )
)
∆∆) *
;
∆∆* +
}
«« 
return
»» 
	eliminado
»» 
;
»» 
}
   	
public
ÃÃ 
bool
ÃÃ )
ActualizarTemporaryProducts
ÃÃ /
(
ÃÃ/ 0"
EntTemporaryProducts
ÃÃ0 D
temp
ÃÃE I
)
ÃÃI J
{
ÕÕ 	

SqlCommand
ŒŒ 
cmd
ŒŒ 
=
ŒŒ 
null
ŒŒ !
;
ŒŒ! "
bool
œœ 
actualizado
œœ 
=
œœ 
false
œœ $
;
œœ$ %
try
–– 
{
—— 
SqlConnection
““ 
cn
““  
=
““! "
Conexion
““# +
.
““+ ,
	Instancia
““, 5
.
““5 6
Conectar
““6 >
(
““> ?
)
““? @
;
““@ A
cmd
”” 
=
”” 
new
”” 

SqlCommand
”” $
(
””$ %
$str
””% @
,
””@ A
cn
””B D
)
””D E
{
‘‘ 
CommandType
’’ 
=
’’  !
CommandType
’’" -
.
’’- .
StoredProcedure
’’. =
}
÷÷ 
;
÷÷ 
cmd
◊◊ 
.
◊◊ 

Parameters
◊◊ 
.
◊◊ 
AddWithValue
◊◊ +
(
◊◊+ ,
$str
◊◊, 5
,
◊◊5 6
temp
◊◊7 ;
.
◊◊; <
IdTemp
◊◊< B
)
◊◊B C
;
◊◊C D
cmd
ÿÿ 
.
ÿÿ 

Parameters
ÿÿ 
.
ÿÿ 
AddWithValue
ÿÿ +
(
ÿÿ+ ,
$str
ÿÿ, 7
,
ÿÿ7 8
temp
ÿÿ9 =
.
ÿÿ= >
Cantidad
ÿÿ> F
)
ÿÿF G
;
ÿÿG H
cn
ŸŸ 
.
ŸŸ 
Open
ŸŸ 
(
ŸŸ 
)
ŸŸ 
;
ŸŸ 
int
⁄⁄ 
i
⁄⁄ 
=
⁄⁄ 
cmd
⁄⁄ 
.
⁄⁄ 
ExecuteNonQuery
⁄⁄ +
(
⁄⁄+ ,
)
⁄⁄, -
;
⁄⁄- .
if
€€ 
(
€€ 
i
€€ 
>
€€ 
$num
€€ 
)
€€ 
{
‹‹ 
actualizado
›› 
=
››  !
true
››" &
;
››& '
}
ﬁﬁ 
}
ﬂﬂ 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
e
‡‡ 
)
‡‡ 
{
·· 

MessageBox
„„ 
.
„„ 
Show
„„ 
(
„„  
e
„„  !
.
„„! "
Message
„„" )
)
„„) *
;
„„* +
}
‰‰ 
return
ÂÂ 
actualizado
ÂÂ 
;
ÂÂ 
}
ÊÊ 	
public
ËË "
EntTemporaryProducts
ËË #'
BuscarTemporaryProductsId
ËË$ =
(
ËË= >
int
ËË> A
id
ËËB D
)
ËËD E
{
ÈÈ 	

SqlCommand
ÍÍ 
cmd
ÍÍ 
=
ÍÍ 
null
ÍÍ !
;
ÍÍ! ""
EntTemporaryProducts
ÎÎ  
temp
ÎÎ! %
=
ÎÎ& '
new
ÎÎ( +"
EntTemporaryProducts
ÎÎ, @
(
ÎÎ@ A
)
ÎÎA B
;
ÎÎB C
try
ÏÏ 
{
ÌÌ 
SqlConnection
ÓÓ 
cn
ÓÓ  
=
ÓÓ! "
Conexion
ÓÓ# +
.
ÓÓ+ ,
	Instancia
ÓÓ, 5
.
ÓÓ5 6
Conectar
ÓÓ6 >
(
ÓÓ> ?
)
ÓÓ? @
;
ÓÓ@ A
cmd
ÔÔ 
=
ÔÔ 
new
ÔÔ 

SqlCommand
ÔÔ $
(
ÔÔ$ %
$str
ÔÔ% @
,
ÔÔ@ A
cn
ÔÔB D
)
ÔÔD E
{
 
CommandType
ÒÒ 
=
ÒÒ  !
CommandType
ÒÒ" -
.
ÒÒ- .
StoredProcedure
ÒÒ. =
}
ÚÚ 
;
ÚÚ 
cmd
ÛÛ 
.
ÛÛ 

Parameters
ÛÛ 
.
ÛÛ 
AddWithValue
ÛÛ +
(
ÛÛ+ ,
$str
ÛÛ, 5
,
ÛÛ5 6
id
ÛÛ7 9
)
ÛÛ9 :
;
ÛÛ: ;
cn
ÙÙ 
.
ÙÙ 
Open
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
SqlDataReader
ıı 
dr
ıı  
=
ıı! "
cmd
ıı# &
.
ıı& '
ExecuteReader
ıı' 4
(
ıı4 5
)
ıı5 6
;
ıı6 7
while
ˆˆ 
(
ˆˆ 
dr
ˆˆ 
.
ˆˆ 
Read
ˆˆ 
(
ˆˆ 
)
ˆˆ  
)
ˆˆ  !
{
˜˜ 
temp
¯¯ 
.
¯¯ 
IdTemp
¯¯ 
=
¯¯  !
Convert
¯¯" )
.
¯¯) *
ToInt32
¯¯* 1
(
¯¯1 2
dr
¯¯2 4
[
¯¯4 5
$str
¯¯5 =
]
¯¯= >
)
¯¯> ?
;
¯¯? @
temp
˘˘ 
.
˘˘ 
ProveedorProducto
˘˘ *
=
˘˘+ ,
new
˘˘- 0"
EntProveedorProducto
˘˘1 E
{
˙˙ 
	Proveedor
˚˚ !
=
˚˚" #
new
˚˚$ '
EntProveedor
˚˚( 4
{
¸¸ 
IdProveedor
˝˝ '
=
˝˝( )
Convert
˝˝* 1
.
˝˝1 2
ToInt32
˝˝2 9
(
˝˝9 :
dr
˝˝: <
[
˝˝< =
$str
˝˝= J
]
˝˝J K
)
˝˝K L
,
˝˝L M
RazonSocial
˛˛ '
=
˛˛( )
dr
˛˛* ,
[
˛˛, -
$str
˛˛- :
]
˛˛: ;
.
˛˛; <
ToString
˛˛< D
(
˛˛D E
)
˛˛E F
,
˛˛F G
Descripcion
ˇˇ '
=
ˇˇ( )
dr
ˇˇ* ,
[
ˇˇ, -
$str
ˇˇ- :
]
ˇˇ: ;
.
ˇˇ; <
ToString
ˇˇ< D
(
ˇˇD E
)
ˇˇE F
}
ÄÄ 
,
ÄÄ 
Producto
ÅÅ  
=
ÅÅ! "
new
ÅÅ# &
EntProducto
ÅÅ' 2
{
ÇÇ 
Nombre
ÉÉ "
=
ÉÉ# $
dr
ÉÉ% '
[
ÉÉ' (
$str
ÉÉ( 0
]
ÉÉ0 1
.
ÉÉ1 2
ToString
ÉÉ2 :
(
ÉÉ: ;
)
ÉÉ; <
,
ÉÉ< =
Longitud
ÑÑ $
=
ÑÑ% &
Convert
ÑÑ' .
.
ÑÑ. /
ToDouble
ÑÑ/ 7
(
ÑÑ7 8
dr
ÑÑ8 :
[
ÑÑ: ;
$str
ÑÑ; E
]
ÑÑE F
)
ÑÑF G
,
ÑÑG H
Diametro
ÖÖ $
=
ÖÖ% &
Convert
ÖÖ' .
.
ÖÖ. /
ToDouble
ÖÖ/ 7
(
ÖÖ7 8
dr
ÖÖ8 :
[
ÖÖ: ;
$str
ÖÖ; E
]
ÖÖE F
)
ÖÖF G
,
ÖÖG H
Tipo
ÜÜ  
=
ÜÜ! "
new
ÜÜ# &
EntTipoProducto
ÜÜ' 6
{
áá 
IdTipo_producto
àà  /
=
àà/ 0
Convert
àà1 8
.
àà8 9
ToInt32
àà9 @
(
àà@ A
dr
ààA C
[
ààC D
$str
ààD U
]
ààU V
)
ààV W
,
ààW X
Nombre
ââ  &
=
ââ' (
dr
ââ) +
[
ââ+ ,
$str
ââ, 2
]
ââ2 3
.
ââ3 4
ToString
ââ4 <
(
ââ< =
)
ââ= >
}
ää 
}
ãã 
,
ãã 
PrecioCompra
åå $
=
åå% &
Convert
åå' .
.
åå. /
ToDouble
åå/ 7
(
åå7 8
dr
åå8 :
[
åå: ;
$str
åå; I
]
ååI J
)
ååJ K
,
ååK L
}
èè 
;
èè 
temp
ëë 
.
ëë 
Cantidad
ëë !
=
ëë" #
Convert
ëë$ +
.
ëë+ ,
ToInt32
ëë, 3
(
ëë3 4
dr
ëë4 6
[
ëë6 7
$str
ëë7 A
]
ëëA B
)
ëëB C
;
ëëC D
temp
íí 
.
íí 
Subtotal
íí !
=
íí" #
Convert
íí$ +
.
íí+ ,
ToDouble
íí, 4
(
íí4 5
dr
íí5 7
[
íí7 8
$str
íí8 B
]
ííB C
)
ííC D
;
ííD E
}
îî 
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
e
óó 
)
óó 
{
òò 

MessageBox
ôô 
.
ôô 
Show
ôô 
(
ôô  
e
ôô  !
.
ôô! "
Message
ôô" )
)
ôô) *
;
ôô* +
}
öö 
return
úú 
temp
úú 
;
úú 
}
ùù 	
public
ûû "
EntTemporaryProducts
ûû #*
BuscarTemporaryProductsIdCli
ûû$ @
(
ûû@ A
int
ûûA D
id
ûûE G
)
ûûG H
{
üü 	

SqlCommand
†† 
cmd
†† 
=
†† 
null
†† !
;
††! ""
EntTemporaryProducts
°°  
temp
°°! %
=
°°& '
new
°°( +"
EntTemporaryProducts
°°, @
(
°°@ A
)
°°A B
;
°°B C
try
¢¢ 
{
££ 
SqlConnection
§§ 
cn
§§  
=
§§! "
Conexion
§§# +
.
§§+ ,
	Instancia
§§, 5
.
§§5 6
Conectar
§§6 >
(
§§> ?
)
§§? @
;
§§@ A
cmd
•• 
=
•• 
new
•• 

SqlCommand
•• $
(
••$ %
$str
••% C
,
••C D
cn
••E G
)
••G H
{
¶¶ 
CommandType
ßß 
=
ßß  !
CommandType
ßß" -
.
ßß- .
StoredProcedure
ßß. =
}
®® 
;
®® 
cmd
©© 
.
©© 

Parameters
©© 
.
©© 
AddWithValue
©© +
(
©©+ ,
$str
©©, 5
,
©©5 6
id
©©7 9
)
©©9 :
;
©©: ;
cn
™™ 
.
™™ 
Open
™™ 
(
™™ 
)
™™ 
;
™™ 
SqlDataReader
´´ 
dr
´´  
=
´´! "
cmd
´´# &
.
´´& '
ExecuteReader
´´' 4
(
´´4 5
)
´´5 6
;
´´6 7
while
¨¨ 
(
¨¨ 
dr
¨¨ 
.
¨¨ 
Read
¨¨ 
(
¨¨ 
)
¨¨  
)
¨¨  !
{
≠≠ 
temp
ÆÆ 
.
ÆÆ 
IdTemp
ÆÆ 
=
ÆÆ  !
Convert
ÆÆ" )
.
ÆÆ) *
ToInt32
ÆÆ* 1
(
ÆÆ1 2
dr
ÆÆ2 4
[
ÆÆ4 5
$str
ÆÆ5 =
]
ÆÆ= >
)
ÆÆ> ?
;
ÆÆ? @
temp
ØØ 
.
ØØ 
ProveedorProducto
ØØ *
=
ØØ+ ,
new
ØØ- 0"
EntProveedorProducto
ØØ1 E
{
∞∞ 
	Proveedor
±± !
=
±±" #
new
±±$ '
EntProveedor
±±( 4
{
≤≤ 
IdProveedor
≥≥ '
=
≥≥( )
Convert
≥≥* 1
.
≥≥1 2
ToInt32
≥≥2 9
(
≥≥9 :
dr
≥≥: <
[
≥≥< =
$str
≥≥= J
]
≥≥J K
)
≥≥K L
,
≥≥L M
RazonSocial
¥¥ '
=
¥¥( )
dr
¥¥* ,
[
¥¥, -
$str
¥¥- :
]
¥¥: ;
.
¥¥; <
ToString
¥¥< D
(
¥¥D E
)
¥¥E F
,
¥¥F G
Descripcion
µµ '
=
µµ( )
dr
µµ* ,
[
µµ, -
$str
µµ- :
]
µµ: ;
.
µµ; <
ToString
µµ< D
(
µµD E
)
µµE F
}
∂∂ 
,
∂∂ 
Producto
∑∑  
=
∑∑! "
new
∑∑# &
EntProducto
∑∑' 2
{
∏∏ 
Nombre
ππ "
=
ππ# $
dr
ππ% '
[
ππ' (
$str
ππ( 0
]
ππ0 1
.
ππ1 2
ToString
ππ2 :
(
ππ: ;
)
ππ; <
,
ππ< =
Longitud
∫∫ $
=
∫∫% &
Convert
∫∫' .
.
∫∫. /
ToDouble
∫∫/ 7
(
∫∫7 8
dr
∫∫8 :
[
∫∫: ;
$str
∫∫; E
]
∫∫E F
)
∫∫F G
,
∫∫G H
Diametro
ªª $
=
ªª% &
Convert
ªª' .
.
ªª. /
ToDouble
ªª/ 7
(
ªª7 8
dr
ªª8 :
[
ªª: ;
$str
ªª; E
]
ªªE F
)
ªªF G
,
ªªG H
Tipo
ºº  
=
ºº! "
new
ºº# &
EntTipoProducto
ºº' 6
{
ΩΩ 
IdTipo_producto
ææ  /
=
ææ0 1
Convert
ææ2 9
.
ææ9 :
ToInt32
ææ: A
(
ææA B
dr
ææB D
[
ææD E
$str
ææE V
]
ææV W
)
ææW X
,
ææX Y
Nombre
øø  &
=
øø' (
dr
øø) +
[
øø+ ,
$str
øø, 2
]
øø2 3
.
øø3 4
ToString
øø4 <
(
øø< =
)
øø= >
}
¿¿ 
}
¡¡ 
,
¡¡ 
PrecioCompra
¬¬ $
=
¬¬% &
Convert
¬¬' .
.
¬¬. /
ToDouble
¬¬/ 7
(
¬¬7 8
dr
¬¬8 :
[
¬¬: ;
$str
¬¬; I
]
¬¬I J
)
¬¬J K
,
¬¬K L
}
≈≈ 
;
≈≈ 
temp
«« 
.
«« 
Cantidad
«« !
=
««" #
Convert
««$ +
.
««+ ,
ToInt32
««, 3
(
««3 4
dr
««4 6
[
««6 7
$str
««7 A
]
««A B
)
««B C
;
««C D
temp
»» 
.
»» 
Subtotal
»» !
=
»»" #
Convert
»»$ +
.
»»+ ,
ToDouble
»», 4
(
»»4 5
dr
»»5 7
[
»»7 8
$str
»»8 B
]
»»B C
)
»»C D
;
»»D E
}
   
}
ÃÃ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
e
ÕÕ 
)
ÕÕ 
{
ŒŒ 

MessageBox
œœ 
.
œœ 
Show
œœ 
(
œœ  
e
œœ  !
.
œœ! "
Message
œœ" )
)
œœ) *
;
œœ* +
}
–– 
return
““ 
temp
““ 
;
““ 
}
”” 	
}
‘‘ 
<<<<<<< HEAD
}÷÷ ¿Ω
MD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatUsuario.cs
=======
}÷÷ ŒΩ
[C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatUsuario.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 

DatUsuario 
: 
IDatUsuario (
{ 
public 
bool 
CrearCliente  
(  !

EntUsuario! +
Cli, /
)/ 0
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 5
,5 6
cn7 9
)9 :
;: ;
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
Cli< ?
.? @
RazonSocial@ K
)K L
;L M
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
Cli7 :
.: ;
Correo; A
)A B
;B C
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Cli9 <
.< =
UserName= E
)E F
;F G
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 3
,3 4
Cli5 8
.8 9
Pass9 =
)= >
;> ?
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
Cli6 9
.9 :
Roll: >
.> ?
IdRoll? E
)E F
;F G
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 7
,  7 8
Cli  9 <
.  < =
Ubigeo  = C
.  C D
IdUbigeo  D L
)  L M
;  M N
cn!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
int"" 
i"" 
="" 
cmd"" 
."" 
ExecuteNonQuery"" +
(""+ ,
)"", -
;""- .
if## 
(## 
i## 
>## 
$num## 
)## 
creado$$ 
=$$ 
true$$ !
;$$! "
}%% 
catch&& 
(&& 
	Exception&& 
e&& 
)&& 
{'' 
throw(( 
new(( 
	Exception(( #
(((# $
e(($ %
.((% &
Message((& -
)((- .
;((. /
})) 
return** 
creado** 
;** 
}++ 	
public,, 
List,, 
<,, 

EntUsuario,, 
>,, 
ListarCliente,,  -
(,,- .
),,. /
{-- 	

SqlCommand.. 
cmd.. 
=.. 
null.. !
;..! "
List// 
<// 

EntUsuario// 
>// 
lista// "
=//# $
new//% (
List//) -
<//- .

EntUsuario//. 8
>//8 9
(//9 :
)//: ;
;//; <
try00 
{11 
SqlConnection22 
cn22  
=22! "
Conexion22# +
.22+ ,
	Instancia22, 5
.225 6
Conectar226 >
(22> ?
)22? @
;22@ A
cmd33 
=33 
new33 

SqlCommand33 $
(33$ %
$str33% 7
,337 8
cn339 ;
)33; <
;33< =
cmd44 
.44 
CommandType44 
=44  !
CommandType44" -
.44- .
StoredProcedure44. =
;44= >
cn55 
.55 
Open55 
(55 
)55 
;55 
SqlDataReader66 
dr66  
=66! "
cmd66# &
.66& '
ExecuteReader66' 4
(664 5
)665 6
;666 7
while77 
(77 
dr77 
.77 
Read77 
(77 
)77  
)77  !
{88 

EntUsuario99 
Cli99 "
=99# $
new99% (

EntUsuario99) 3
{:: 
	IdUsuario;; !
=;;" #
Convert;;$ +
.;;+ ,
ToInt32;;, 3
(;;3 4
dr;;4 6
[;;6 7
$str;;7 B
];;B C
);;C D
,;;D E
RazonSocial<< #
=<<$ %
dr<<& (
[<<( )
$str<<) 6
]<<6 7
.<<7 8
ToString<<8 @
(<<@ A
)<<A B
,<<B C
Telefono==  
===! "
dr==# %
[==% &
$str==& 0
]==0 1
.==1 2
ToString==2 :
(==: ;
)==; <
,==< =
	Direccion>> !
=>>" #
dr>>$ &
[>>& '
$str>>' 2
]>>2 3
.>>3 4
ToString>>4 <
(>>< =
)>>= >
,>>> ?
Correo?? 
=??  
dr??! #
[??# $
$str??$ ,
]??, -
.??- .
ToString??. 6
(??6 7
)??7 8
,??8 9
UserName@@  
=@@! "
dr@@# %
[@@% &
$str@@& 0
]@@0 1
.@@1 2
ToString@@2 :
(@@: ;
)@@; <
,@@< =
PassAA 
=AA 
drAA !
[AA! "
$strAA" (
]AA( )
.AA) *
ToStringAA* 2
(AA2 3
)AA3 4
,AA4 5
ActivoBB 
=BB  
ConvertBB! (
.BB( )
	ToBooleanBB) 2
(BB2 3
drBB3 5
[BB5 6
$strBB6 >
]BB> ?
)BB? @
}CC 
;CC 
	EntUbigeoDD 
uDD 
=DD  !
newDD" %
	EntUbigeoDD& /
{EE 
	ProvinciaFF !
=FF" #
drFF$ &
[FF& '
$strFF' 2
]FF2 3
.FF3 4
ToStringFF4 <
(FF< =
)FF= >
,FF> ?
}GG 
;GG 
listaJJ 
.JJ 
AddJJ 
(JJ 
CliJJ !
)JJ! "
;JJ" #
}KK 
}MM 
catchNN 
(NN 
	ExceptionNN 
eNN 
)NN 
{OO 

MessageBoxPP 
.PP 
ShowPP 
(PP  
ePP  !
.PP! "
MessagePP" )
,PP) *
$strPP+ F
,PPF G
MessageBoxButtonsPPH Y
.PPY Z
OKPPZ \
,PP\ ]
MessageBoxIconPP^ l
.PPl m
ErrorPPm r
)PPr s
;PPs t
}RR 
returnTT 
listaTT 
;TT 
}UU 	
publicWW 
ListWW 
<WW 

EntUsuarioWW 
>WW 
BuscarClienteWW  -
(WW- .
stringWW. 4
busquedaWW5 =
)WW= >
{XX 	
ListYY 
<YY 

EntUsuarioYY 
>YY 
listaYY "
=YY# $
newYY% (
ListYY) -
<YY- .

EntUsuarioYY. 8
>YY8 9
(YY9 :
)YY: ;
;YY; <

SqlCommandZZ 
cmdZZ 
=ZZ 
nullZZ !
;ZZ! "
try[[ 
{\\ 
SqlConnection]] 
cn]]  
=]]! "
Conexion]]# +
.]]+ ,
	Instancia]], 5
.]]5 6
Conectar]]6 >
(]]> ?
)]]? @
;]]@ A
cmd^^ 
=^^ 
new^^ 

SqlCommand^^ $
(^^$ %
$str^^% 7
,^^7 8
cn^^9 ;
)^^; <
;^^< =
cmd__ 
.__ 
CommandType__ 
=__  !
CommandType__" -
.__- .
StoredProcedure__. =
;__= >
cmd`` 
.`` 

Parameters`` 
.`` 
AddWithValue`` +
(``+ ,
$str``, 4
,``4 5
busqueda``6 >
)``> ?
;``? @
cnaa 
.aa 
Openaa 
(aa 
)aa 
;aa 
SqlDataReaderbb 
drbb  
=bb! "
cmdbb# &
.bb& '
ExecuteReaderbb' 4
(bb4 5
)bb5 6
;bb6 7
whilecc 
(cc 
drcc 
.cc 
Readcc 
(cc 
)cc  
)cc  !
{dd 

EntUsuarioee 
Cliee "
=ee# $
newee% (

EntUsuarioee) 3
{ff 
	IdUsuariogg !
=gg" #
Convertgg$ +
.gg+ ,
ToInt32gg, 3
(gg3 4
drgg4 6
[gg6 7
$strgg7 B
]ggB C
)ggC D
,ggD E
RazonSocialhh #
=hh$ %
drhh& (
[hh( )
$strhh) 6
]hh6 7
.hh7 8
ToStringhh8 @
(hh@ A
)hhA B
,hhB C
Telefonoii  
=ii! "
drii# %
[ii% &
$strii& 0
]ii0 1
.ii1 2
ToStringii2 :
(ii: ;
)ii; <
,ii< =
	Direccionjj !
=jj" #
drjj$ &
[jj& '
$strjj' 2
]jj2 3
.jj3 4
ToStringjj4 <
(jj< =
)jj= >
,jj> ?
Correokk 
=kk  
drkk! #
[kk# $
$strkk$ ,
]kk, -
.kk- .
ToStringkk. 6
(kk6 7
)kk7 8
,kk8 9
UserNamell  
=ll! "
drll# %
[ll% &
$strll& 0
]ll0 1
.ll1 2
ToStringll2 :
(ll: ;
)ll; <
,ll< =
Passmm 
=mm 
drmm !
[mm! "
$strmm" (
]mm( )
.mm) *
ToStringmm* 2
(mm2 3
)mm3 4
,mm4 5
Activonn 
=nn  
Convertnn! (
.nn( )
	ToBooleannn) 2
(nn2 3
drnn3 5
[nn5 6
$strnn6 >
]nn> ?
)nn? @
}oo 
;oo 
	EntUbigeopp 
upp 
=pp  !
newpp" %
	EntUbigeopp& /
{qq 
	Provinciarr !
=rr" #
drrr$ &
[rr& '
$strrr' 2
]rr2 3
.rr3 4
ToStringrr4 <
(rr< =
)rr= >
,rr> ?
}ss 
;ss 
Clitt 
.tt 
Ubigeott 
=tt  
utt! "
;tt" #
listauu 
.uu 
Adduu 
(uu 
Cliuu !
)uu! "
;uu" #
}vv 
}ww 
catchxx 
(xx 
	Exceptionxx 
exx 
)xx 
{yy 

MessageBox{{ 
.{{ 
Show{{ 
({{  
e{{  !
.{{! "
Message{{" )
,{{) *
$str{{+ c
,{{c d
MessageBoxButtons{{e v
.{{v w
OK{{w y
,{{y z
MessageBoxIcon	{{{ â
.
{{â ä
Error
{{ä è
)
{{è ê
;
{{ê ë
}|| 
return~~ 
lista~~ 
;~~ 
} 	
public
ÅÅ 
bool
ÅÅ 
EditarCliente
ÅÅ !
(
ÅÅ! "

EntUsuario
ÅÅ" ,
u
ÅÅ- .
)
ÅÅ. /
{
ÇÇ 	

SqlCommand
ÉÉ 
cmd
ÉÉ 
=
ÉÉ 
null
ÉÉ !
;
ÉÉ! "
bool
ÑÑ 
	actualiza
ÑÑ 
=
ÑÑ 
false
ÑÑ "
;
ÑÑ" #
try
ÖÖ 
{
ÜÜ 
SqlConnection
áá 
cn
áá  
=
áá! "
Conexion
áá# +
.
áá+ ,
	Instancia
áá, 5
.
áá5 6
Conectar
áá6 >
(
áá> ?
)
áá? @
;
áá@ A
cmd
àà 
=
àà 
new
àà 

SqlCommand
àà $
(
àà$ %
$str
àà% :
,
àà: ;
cn
àà< >
)
àà> ?
;
àà? @
cmd
ââ 
.
ââ 
CommandType
ââ 
=
ââ  !
CommandType
ââ" -
.
ââ- .
StoredProcedure
ââ. =
;
ââ= >
cmd
ää 
.
ää 

Parameters
ää 
.
ää 
AddWithValue
ää +
(
ää+ ,
$str
ää, 8
,
ää8 9
u
ää: ;
.
ää; <
	IdUsuario
ää< E
)
ääE F
;
ääF G
cmd
ãã 
.
ãã 

Parameters
ãã 
.
ãã 
AddWithValue
ãã +
(
ãã+ ,
$str
ãã, :
,
ãã: ;
u
ãã< =
.
ãã= >
RazonSocial
ãã> I
)
ããI J
;
ããJ K
cmd
åå 
.
åå 

Parameters
åå 
.
åå 
AddWithValue
åå +
(
åå+ ,
$str
åå, 7
,
åå7 8
u
åå9 :
.
åå: ;
UserName
åå; C
)
ååC D
;
ååD E
cmd
çç 
.
çç 

Parameters
çç 
.
çç 
AddWithValue
çç +
(
çç+ ,
$str
çç, 5
,
çç5 6
u
çç7 8
.
çç8 9
Activo
çç9 ?
)
çç? @
;
çç@ A
cn
éé 
.
éé 
Open
éé 
(
éé 
)
éé 
;
éé 
int
èè 
i
èè 
=
èè 
cmd
èè 
.
èè 
ExecuteNonQuery
èè +
(
èè+ ,
)
èè, -
;
èè- .
if
êê 
(
êê 
i
êê 
>
êê 
$num
êê 
)
êê 
{
ëë 
	actualiza
íí 
=
íí 
true
íí  $
;
íí$ %
}
ìì 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
e
ïï 
)
ïï 
{
ññ 

MessageBox
óó 
.
óó 
Show
óó 
(
óó  
e
óó  !
.
óó! "
Message
óó" )
)
óó) *
;
óó* +
}
òò 
return
öö 
	actualiza
öö 
;
öö 
}
úú 	
public
üü 
List
üü 
<
üü 

EntUsuario
üü 
>
üü #
ListarAdministradores
üü  5
(
üü5 6
)
üü6 7
{
†† 	

SqlCommand
°° 
cmd
°° 
=
°° 
null
°° !
;
°°! "
List
¢¢ 
<
¢¢ 

EntUsuario
¢¢ 
>
¢¢ 
lista
¢¢ "
=
¢¢# $
new
¢¢% (
List
¢¢) -
<
¢¢- .

EntUsuario
¢¢. 8
>
¢¢8 9
(
¢¢9 :
)
¢¢: ;
;
¢¢; <
try
££ 
{
§§ 
SqlConnection
•• 
cn
••  
=
••! "
Conexion
••# +
.
••+ ,
	Instancia
••, 5
.
••5 6
Conectar
••6 >
(
••> ?
)
••? @
;
••@ A
cmd
¶¶ 
=
¶¶ 
new
¶¶ 

SqlCommand
¶¶ $
(
¶¶$ %
$str
¶¶% >
,
¶¶> ?
cn
¶¶@ B
)
¶¶B C
;
¶¶C D
cmd
ßß 
.
ßß 
CommandType
ßß 
=
ßß  !
CommandType
ßß" -
.
ßß- .
StoredProcedure
ßß. =
;
ßß= >
cn
®® 
.
®® 
Open
®® 
(
®® 
)
®® 
;
®® 
SqlDataReader
©© 
dr
©©  
=
©©! "
cmd
©©# &
.
©©& '
ExecuteReader
©©' 4
(
©©4 5
)
©©5 6
;
©©6 7
while
™™ 
(
™™ 
dr
™™ 
.
™™ 
Read
™™ 
(
™™ 
)
™™  
)
™™  !
{
´´ 

EntUsuario
¨¨ 
Cli
¨¨ "
=
¨¨# $
new
¨¨% (

EntUsuario
¨¨) 3
{
≠≠ 
	IdUsuario
ÆÆ !
=
ÆÆ" #
Convert
ÆÆ$ +
.
ÆÆ+ ,
ToInt32
ÆÆ, 3
(
ÆÆ3 4
dr
ÆÆ4 6
[
ÆÆ6 7
$str
ÆÆ7 B
]
ÆÆB C
)
ÆÆC D
,
ÆÆD E
RazonSocial
ØØ #
=
ØØ$ %
dr
ØØ& (
[
ØØ( )
$str
ØØ) 6
]
ØØ6 7
.
ØØ7 8
ToString
ØØ8 @
(
ØØ@ A
)
ØØA B
,
ØØB C
Telefono
∞∞  
=
∞∞! "
dr
∞∞# %
[
∞∞% &
$str
∞∞& 0
]
∞∞0 1
.
∞∞1 2
ToString
∞∞2 :
(
∞∞: ;
)
∞∞; <
,
∞∞< =
	Direccion
±± !
=
±±" #
dr
±±$ &
[
±±& '
$str
±±' 2
]
±±2 3
.
±±3 4
ToString
±±4 <
(
±±< =
)
±±= >
,
±±> ?
Correo
≤≤ 
=
≤≤  
dr
≤≤! #
[
≤≤# $
$str
≤≤$ ,
]
≤≤, -
.
≤≤- .
ToString
≤≤. 6
(
≤≤6 7
)
≤≤7 8
,
≤≤8 9
UserName
≥≥  
=
≥≥! "
dr
≥≥# %
[
≥≥% &
$str
≥≥& 0
]
≥≥0 1
.
≥≥1 2
ToString
≥≥2 :
(
≥≥: ;
)
≥≥; <
,
≥≥< =
Pass
¥¥ 
=
¥¥ 
dr
¥¥ !
[
¥¥! "
$str
¥¥" (
]
¥¥( )
.
¥¥) *
ToString
¥¥* 2
(
¥¥2 3
)
¥¥3 4
,
¥¥4 5
Activo
µµ 
=
µµ  
Convert
µµ! (
.
µµ( )
	ToBoolean
µµ) 2
(
µµ2 3
dr
µµ3 5
[
µµ5 6
$str
µµ6 >
]
µµ> ?
)
µµ? @
}
∂∂ 
;
∂∂ 
	EntUbigeo
∑∑ 
u
∑∑ 
=
∑∑  !
new
∑∑" %
	EntUbigeo
∑∑& /
{
∏∏ 
	Provincia
ππ !
=
ππ" #
dr
ππ$ &
[
ππ& '
$str
ππ' 2
]
ππ2 3
.
ππ3 4
ToString
ππ4 <
(
ππ< =
)
ππ= >
,
ππ> ?
}
∫∫ 
;
∫∫ 
Cli
ºº 
.
ºº 
Ubigeo
ºº 
=
ºº  
u
ºº! "
;
ºº" #
lista
ΩΩ 
.
ΩΩ 
Add
ΩΩ 
(
ΩΩ 
Cli
ΩΩ !
)
ΩΩ! "
;
ΩΩ" #
}
ææ 
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
e
¡¡ 
)
¡¡ 
{
¬¬ 

MessageBox
√√ 
.
√√ 
Show
√√ 
(
√√  
e
√√  !
.
√√! "
Message
√√" )
,
√√) *
$str
√√+ F
,
√√F G
MessageBoxButtons
√√H Y
.
√√Y Z
OK
√√Z \
,
√√\ ]
MessageBoxIcon
√√^ l
.
√√l m
Error
√√m r
)
√√r s
;
√√s t
}
≈≈ 
return
«« 
lista
«« 
;
«« 
}
»» 	
public
   
bool
   %
ActualizarAdministrador
   +
(
  + ,

EntUsuario
  , 6
ad
  7 9
)
  9 :
{
ÀÀ 	

SqlCommand
ÃÃ 
cmd
ÃÃ 
=
ÃÃ 
null
ÃÃ !
;
ÃÃ! "
bool
ÕÕ 
actualizado
ÕÕ 
=
ÕÕ 
false
ÕÕ $
;
ÕÕ$ %
try
ŒŒ 
{
œœ 
SqlConnection
–– 
cn
––  
=
––! "
Conexion
––# +
.
––+ ,
	Instancia
––, 5
.
––5 6
Conectar
––6 >
(
––> ?
)
––? @
;
––@ A
cmd
—— 
=
—— 
new
—— 

SqlCommand
—— $
(
——$ %
$str
——% @
,
——@ A
cn
——B D
)
——D E
;
——E F
cmd
““ 
.
““ 
CommandType
““ 
=
““  !
CommandType
““" -
.
““- .
StoredProcedure
““. =
;
““= >
cmd
”” 
.
”” 

Parameters
”” 
.
”” 
AddWithValue
”” +
(
””+ ,
$str
””, 8
,
””8 9
ad
””: <
.
””< =
	IdUsuario
””= F
)
””F G
;
””G H
cmd
‘‘ 
.
‘‘ 

Parameters
‘‘ 
.
‘‘ 
AddWithValue
‘‘ +
(
‘‘+ ,
$str
‘‘, :
,
‘‘: ;
ad
‘‘< >
.
‘‘> ?
RazonSocial
‘‘? J
)
‘‘J K
;
‘‘K L
cmd
’’ 
.
’’ 

Parameters
’’ 
.
’’ 
AddWithValue
’’ +
(
’’+ ,
$str
’’, 7
,
’’7 8
ad
’’9 ;
.
’’; <
UserName
’’< D
)
’’D E
;
’’E F
cmd
÷÷ 
.
÷÷ 

Parameters
÷÷ 
.
÷÷ 
AddWithValue
÷÷ +
(
÷÷+ ,
$str
÷÷, 7
,
÷÷7 8
ad
÷÷9 ;
.
÷÷; <
Telefono
÷÷< D
)
÷÷D E
;
÷÷E F
cmd
◊◊ 
.
◊◊ 

Parameters
◊◊ 
.
◊◊ 
AddWithValue
◊◊ +
(
◊◊+ ,
$str
◊◊, 8
,
◊◊8 9
ad
◊◊: <
.
◊◊< =
	Direccion
◊◊= F
)
◊◊F G
;
◊◊G H
cmd
ÿÿ 
.
ÿÿ 

Parameters
ÿÿ 
.
ÿÿ 
AddWithValue
ÿÿ +
(
ÿÿ+ ,
$str
ÿÿ, 5
,
ÿÿ5 6
ad
ÿÿ7 9
.
ÿÿ9 :
Activo
ÿÿ: @
)
ÿÿ@ A
;
ÿÿA B
cmd
ŸŸ 
.
ŸŸ 

Parameters
ŸŸ 
.
ŸŸ 
AddWithValue
ŸŸ +
(
ŸŸ+ ,
$str
ŸŸ, 7
,
ŸŸ7 8
ad
ŸŸ9 ;
.
ŸŸ; <
Ubigeo
ŸŸ< B
.
ŸŸB C
IdUbigeo
ŸŸC K
)
ŸŸK L
;
ŸŸL M
cn
⁄⁄ 
.
⁄⁄ 
Open
⁄⁄ 
(
⁄⁄ 
)
⁄⁄ 
;
⁄⁄ 
int
€€ 
i
€€ 
=
€€ 
cmd
€€ 
.
€€ 
ExecuteNonQuery
€€ +
(
€€+ ,
)
€€, -
;
€€- .
if
‹‹ 
(
‹‹ 
i
‹‹ 
>
‹‹ 
$num
‹‹ 
)
‹‹ 
{
›› 
actualizado
ﬁﬁ 
=
ﬁﬁ  !
true
ﬁﬁ" &
;
ﬁﬁ& '
}
ﬂﬂ 
}
‡‡ 
catch
·· 
(
·· 
	Exception
·· 
e
·· 
)
·· 
{
‚‚ 

MessageBox
‰‰ 
.
‰‰ 
Show
‰‰ 
(
‰‰  
e
‰‰  !
.
‰‰! "
Message
‰‰" )
)
‰‰) *
;
‰‰* +
}
ÂÂ 
return
ÁÁ 
actualizado
ÁÁ 
;
ÁÁ 
}
ËË 	
public
ÍÍ 
List
ÍÍ 
<
ÍÍ 

EntUsuario
ÍÍ 
>
ÍÍ $
BuscaraAdministradores
ÍÍ  6
(
ÍÍ6 7
string
ÍÍ7 =
busqueda
ÍÍ> F
)
ÍÍF G
{
ÎÎ 	
List
ÏÏ 
<
ÏÏ 

EntUsuario
ÏÏ 
>
ÏÏ 
lista
ÏÏ "
=
ÏÏ# $
new
ÏÏ% (
List
ÏÏ) -
<
ÏÏ- .

EntUsuario
ÏÏ. 8
>
ÏÏ8 9
(
ÏÏ9 :
)
ÏÏ: ;
;
ÏÏ; <

SqlCommand
ÌÌ 
cmd
ÌÌ 
=
ÌÌ 
null
ÌÌ !
;
ÌÌ! "
try
ÓÓ 
{
ÔÔ 
SqlConnection
 
cn
  
=
! "
Conexion
# +
.
+ ,
	Instancia
, 5
.
5 6
Conectar
6 >
(
> ?
)
? @
;
@ A
cmd
ÒÒ 
=
ÒÒ 
new
ÒÒ 

SqlCommand
ÒÒ $
(
ÒÒ$ %
$str
ÒÒ% >
,
ÒÒ> ?
cn
ÒÒ@ B
)
ÒÒB C
;
ÒÒC D
cmd
ÚÚ 
.
ÚÚ 
CommandType
ÚÚ 
=
ÚÚ  !
CommandType
ÚÚ" -
.
ÚÚ- .
StoredProcedure
ÚÚ. =
;
ÚÚ= >
cmd
ÛÛ 
.
ÛÛ 

Parameters
ÛÛ 
.
ÛÛ 
AddWithValue
ÛÛ +
(
ÛÛ+ ,
$str
ÛÛ, 4
,
ÛÛ4 5
busqueda
ÛÛ6 >
)
ÛÛ> ?
;
ÛÛ? @
cn
ÙÙ 
.
ÙÙ 
Open
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
SqlDataReader
ıı 
dr
ıı  
=
ıı! "
cmd
ıı# &
.
ıı& '
ExecuteReader
ıı' 4
(
ıı4 5
)
ıı5 6
;
ıı6 7
while
ˆˆ 
(
ˆˆ 
dr
ˆˆ 
.
ˆˆ 
Read
ˆˆ 
(
ˆˆ 
)
ˆˆ  
)
ˆˆ  !
{
˜˜ 

EntUsuario
¯¯ 
Cli
¯¯ "
=
¯¯# $
new
¯¯% (

EntUsuario
¯¯) 3
{
˘˘ 
	IdUsuario
˙˙ !
=
˙˙" #
Convert
˙˙$ +
.
˙˙+ ,
ToInt32
˙˙, 3
(
˙˙3 4
dr
˙˙4 6
[
˙˙6 7
$str
˙˙7 B
]
˙˙B C
)
˙˙C D
,
˙˙D E
RazonSocial
˚˚ #
=
˚˚$ %
dr
˚˚& (
[
˚˚( )
$str
˚˚) 6
]
˚˚6 7
.
˚˚7 8
ToString
˚˚8 @
(
˚˚@ A
)
˚˚A B
,
˚˚B C
Telefono
¸¸  
=
¸¸! "
dr
¸¸# %
[
¸¸% &
$str
¸¸& 0
]
¸¸0 1
.
¸¸1 2
ToString
¸¸2 :
(
¸¸: ;
)
¸¸; <
,
¸¸< =
	Direccion
˝˝ !
=
˝˝" #
dr
˝˝$ &
[
˝˝& '
$str
˝˝' 2
]
˝˝2 3
.
˝˝3 4
ToString
˝˝4 <
(
˝˝< =
)
˝˝= >
,
˝˝> ?
Correo
˛˛ 
=
˛˛  
dr
˛˛! #
[
˛˛# $
$str
˛˛$ ,
]
˛˛, -
.
˛˛- .
ToString
˛˛. 6
(
˛˛6 7
)
˛˛7 8
,
˛˛8 9
UserName
ˇˇ  
=
ˇˇ! "
dr
ˇˇ# %
[
ˇˇ% &
$str
ˇˇ& 0
]
ˇˇ0 1
.
ˇˇ1 2
ToString
ˇˇ2 :
(
ˇˇ: ;
)
ˇˇ; <
,
ˇˇ< =
Pass
ÄÄ 
=
ÄÄ 
dr
ÄÄ !
[
ÄÄ! "
$str
ÄÄ" (
]
ÄÄ( )
.
ÄÄ) *
ToString
ÄÄ* 2
(
ÄÄ2 3
)
ÄÄ3 4
,
ÄÄ4 5
Activo
ÅÅ 
=
ÅÅ  
Convert
ÅÅ! (
.
ÅÅ( )
	ToBoolean
ÅÅ) 2
(
ÅÅ2 3
dr
ÅÅ3 5
[
ÅÅ5 6
$str
ÅÅ6 >
]
ÅÅ> ?
)
ÅÅ? @
}
ÇÇ 
;
ÇÇ 
	EntUbigeo
ÉÉ 
u
ÉÉ 
=
ÉÉ  !
new
ÉÉ" %
	EntUbigeo
ÉÉ& /
{
ÑÑ 
	Provincia
ÖÖ !
=
ÖÖ" #
dr
ÖÖ$ &
[
ÖÖ& '
$str
ÖÖ' 2
]
ÖÖ2 3
.
ÖÖ3 4
ToString
ÖÖ4 <
(
ÖÖ< =
)
ÖÖ= >
,
ÖÖ> ?
}
ÜÜ 
;
ÜÜ 
Cli
áá 
.
áá 
Ubigeo
áá 
=
áá  
u
áá! "
;
áá" #
lista
àà 
.
àà 
Add
àà 
(
àà 
Cli
àà !
)
àà! "
;
àà" #
}
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
e
ãã 
)
ãã 
{
åå 

MessageBox
éé 
.
éé 
Show
éé 
(
éé  
e
éé  !
.
éé! "
Message
éé" )
,
éé) *
$str
éé+ c
,
ééc d
MessageBoxButtons
éée v
.
éév w
OK
ééw y
,
ééy z
MessageBoxIconéé{ â
.ééâ ä
Errorééä è
)ééè ê
;ééê ë
}
èè 
return
ëë 
lista
ëë 
;
ëë 
}
íí 	
public
ïï 

EntUsuario
ïï 
IniciarSesion
ïï '
(
ïï' (
string
ïï( .
campo
ïï/ 4
,
ïï4 5
string
ïï6 <
contra
ïï= C
)
ïïC D
{
ññ 	

SqlCommand
óó 
cmd
óó 
=
óó 
null
óó !
;
óó! "

EntUsuario
òò 
c
òò 
=
òò 
null
òò 
;
òò  
try
ôô 
{
öö 
SqlConnection
õõ 
cn
õõ  
=
õõ! "
Conexion
õõ# +
.
õõ+ ,
	Instancia
õõ, 5
.
õõ5 6
Conectar
õõ6 >
(
õõ> ?
)
õõ? @
;
õõ@ A
cmd
úú 
=
úú 
new
úú 

SqlCommand
úú $
(
úú$ %
$str
úú% 6
,
úú6 7
cn
úú8 :
)
úú: ;
;
úú; <
cmd
ùù 
.
ùù 
CommandType
ùù 
=
ùù  !
CommandType
ùù" -
.
ùù- .
StoredProcedure
ùù. =
;
ùù= >
cmd
ûû 
.
ûû 

Parameters
ûû 
.
ûû 
AddWithValue
ûû +
(
ûû+ ,
$str
ûû, 3
,
ûû3 4
campo
ûû5 :
)
ûû: ;
;
ûû; <
cmd
üü 
.
üü 

Parameters
üü 
.
üü 
AddWithValue
üü +
(
üü+ ,
$str
üü, 5
,
üü5 6
encrypt
üü7 >
.
üü> ?
	GetSHA256
üü? H
(
üüH I
contra
üüI O
)
üüO P
)
üüP Q
;
üüQ R
cn
†† 
.
†† 
Open
†† 
(
†† 
)
†† 
;
†† 
using
°° 
(
°° 
SqlDataReader
°° $
dr
°°% '
=
°°( )
cmd
°°* -
.
°°- .
ExecuteReader
°°. ;
(
°°; <
)
°°< =
)
°°= >
{
¢¢ 
if
££ 
(
££ 
dr
££ 
.
££ 
Read
££ 
(
££  
)
££  !
)
££! "
{
§§ 
c
•• 
=
•• 
new
•• 

EntUsuario
••  *
{
¶¶ 
	IdUsuario
ßß %
=
ßß& '
Convert
ßß( /
.
ßß/ 0
ToInt16
ßß0 7
(
ßß7 8
dr
ßß8 :
[
ßß: ;
$str
ßß; F
]
ßßF G
)
ßßG H
,
ßßH I
RazonSocial
®® '
=
®®( )
dr
®®* ,
[
®®, -
$str
®®- :
]
®®: ;
.
®®; <
ToString
®®< D
(
®®D E
)
®®E F
,
®®F G
UserName
©© $
=
©©% &
dr
©©' )
[
©©) *
$str
©©* 4
]
©©4 5
.
©©5 6
ToString
©©6 >
(
©©> ?
)
©©? @
,
©©@ A
Correo
™™ "
=
™™# $
dr
™™% '
[
™™' (
$str
™™( 0
]
™™0 1
.
™™1 2
ToString
™™2 :
(
™™: ;
)
™™; <
,
™™< =
Telefono
´´ $
=
´´% &
dr
´´' )
[
´´) *
$str
´´* 4
]
´´4 5
.
´´5 6
ToString
´´6 >
(
´´> ?
)
´´? @
,
´´@ A
	Direccion
¨¨ %
=
¨¨& '
dr
¨¨( *
[
¨¨* +
$str
¨¨+ 6
]
¨¨6 7
.
¨¨7 8
ToString
¨¨8 @
(
¨¨@ A
)
¨¨A B
,
¨¨B C
Rol
≠≠ 
=
≠≠  !
(
≠≠" #
entRol
≠≠# )
)
≠≠) *
dr
≠≠* ,
[
≠≠, -
$str
≠≠- 4
]
≠≠4 5
,
≠≠5 6
Activo
ÆÆ "
=
ÆÆ# $
Convert
ÆÆ% ,
.
ÆÆ, -
	ToBoolean
ÆÆ- 6
(
ÆÆ6 7
dr
ÆÆ7 9
[
ÆÆ9 :
$str
ÆÆ: B
]
ÆÆB C
)
ÆÆC D
,
ÆÆD E
}
ØØ 
;
ØØ 
	EntUbigeo
∞∞ !
ubigeo
∞∞" (
=
∞∞) *
new
∞∞+ .
	EntUbigeo
∞∞/ 8
{
±± 
Distrito
≤≤ $
=
≤≤% &
dr
≤≤' )
[
≤≤) *
$str
≤≤* 4
]
≤≤4 5
.
≤≤5 6
ToString
≤≤6 >
(
≤≤> ?
)
≤≤? @
}
≥≥ 
;
≥≥ 
c
¥¥ 
.
¥¥ 
Ubigeo
¥¥  
=
¥¥! "
ubigeo
¥¥# )
;
¥¥) *
}
µµ 
}
∂∂ 
}
∑∑ 
catch
∏∏ 
(
∏∏ 
	Exception
∏∏ 
ex
∏∏ 
)
∏∏ 
{
ππ 
throw
∫∫ 
new
∫∫ 
	Exception
∫∫ "
(
∫∫" #
$str
∫∫# =
+
∫∫= >
ex
∫∫> @
.
∫∫@ A
Message
∫∫A H
)
∫∫H I
;
∫∫I J
}
ªª 
return
ΩΩ 
c
ΩΩ 
;
ΩΩ 
}
ææ 	
public
¿¿ 
bool
¿¿ 
EliminarUsuarios
¿¿ $
(
¿¿$ %
int
¿¿% (
id
¿¿) +
)
¿¿+ ,
{
¡¡ 	

SqlCommand
¬¬ 
cmd
¬¬ 
=
¬¬ 
null
¬¬ !
;
¬¬! "
bool
√√ 
	eliminado
√√ 
=
√√ 
false
√√ "
;
√√" #
try
ƒƒ 
{
≈≈ 
SqlConnection
∆∆ 
cn
∆∆  
=
∆∆! "
Conexion
∆∆# +
.
∆∆+ ,
	Instancia
∆∆, 5
.
∆∆5 6
Conectar
∆∆6 >
(
∆∆> ?
)
∆∆? @
;
∆∆@ A
cmd
«« 
=
«« 
new
«« 

SqlCommand
«« $
(
««$ %
$str
««% 9
,
««9 :
cn
««; =
)
««= >
{
»» 
CommandType
…… 
=
……  !
CommandType
……" -
.
……- .
StoredProcedure
……. =
}
   
;
   
cmd
ÀÀ 
.
ÀÀ 

Parameters
ÀÀ 
.
ÀÀ 
AddWithValue
ÀÀ +
(
ÀÀ+ ,
$str
ÀÀ, 8
,
ÀÀ8 9
id
ÀÀ: <
)
ÀÀ< =
;
ÀÀ= >
cn
ÃÃ 
.
ÃÃ 
Open
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ 
int
ÕÕ 
i
ÕÕ 
=
ÕÕ 
cmd
ÕÕ 
.
ÕÕ 
ExecuteNonQuery
ÕÕ +
(
ÕÕ+ ,
)
ÕÕ, -
;
ÕÕ- .
if
ŒŒ 
(
ŒŒ 
i
ŒŒ 
>
ŒŒ 
$num
ŒŒ 
)
ŒŒ 
{
œœ 
	eliminado
–– 
=
–– 
true
––  $
;
––$ %
}
—— 
}
““ 
catch
”” 
(
”” 
	Exception
”” 
e
”” 
)
”” 
{
‘‘ 

MessageBox
÷÷ 
.
÷÷ 
Show
÷÷ 
(
÷÷  
e
÷÷  !
.
÷÷! "
Message
÷÷" )
,
÷÷) *
$str
÷÷+ f
,
÷÷f g
MessageBoxButtons
÷÷h y
.
÷÷y z
OK
÷÷z |
,
÷÷| }
MessageBoxIcon÷÷~ å
.÷÷å ç
Error÷÷ç í
)÷÷í ì
;÷÷ì î
}
◊◊ 
return
ÿÿ 
	eliminado
ÿÿ 
;
ÿÿ 
}
ŸŸ 	
public
⁄⁄ 

EntUsuario
⁄⁄ 
BuscarIdUsuario
⁄⁄ )
(
⁄⁄) *
int
⁄⁄* -
busqueda
⁄⁄. 6
)
⁄⁄6 7
{
€€ 	

SqlCommand
‹‹ 
cmd
‹‹ 
=
‹‹ 
null
‹‹ !
;
‹‹! "

EntUsuario
›› 
c
›› 
=
›› 
new
›› 

EntUsuario
›› )
(
››) *
)
››* +
;
››+ ,
try
ﬁﬁ 
{
ﬂﬂ 
SqlConnection
‡‡ 
cn
‡‡  
=
‡‡! "
Conexion
‡‡# +
.
‡‡+ ,
	Instancia
‡‡, 5
.
‡‡5 6
Conectar
‡‡6 >
(
‡‡> ?
)
‡‡? @
;
‡‡@ A
cmd
·· 
=
·· 
new
·· 

SqlCommand
·· $
(
··$ %
$str
··% 8
,
··8 9
cn
··: <
)
··< =
;
··= >
cmd
‚‚ 
.
‚‚ 
CommandType
‚‚ 
=
‚‚  !
CommandType
‚‚" -
.
‚‚- .
StoredProcedure
‚‚. =
;
‚‚= >
cmd
„„ 
.
„„ 

Parameters
„„ 
.
„„ 
AddWithValue
„„ +
(
„„+ ,
$str
„„, 8
,
„„8 9
busqueda
„„: B
)
„„B C
;
„„C D
cn
‰‰ 
.
‰‰ 
Open
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
SqlDataReader
ÂÂ 
dr
ÂÂ  
=
ÂÂ! "
cmd
ÂÂ# &
.
ÂÂ& '
ExecuteReader
ÂÂ' 4
(
ÂÂ4 5
)
ÂÂ5 6
;
ÂÂ6 7
while
ÊÊ 
(
ÊÊ 
dr
ÊÊ 
.
ÊÊ 
Read
ÊÊ 
(
ÊÊ 
)
ÊÊ  
)
ÊÊ  !
{
ÁÁ 
c
ËË 
.
ËË 
	IdUsuario
ËË 
=
ËË  !
Convert
ËË" )
.
ËË) *
ToInt32
ËË* 1
(
ËË1 2
dr
ËË2 4
[
ËË4 5
$str
ËË5 @
]
ËË@ A
)
ËËA B
;
ËËB C
c
ÈÈ 
.
ÈÈ 
RazonSocial
ÈÈ !
=
ÈÈ" #
dr
ÈÈ$ &
[
ÈÈ& '
$str
ÈÈ' 4
]
ÈÈ4 5
.
ÈÈ5 6
ToString
ÈÈ6 >
(
ÈÈ> ?
)
ÈÈ? @
;
ÈÈ@ A
c
ÍÍ 
.
ÍÍ 
Telefono
ÍÍ 
=
ÍÍ  
dr
ÍÍ! #
[
ÍÍ# $
$str
ÍÍ$ .
]
ÍÍ. /
.
ÍÍ/ 0
ToString
ÍÍ0 8
(
ÍÍ8 9
)
ÍÍ9 :
;
ÍÍ: ;
c
ÎÎ 
.
ÎÎ 
	Direccion
ÎÎ 
=
ÎÎ  !
dr
ÎÎ" $
[
ÎÎ$ %
$str
ÎÎ% 0
]
ÎÎ0 1
.
ÎÎ1 2
ToString
ÎÎ2 :
(
ÎÎ: ;
)
ÎÎ; <
;
ÎÎ< =
c
ÏÏ 
.
ÏÏ 
Correo
ÏÏ 
=
ÏÏ 
dr
ÏÏ !
[
ÏÏ! "
$str
ÏÏ" *
]
ÏÏ* +
.
ÏÏ+ ,
ToString
ÏÏ, 4
(
ÏÏ4 5
)
ÏÏ5 6
;
ÏÏ6 7
c
ÌÌ 
.
ÌÌ 
UserName
ÌÌ 
=
ÌÌ  
dr
ÌÌ! #
[
ÌÌ# $
$str
ÌÌ$ .
]
ÌÌ. /
.
ÌÌ/ 0
ToString
ÌÌ0 8
(
ÌÌ8 9
)
ÌÌ9 :
;
ÌÌ: ;
c
ÓÓ 
.
ÓÓ 
Pass
ÓÓ 
=
ÓÓ 
dr
ÓÓ 
[
ÓÓ  
$str
ÓÓ  &
]
ÓÓ& '
.
ÓÓ' (
ToString
ÓÓ( 0
(
ÓÓ0 1
)
ÓÓ1 2
;
ÓÓ2 3
c
ÔÔ 
.
ÔÔ 
Activo
ÔÔ 
=
ÔÔ 
Convert
ÔÔ &
.
ÔÔ& '
	ToBoolean
ÔÔ' 0
(
ÔÔ0 1
dr
ÔÔ1 3
[
ÔÔ3 4
$str
ÔÔ4 <
]
ÔÔ< =
)
ÔÔ= >
;
ÔÔ> ?
c
 
.
 
Roll
 
=
 
new
  
entRoll
! (
(
( )
)
) *
{
ÒÒ 
Descripcion
ÚÚ #
=
ÚÚ$ %
dr
ÚÚ& (
[
ÚÚ( )
$str
ÚÚ) 6
]
ÚÚ6 7
.
ÚÚ7 8
ToString
ÚÚ8 @
(
ÚÚ@ A
)
ÚÚA B
,
ÚÚB C
}
ÛÛ 
;
ÛÛ 
c
ÙÙ 
.
ÙÙ 
Ubigeo
ÙÙ 
=
ÙÙ 
new
ÙÙ "
	EntUbigeo
ÙÙ# ,
(
ÙÙ, -
)
ÙÙ- .
{
ıı 
Departamento
ˆˆ $
=
ˆˆ% &
dr
ˆˆ' )
[
ˆˆ) *
$str
ˆˆ* 8
]
ˆˆ8 9
.
ˆˆ9 :
ToString
ˆˆ: B
(
ˆˆB C
)
ˆˆC D
,
ˆˆD E
	Provincia
˜˜ !
=
˜˜" #
dr
˜˜$ &
[
˜˜& '
$str
˜˜' 2
]
˜˜2 3
.
˜˜3 4
ToString
˜˜4 <
(
˜˜< =
)
˜˜= >
,
˜˜> ?
Distrito
¯¯  
=
¯¯! "
dr
¯¯# %
[
¯¯% &
$str
¯¯& 0
]
¯¯0 1
.
¯¯1 2
ToString
¯¯2 :
(
¯¯: ;
)
¯¯; <
}
˘˘ 
;
˘˘ 
}
˙˙ 
}
˚˚ 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
e
¸¸ 
)
¸¸ 
{
˝˝ 

MessageBox
˛˛ 
.
˛˛ 
Show
˛˛ 
(
˛˛  
e
˛˛  !
.
˛˛! "
Message
˛˛" )
,
˛˛) *
$str
˛˛+ e
,
˛˛e f
MessageBoxButtons
˛˛g x
.
˛˛x y
OK
˛˛y {
,
˛˛{ |
MessageBoxIcon˛˛} ã
.˛˛ã å
Error˛˛å ë
)˛˛ë í
;˛˛í ì
}
ÄÄ 
return
ÅÅ 
c
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
}
ÖÖ 
<<<<<<< HEAD
}áá ¸}
LD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatCompra.cs
=======
}áá ä~
ZC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatCompra.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
	DatCompra 
: 

IDatCompra %
{ 
public 
int 
CrearCompra 
( 
	EntCompra (
comp) -
)- .
{ 	

SqlCommand 
cmd 
= 
null !
;! "
int 
idCompra 
= 
- 
$num 
; 
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 4
,4 5
cn6 8
)8 9
{ 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
} 
; 
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
comp6 :
.: ;
Total; @
)@ A
;A B
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
comp: >
.> ?
Usuario? F
.F G
	IdUsuarioG P
)P Q
;Q R
SqlParameter 
id 
=  !
new" %
SqlParameter& 2
(2 3
$str3 8
,8 9
$num: ;
); <
{ 
	Direction 
= 
ParameterDirection  2
.2 3
Output3 9
} 
; 
cmd   
.   

Parameters   
.   
Add   "
(  " #
id  # %
)  % &
;  & '
cn"" 
."" 
Open"" 
("" 
)"" 
;"" 
int## 
i## 
=## 
cmd## 
.## 
ExecuteNonQuery## +
(##+ ,
)##, -
;##- .
if$$ 
($$ 
i$$ 
>$$ 
$num$$ 
)$$ 
{%% 
idCompra&& 
=&& 
Convert&& &
.&&& '
ToInt32&&' .
(&&. /
cmd&&/ 2
.&&2 3

Parameters&&3 =
[&&= >
$str&&> C
]&&C D
.&&D E
Value&&E J
)&&J K
;&&K L
}'' 
if(( 
((( 
idCompra(( 
==(( 
-((  !
$num((! "
)((" #
{)) 

MessageBox** 
.** 
Show** #
(**# $
$str**$ 1
)**1 2
;**2 3
}++ 
}-- 
catch.. 
(.. 
	Exception.. 
e.. 
).. 
{// 

MessageBox00 
.00 
Show00 
(00  
e00  !
.00! "
Message00" )
,00) *
$str00+ e
,00e f
MessageBoxButtons00g x
.00x y
OK00y {
,00{ |
MessageBoxIcon	00} ã
.
00ã å
Error
00å ë
)
00ë í
;
00í ì
}11 
return22 
idCompra22 
;22 
}33 	
public55 
List55 
<55 
	EntCompra55 
>55 
ListarCompra55 +
(55+ ,
int55, /
id550 2
)552 3
{66 	
List77 
<77 
	EntCompra77 
>77 
lista77 !
=77" #
new77$ '
List77( ,
<77, -
	EntCompra77- 6
>776 7
(777 8
)778 9
;779 :

SqlCommand88 
cmd88 
=88 
null88 !
;88! "
try99 
{:: 
SqlConnection;; 
cn;;  
=;;! "
Conexion;;# +
.;;+ ,
	Instancia;;, 5
.;;5 6
Conectar;;6 >
(;;> ?
);;? @
;;;@ A
cmd<< 
=<< 
new<< 

SqlCommand<< $
(<<$ %
$str<<% 5
,<<5 6
cn<<7 9
)<<9 :
;<<: ;
cmd== 
.== 

Parameters== 
.== 
AddWithValue== +
(==+ ,
$str==, 1
,==1 2
id==3 5
)==5 6
;==6 7
cmd>> 
.>> 
CommandType>> 
=>>  !
CommandType>>" -
.>>- .
StoredProcedure>>. =
;>>= >
cn?? 
.?? 
Open?? 
(?? 
)?? 
;?? 
SqlDataReader@@ 
dr@@  
=@@! "
cmd@@# &
.@@& '
ExecuteReader@@' 4
(@@4 5
)@@5 6
;@@6 7
whileAA 
(AA 
drAA 
.AA 
ReadAA 
(AA 
)AA  
)AA  !
{BB 
	EntCompraCC 
	objCompraCC '
=CC( )
newCC* -
	EntCompraCC. 7
{DD 
IdCompraEE  
=EE! "
ConvertEE# *
.EE* +
ToInt32EE+ 2
(EE2 3
drEE3 5
[EE5 6
$strEE6 @
]EE@ A
)EEA B
,EEB C
FechaFF 
=FF 
ConvertFF  '
.FF' (

ToDateTimeFF( 2
(FF2 3
drFF3 5
[FF5 6
$strFF6 =
]FF= >
)FF> ?
,FF? @
TotalGG 
=GG 
ConvertGG  '
.GG' (
ToDoubleGG( 0
(GG0 1
drGG1 3
[GG3 4
$strGG4 ;
]GG; <
)GG< =
,GG= >
UsuarioHH 
=HH  
newHH  #

EntUsuarioHH$ .
{II 
UserNameJJ $
=JJ% &
drJJ' )
[JJ) *
$strJJ* 4
]JJ4 5
.JJ5 6
ToStringJJ6 >
(JJ> ?
)JJ? @
,JJ@ A
}KK 
,KK 
EstadoLL 
=LL  
drLL! #
[LL# $
$strLL$ ,
]LL, -
.LL- .
ToStringLL. 6
(LL6 7
)LL7 8
}MM 
;MM 
listaOO 
.OO 
AddOO 
(OO 
	objCompraOO '
)OO' (
;OO( )
}PP 
}QQ 
catchRR 
(RR 
	ExceptionRR 
eRR 
)RR 
{SS 

MessageBoxTT 
.TT 
ShowTT 
(TT  
eTT  !
.TT! "
MessageTT" )
,TT) *
$strTT+ ;
,TT; <
MessageBoxButtonsTT= N
.TTN O
OKTTO Q
,TTQ R
MessageBoxIconTTS a
.TTa b
ErrorTTb g
)TTg h
;TTh i
}UU 
returnVV 
listaVV 
;VV 
}WW 	
publicYY 
ListYY 
<YY 
	EntCompraYY 
>YY !
ListarTodasLasComprasYY 4
(YY4 5
)YY5 6
{ZZ 	
List[[ 
<[[ 
	EntCompra[[ 
>[[ 
lista[[ !
=[[" #
new[[$ '
List[[( ,
<[[, -
	EntCompra[[- 6
>[[6 7
([[7 8
)[[8 9
;[[9 :

SqlCommand\\ 
cmd\\ 
=\\ 
null\\ !
;\\! "
try]] 
{^^ 
SqlConnection__ 
cn__  
=__! "
Conexion__# +
.__+ ,
	Instancia__, 5
.__5 6
Conectar__6 >
(__> ?
)__? @
;__@ A
cmd`` 
=`` 
new`` 

SqlCommand`` $
(``$ %
$str``% =
,``= >
cn``? A
)``A B
;``B C
cmdaa 
.aa 
CommandTypeaa 
=aa  !
CommandTypeaa" -
.aa- .
StoredProcedureaa. =
;aa= >
cnbb 
.bb 
Openbb 
(bb 
)bb 
;bb 
SqlDataReadercc 
drcc  
=cc! "
cmdcc# &
.cc& '
ExecuteReadercc' 4
(cc4 5
)cc5 6
;cc6 7
whiledd 
(dd 
drdd 
.dd 
Readdd 
(dd 
)dd  
)dd  !
{ee 
	EntCompraff 
	objCompraff '
=ff( )
newff* -
	EntCompraff. 7
{gg 
IdComprahh  
=hh! "
Converthh# *
.hh* +
ToInt32hh+ 2
(hh2 3
drhh3 5
[hh5 6
$strhh6 @
]hh@ A
)hhA B
,hhB C
Fechaii 
=ii 
Convertii  '
.ii' (

ToDateTimeii( 2
(ii2 3
drii3 5
[ii5 6
$strii6 =
]ii= >
)ii> ?
,ii? @
Totaljj 
=jj 
Convertjj  '
.jj' (
ToDoublejj( 0
(jj0 1
drjj1 3
[jj3 4
$strjj4 ;
]jj; <
)jj< =
,jj= >
Usuariokk 
=kk  !
newkk" %

EntUsuariokk& 0
{ll 
Correomm "
=mm# $
drmm% '
[mm' (
$strmm( 0
]mm0 1
.mm1 2
ToStringmm2 :
(mm: ;
)mm; <
,mm< =
UserNamenn $
=nn% &
drnn' )
[nn) *
$strnn* 4
]nn4 5
.nn5 6
ToStringnn6 >
(nn> ?
)nn? @
}oo 
,oo 
Estadopp 
=pp  
drpp! #
[pp# $
$strpp$ ,
]pp, -
.pp- .
ToStringpp. 6
(pp6 7
)pp7 8
}qq 
;qq 
listass 
.ss 
Addss 
(ss 
	objComprass '
)ss' (
;ss( )
}tt 
}uu 
catchvv 
(vv 
	Exceptionvv 
evv 
)vv 
{ww 

MessageBoxxx 
.xx 
Showxx 
(xx  
exx  !
.xx! "
Messagexx" )
,xx) *
$strxx+ @
,xx@ A
MessageBoxButtonsxxB S
.xxS T
OKxxT V
,xxV W
MessageBoxIconxxX f
.xxf g
Errorxxg l
)xxl m
;xxm n
}yy 
returnzz 
listazz 
;zz 
}{{ 	
public}} 
bool}} 
EliminarCompra}} "
(}}" #
int}}# &
idcompra}}' /
)}}/ 0
{~~ 	

SqlCommand 
cmd 
= 
null !
;! "
bool
ÄÄ 
	eliminado
ÄÄ 
=
ÄÄ 
false
ÄÄ "
;
ÄÄ" #
try
ÅÅ 
{
ÇÇ 
SqlConnection
ÉÉ 
cn
ÉÉ  
=
ÉÉ! "
Conexion
ÉÉ# +
.
ÉÉ+ ,
	Instancia
ÉÉ, 5
.
ÉÉ5 6
Conectar
ÉÉ6 >
(
ÉÉ> ?
)
ÉÉ? @
;
ÉÉ@ A
cmd
ÑÑ 
=
ÑÑ 
new
ÑÑ 

SqlCommand
ÑÑ $
(
ÑÑ$ %
$str
ÑÑ% 7
,
ÑÑ7 8
cn
ÑÑ9 ;
)
ÑÑ; <
;
ÑÑ< =
cmd
ÖÖ 
.
ÖÖ 
CommandType
ÖÖ 
=
ÖÖ  !
CommandType
ÖÖ" -
.
ÖÖ- .
StoredProcedure
ÖÖ. =
;
ÖÖ= >
cmd
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ 
.
ÜÜ 
AddWithValue
ÜÜ +
(
ÜÜ+ ,
$str
ÜÜ, 7
,
ÜÜ7 8
idcompra
ÜÜ9 A
)
ÜÜA B
;
ÜÜB C
cn
áá 
.
áá 
Open
áá 
(
áá 
)
áá 
;
áá 
int
àà 
i
àà 
=
àà 
cmd
àà 
.
àà 
ExecuteNonQuery
àà +
(
àà+ ,
)
àà, -
;
àà- .
if
ââ 
(
ââ 
i
ââ 
>
ââ 
$num
ââ 
)
ââ 
{
ää 
	eliminado
ãã 
=
ãã 
true
ãã  $
;
ãã$ %
}
åå 
}
çç 
catch
éé 
(
éé 
	Exception
éé 
e
éé 
)
éé 
{
èè 

MessageBox
êê 
.
êê 
Show
êê 
(
êê  
e
êê  !
.
êê! "
Message
êê" )
)
êê) *
;
êê* +
}
ëë 
return
íí 
	eliminado
íí 
;
íí 
}
ìì 	
public
ïï 
List
ïï 
<
ïï 
	EntCompra
ïï 
>
ïï 
BuscarCompra
ïï +
(
ïï+ ,
string
ïï, 2
busqueda
ïï3 ;
)
ïï; <
{
ññ 	
List
óó 
<
óó 
	EntCompra
óó 
>
óó 
lista
óó !
=
óó" #
new
óó$ '
List
óó( ,
<
óó, -
	EntCompra
óó- 6
>
óó6 7
(
óó7 8
)
óó8 9
;
óó9 :

SqlCommand
òò 
cmd
òò 
=
òò 
null
òò !
;
òò! "
try
ôô 
{
öö 
SqlConnection
õõ 
cn
õõ  
=
õõ! "
Conexion
õõ# +
.
õõ+ ,
	Instancia
õõ, 5
.
õõ5 6
Conectar
õõ6 >
(
õõ> ?
)
õõ? @
;
õõ@ A
cmd
úú 
=
úú 
new
úú 

SqlCommand
úú $
(
úú$ %
$str
úú% 5
,
úú5 6
cn
úú7 9
)
úú9 :
;
úú: ;
cmd
ùù 
.
ùù 
CommandType
ùù 
=
ùù  !
CommandType
ùù" -
.
ùù- .
StoredProcedure
ùù. =
;
ùù= >
cmd
ûû 
.
ûû 

Parameters
ûû 
.
ûû 
AddWithValue
ûû +
(
ûû+ ,
$str
ûû, 4
,
ûû4 5
busqueda
ûû6 >
)
ûû> ?
;
ûû? @
cn
üü 
.
üü 
Open
üü 
(
üü 
)
üü 
;
üü 
SqlDataReader
†† 
dr
††  
=
††! "
cmd
††# &
.
††& '
ExecuteReader
††' 4
(
††4 5
)
††5 6
;
††6 7
while
°° 
(
°° 
dr
°° 
.
°° 
Read
°° 
(
°° 
)
°°  
)
°°  !
{
¢¢ 
	EntCompra
££ 
Prod
££ "
=
££# $
new
££% (
	EntCompra
££) 2
(
££2 3
)
££3 4
;
££4 5
Prod
§§ 
.
§§ 
IdCompra
§§ !
=
§§" #
Convert
§§$ +
.
§§+ ,
ToInt32
§§, 3
(
§§3 4
dr
§§4 6
[
§§6 7
$str
§§7 A
]
§§A B
)
§§B C
;
§§C D
Prod
•• 
.
•• 
Fecha
•• 
=
••  
Convert
••! (
.
••( )

ToDateTime
••) 3
(
••3 4
dr
••4 6
[
••6 7
$str
••7 >
]
••> ?
)
••? @
;
••@ A
Prod
¶¶ 
.
¶¶ 
Total
¶¶ 
=
¶¶  
Convert
¶¶! (
.
¶¶( )
ToDouble
¶¶) 1
(
¶¶1 2
dr
¶¶2 4
[
¶¶4 5
$str
¶¶5 <
]
¶¶< =
)
¶¶= >
;
¶¶> ?
lista
®® 
.
®® 
Add
®® 
(
®® 
Prod
®® "
)
®®" #
;
®®# $
}
©© 
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
e
´´ 
)
´´ 
{
¨¨ 

MessageBox
ÆÆ 
.
ÆÆ 
Show
ÆÆ 
(
ÆÆ  
e
ÆÆ  !
.
ÆÆ! "
Message
ÆÆ" )
)
ÆÆ) *
;
ÆÆ* +
}
ØØ 
return
∞∞ 
lista
∞∞ 
;
∞∞ 
}
±± 	
}
≤≤ 
<<<<<<< HEAD
}≥≥ ÅC
OD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatDetCompra.cs
=======
}≥≥ èC
]C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatDetCompra.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatDetCompra 
: 
IDatDetCompra  -
{ 
public 
bool 
CrearDetCompra "
(" #
EntDetCompra# /
Det0 3
)3 4
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 7
,7 8
cn9 ;
); <
;< =
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Det9 <
.< =
Compra= C
.C D
IdCompraD L
)L M
;M N
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
Det< ?
.? @
ProveedorProducto@ Q
.Q R
	ProveedorR [
.[ \
IdProveedor\ g
)g h
;h i
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
Det; >
.> ?
ProveedorProducto? P
.P Q
ProductoQ Y
.Y Z

IdProductoZ d
)d e
;e f
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Det9 <
.< =
Cantidad= E
)E F
;F G
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
Det9 <
.< =
Subtotal= E
)E F
;F G
cn 
. 
Open 
( 
) 
; 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if 
( 
i 
!= 
$num 
) 
{   
creado!! 
=!! 
true!! !
;!!! "
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
e$$ 
)$$ 
{%% 

MessageBox&& 
.&& 
Show&& 
(&&  
e&&  !
.&&! "
Message&&" )
)&&) *
;&&* +
}'' 
return(( 
creado(( 
;(( 
})) 	
public++ 
List++ 
<++ 
EntDetCompra++  
>++  !"
MostrarDetalleCompraId++" 8
(++8 9
int++9 <
id++= ?
)++? @
{,, 	
List-- 
<-- 
EntDetCompra-- 
>-- 
list-- #
=--$ %
new--& )
List--* .
<--. /
EntDetCompra--/ ;
>--; <
(--< =
)--= >
;--> ?

SqlCommand.. 
cmd.. 
=.. 
null.. !
;..! "
try// 
{00 
SqlConnection11 
cn11  
=11! "
Conexion11# +
.11+ ,
	Instancia11, 5
.115 6
Conectar116 >
(11> ?
)11? @
;11@ A
cmd22 
=22 
new22 

SqlCommand22 $
(22$ %
$str22% >
,22> ?
cn22@ B
)22B C
;22C D
cmd33 
.33 
CommandType33 
=33  !
CommandType33" -
.33- .
StoredProcedure33. =
;33= >
cmd44 
.44 

Parameters44 
.44 
AddWithValue44 +
(44+ ,
$str44, 7
,447 8
id449 ;
)44; <
;44< =
cn55 
.55 
Open55 
(55 
)55 
;55 
SqlDataReader66 
dr66  
=66! "
cmd66# &
.66& '
ExecuteReader66' 4
(664 5
)665 6
;666 7
while77 
(77 
dr77 
.77 
Read77 
(77 
)77  
)77  !
{88 
EntDetCompra99  
detalle99! (
=99) *
new99+ .
EntDetCompra99/ ;
{:: 
Compra;; 
=;;  
new;;! $
	EntCompra;;% .
{<< 
IdCompra== $
===% &
Convert==' .
.==. /
ToInt32==/ 6
(==6 7
dr==7 9
[==9 :
$str==: D
]==D E
)==E F
}>> 
,>> 
ProveedorProducto?? )
=??* +
new??, / 
EntProveedorProducto??0 D
{@@ 
	ProveedorAA %
=AA& '
newAA( +
EntProveedorAA, 8
{BB 
IdProveedorCC  +
=CC, -
ConvertCC. 5
.CC5 6
ToInt32CC6 =
(CC= >
drCC> @
[CC@ A
$strCCA N
]CCN O
)CCO P
,CCP Q
RazonSocialDD  +
=DD, -
drDD. 0
[DD0 1
$strDD1 >
]DD> ?
.DD? @
ToStringDD@ H
(DDH I
)DDI J
,DDJ K
DescripcionEE  +
=EE, -
drEE. 0
[EE0 1
$strEE1 >
]EE> ?
.EE? @
ToStringEE@ H
(EEH I
)EEI J
,EEJ K
}GG 
,GG 
ProductoHH $
=HH% &
newHH' *
EntProductoHH+ 6
{II 

IdProductoJJ  *
=JJ+ ,
ConvertJJ- 4
.JJ4 5
ToInt32JJ5 <
(JJ< =
drJJ= ?
[JJ? @
$strJJ@ L
]JJL M
)JJM N
,JJN O
NombreKK  &
=KK' (
drKK) +
[KK+ ,
$strKK, 4
]KK4 5
.KK5 6
ToStringKK6 >
(KK> ?
)KK? @
,KK@ A
LongitudLL  (
=LL) *
ConvertLL+ 2
.LL2 3
ToDoubleLL3 ;
(LL; <
drLL< >
[LL> ?
$strLL? I
]LLI J
)LLJ K
,LLK L
DiametroMM  (
=MM) *
ConvertMM+ 2
.MM2 3
ToDoubleMM3 ;
(MM; <
drMM< >
[MM> ?
$strMM? I
]MMI J
)MMJ K
,MMK L
TipoNN  $
=NN% &
newNN' *
EntTipoProductoNN+ :
{OO  !
NombrePP$ *
=PP+ ,
drPP- /
[PP/ 0
$strPP0 6
]PP6 7
.PP7 8
ToStringPP8 @
(PP@ A
)PPA B
}QQ  !
}SS 
,SS 
PrecioCompraTT (
=TT) *
ConvertTT+ 2
.TT2 3
ToDoubleTT3 ;
(TT; <
drTT< >
[TT> ?
$strTT? M
]TTM N
)TTN O
}UU 
,UU 
CantidadVV  
=VV! "
ConvertVV# *
.VV* +
ToInt32VV+ 2
(VV2 3
drVV3 5
[VV5 6
$strVV6 @
]VV@ A
)VVA B
,VVB C
SubtotalWW  
=WW! "
ConvertWW# *
.WW* +
ToDoubleWW+ 3
(WW3 4
drWW4 6
[WW6 7
$strWW7 A
]WWA B
)WWB C
}YY 
;YY 
listZZ 
.ZZ 
AddZZ 
(ZZ 
detalleZZ $
)ZZ$ %
;ZZ% &
}[[ 
}\\ 
catch]] 
(]] 
	Exception]] 
e]] 
)]] 
{^^ 

MessageBox`` 
.`` 
Show`` 
(``  
e``  !
.``! "
Message``" )
)``) *
;``* +
}aa 
returnbb 
listbb 
;bb 
}cc 	
}dd 
<<<<<<< HEAD
}ee ¨;
ND:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatDetVenta.cs
=======
}ee ∫;
\C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatDetVenta.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace

 	
CapaAccesoDatos


 
{ 
public 

class 
DatDetVenta 
: 
IDatDetVenta +
{ 
private 
static 
readonly 
DatDetVenta  +

_instancia, 6
=7 8
new9 <
DatDetVenta= H
(H I
)I J
;J K
public 
static 
DatDetVenta !
	Instancia" +
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearDetVenta !
(! "
EntDetVenta" -
Det. 1
)1 2
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 6
,6 7
cn8 :
): ;
;; <
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 6
,6 7
Det8 ;
.; <
Venta< A
.A B
IdVentaB I
)I J
;J K
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
Det; >
.> ?
Producto? G
.G H

IdProductoH R
)R S
;S T
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 7
,  7 8
Det  9 <
.  < =
Cantidad  = E
)  E F
;  F G
cmd!! 
.!! 

Parameters!! 
.!! 
AddWithValue!! +
(!!+ ,
$str!!, 7
,!!7 8
Det!!9 <
.!!< =
SubTotal!!= E
)!!E F
;!!F G
cn"" 
."" 
Open"" 
("" 
)"" 
;"" 
int## 
i## 
=## 
cmd## 
.## 
ExecuteNonQuery## +
(##+ ,
)##, -
;##- .
if$$ 
($$ 
i$$ 
!=$$ 
$num$$ 
)$$ 
{%% 
creado&& 
=&& 
true&& !
;&&! "
}'' 
}(( 
catch)) 
()) 
	Exception)) 
e)) 
))) 
{** 

MessageBox++ 
.++ 
Show++ 
(++  
e++  !
.++! "
Message++" )
)++) *
;++* +
},, 
return-- 
creado-- 
;-- 
}.. 	
public22 
List22 
<22 
EntDetVenta22 
>22  
Mostrardetventa22! 0
(220 1
int221 4
idVenta225 <
)22< =
{33 	

SqlCommand44 
cmd44 
=44 
null44 !
;44! "
List55 
<55 
EntDetVenta55 
>55 
list55 "
=55# $
new55% (
List55) -
<55- .
EntDetVenta55. 9
>559 :
(55: ;
)55; <
;55< =
try66 
{77 
SqlConnection88 
cn88  
=88! "
Conexion88# +
.88+ ,
	Instancia88, 5
.885 6
Conectar886 >
(88> ?
)88? @
;88@ A
cmd99 
=99 
new99 

SqlCommand99 $
(99$ %
$str99% >
,99> ?
cn99@ B
)99B C
;99C D
cmd:: 
.:: 
CommandType:: 
=::  !
CommandType::" -
.::- .
StoredProcedure::. =
;::= >
cmd;; 
.;; 

Parameters;; 
.;; 
AddWithValue;; +
(;;+ ,
$str;;, 6
,;;6 7
idVenta;;8 ?
);;? @
;;;@ A
cn<< 
.<< 
Open<< 
(<< 
)<< 
;<< 
SqlDataReader== 
dr==  
===! "
cmd==# &
.==& '
ExecuteReader==' 4
(==4 5
)==5 6
;==6 7
while>> 
(>> 
dr>> 
.>> 
Read>> 
(>> 
)>>  
)>>  !
{?? 
EntDetVenta@@ 
det@@  #
=@@$ %
new@@& )
EntDetVenta@@* 5
{AA 
VentaBB 
=BB 
newBB !
EntVentaBB" *
{CC 
IdVentaDD #
=DD# $
ConvertDD% ,
.DD, -
ToInt32DD- 4
(DD4 5
drDD5 7
[DD7 8
$strDD8 A
]DDA B
)DDB C
}EE 
,EE 
ProductoFF  
=FF! "
newFF# &
EntProductoFF' 2
{GG 
NombreHH "
=HH# $
drHH% '
[HH' (
$strHH( 0
]HH0 1
.HH1 2
ToStringHH2 :
(HH: ;
)HH; <
,HH< =
LongitudII $
=II% &
ConvertII' .
.II. /
ToDoubleII/ 7
(II7 8
drII8 :
[II: ;
$strII; E
]IIE F
)IIF G
,IIG H
DiametroJJ $
=JJ% &
ConvertJJ' .
.JJ. /
ToDoubleJJ/ 7
(JJ7 8
drJJ8 :
[JJ: ;
$strJJ; E
]JJE F
)JJF G
,JJG H
PrecioVentaKK '
=KK( )
ConvertKK* 1
.KK1 2
ToDoubleKK2 :
(KK: ;
drKK; =
[KK= >
$strKK> K
]KKK L
)KKL M
,KKM N
TipoMM  
=MM! "
newMM# &
EntTipoProductoMM' 6
{NN 
NombreOO  &
=OO' (
drOO) +
[OO+ ,
$strOO, 2
]OO2 3
.OO3 4
ToStringOO4 <
(OO< =
)OO= >
}PP 
}QQ 
,QQ 
CantidadRR  
=RR! "
ConvertRR# *
.RR* +
ToInt32RR+ 2
(RR2 3
drRR3 5
[RR5 6
$strRR6 @
]RR@ A
)RRA B
,RRB C
SubTotalSS  
=SS! "
ConvertSS# *
.SS* +
ToDoubleSS+ 3
(SS3 4
drSS4 6
[SS6 7
$strSS7 A
]SSA B
)SSB C
}TT 
;TT 
listUU 
.UU 
AddUU 
(UU 
detUU  
)UU  !
;UU! "
}VV 
}WW 
catchXX 
(XX 
	ExceptionXX 
eXX 
)XX 
{YY 

MessageBoxZZ 
.ZZ 
ShowZZ 
(ZZ  
eZZ  !
.ZZ! "
MessageZZ" )
)ZZ) *
;ZZ* +
}[[ 
return\\ 
list\\ 
;\\ 
}]] 	
}^^ 
<<<<<<< HEAD
}__ ì
MD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\datGrafEst.cs
=======
}__ °
[C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\datGrafEst.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace 	
CapaAccesoDatos
 
{ 
public		 

class		 

datGrafEst		 
{

 
private 
static 
readonly 

datGrafEst  *
	_instance+ 4
=5 6
new7 :

datGrafEst; E
(E F
)F G
;G H
public 
static 

datGrafEst  
	Instancia! *
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
	ArrayList 
ProductosPreferidos ,
(, -
object- 3
chart4 9
)9 :
{ 	

SqlCommand 
cmd 
= 
null !
;! "
	ArrayList 
NombreMadera "
=# $
new% (
	ArrayList) 2
(2 3
)3 4
;4 5
	ArrayList 

CantMadera  
=! "
new# &
	ArrayList' 0
(0 1
)1 2
;2 3
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% <
,< =
cn> @
)@ A
;A B
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cn 
. 
Open 
( 
) 
; 
SqlDataReader 
dr  
=! "
cmd# &
.& '
ExecuteReader' 4
(4 5
)5 6
;6 7
while 
( 
dr 
. 
Read 
( 
)  
)  !
{ 
NombreMadera  
.  !
Add! $
($ %
dr% '
.' (
	GetString( 1
(1 2
$num2 3
)3 4
)4 5
;5 6

CantMadera   
.   
Add   "
(  " #
dr  # %
.  % &
GetInt16  & .
(  . /
$num  / 0
)  0 1
)  1 2
;  2 3
}!! 
}## 
catch$$ 
($$ 
	Exception$$ 
e$$ 
)$$ 
{%% 

MessageBox'' 
.'' 
Show'' 
(''  
e''  !
.''! "
Message''" )
)'') *
;''* +
}(( 
return)) 
NombreMadera)) 
;))  
}** 	
}++ 
<<<<<<< HEAD
},, ’Ã
ND:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProducto.cs
=======
},, „Ã
\C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProducto.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatProducto 
: 
IDatProducto +
{ 
private 
static 
readonly 
DatProducto  +

_instancia, 6
=7 8
new9 <
DatProducto= H
(H I
)I J
;J K
public 
static 
DatProducto !
	Instancia" +
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearProducto !
(! "
EntProducto" -
prod. 2
)2 3
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 6
,6 7
cn8 :
): ;
;; <
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
prod7 ;
.; <
Nombre< B
)B C
;C D
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
prod9 =
.= >
Longitud> F
)F G
;G H
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
prod9 =
.= >
Diametro> F
)F G
;G H
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
prod< @
.@ A
PrecioVentaA L
)L M
;M N
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , >
,  > ?
prod  @ D
.  D E
Tipo  E I
.  I J
IdTipo_producto  J Y
)  Y Z
;  Z [
cn!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
int"" 
i"" 
="" 
cmd"" 
."" 
ExecuteNonQuery"" +
(""+ ,
)"", -
;""- .
if$$ 
($$ 
i$$ 
>$$ 
$num$$ 
)$$ 
creado%% 
=%% 
true%% !
;%%! "
}'' 
catch(( 
((( 
	Exception(( 
e(( 
)(( 
{)) 

MessageBox** 
.** 
Show** 
(**  
e**  !
.**! "
Message**" )
,**) *
$str**+ J
,**J K
MessageBoxButtons**L ]
.**] ^
OK**^ `
,**` a
MessageBoxIcon**b p
.**p q
Error**q v
)**v w
;**w x
}++ 
return,, 
creado,, 
;,, 
}.. 	
public00 
List00 
<00 
EntProducto00 
>00  
ListarProducto00! /
(00/ 0
)000 1
{11 	

SqlCommand22 
cmd22 
=22 
null22 !
;22! "
List33 
<33 
EntProducto33 
>33 
lista33 #
=33$ %
new33& )
List33* .
<33. /
EntProducto33/ :
>33: ;
(33; <
)33< =
;33= >
try44 
{55 
SqlConnection66 
cn66  
=66! "
Conexion66# +
.66+ ,
	Instancia66, 5
.665 6
Conectar666 >
(66> ?
)66? @
;66@ A
cmd77 
=77 
new77 

SqlCommand77 $
(77$ %
$str77% 7
,777 8
cn779 ;
)77; <
;77< =
cmd88 
.88 
CommandType88 
=88  !
CommandType88" -
.88- .
StoredProcedure88. =
;88= >
cn99 
.99 
Open99 
(99 
)99 
;99 
SqlDataReader:: 
dr::  
=::! "
cmd::# &
.::& '
ExecuteReader::' 4
(::4 5
)::5 6
;::6 7
while;; 
(;; 
dr;; 
.;; 
Read;; 
(;; 
);;  
);;  !
{<< 
EntProducto>> 
Prod>>  $
=>>% &
new>>' *
EntProducto>>+ 6
{?? 

IdProducto@@ "
=@@# $
Convert@@% ,
.@@, -
ToInt32@@- 4
(@@4 5
dr@@5 7
[@@7 8
$str@@8 D
]@@D E
)@@E F
,@@F G
NombreAA 
=AA  
drAA! #
[AA# $
$strAA$ ,
]AA, -
.AA- .
ToStringAA. 6
(AA6 7
)AA7 8
,AA8 9
LongitudBB  
=BB! "
ConvertBB# *
.BB* +
ToDoubleBB+ 3
(BB3 4
drBB4 6
[BB6 7
$strBB7 A
]BBA B
)BBB C
,BBC D
DiametroCC  
=CC! "
ConvertCC# *
.CC* +
ToDoubleCC+ 3
(CC3 4
drCC4 6
[CC6 7
$strCC7 A
]CCA B
)CCB C
,CCC D
StockDD 
=DD 
ConvertDD  '
.DD' (
ToInt32DD( /
(DD/ 0
drDD0 2
[DD2 3
$strDD3 :
]DD: ;
)DD; <
,DD< =
ActivoEE 
=EE  
ConvertEE! (
.EE( )
	ToBooleanEE) 2
(EE2 3
drEE3 5
[EE5 6
$strEE6 >
]EE> ?
)EE? @
,EE@ A
PrecioVentaFF #
=FF$ %
ConvertFF& -
.FF- .
ToDoubleFF. 6
(FF6 7
drFF7 9
[FF9 :
$strFF: G
]FFG H
)FFH I
,FFI J
TipoGG 
=GG 
newGG "
EntTipoProductoGG# 2
{HH 
NombreII "
=II# $
drII% '
[II' (
$strII( .
]II. /
.II/ 0
ToStringII0 8
(II8 9
)II9 :
}JJ 
}KK 
;KK 
listaMM 
.MM 
AddMM 
(MM 
ProdMM "
)MM" #
;MM# $
}NN 
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
eQQ 
)QQ 
{RR 
throwSS 
newSS 
	ExceptionSS #
(SS# $
eSS$ %
.SS% &
MessageSS& -
)SS- .
;SS. /
}TT 
returnVV 
listaVV 
;VV 
}WW 	
publicXX 
boolXX 
ActualizarProductoXX &
(XX& '
EntProductoXX' 2
ProdXX3 7
)XX7 8
{YY 	

SqlCommandZZ 
cmdZZ 
=ZZ 
nullZZ !
;ZZ! "
bool[[ 
	actualiza[[ 
=[[ 
false[[ "
;[[" #
try\\ 
{]] 
SqlConnection^^ 
cn^^  
=^^! "
Conexion^^# +
.^^+ ,
	Instancia^^, 5
.^^5 6
Conectar^^6 >
(^^> ?
)^^? @
;^^@ A
cmd__ 
=__ 
new__ 

SqlCommand__ $
(__$ %
$str__% ;
,__; <
cn__= ?
)__? @
{`` 
CommandTypeaa 
=aa  !
CommandTypeaa" -
.aa- .
StoredProcedureaa. =
}bb 
;bb 
cmdcc 
.cc 

Parameterscc 
.cc 
AddWithValuecc +
(cc+ ,
$strcc, 9
,cc9 :
Prodcc: >
.cc> ?

IdProductocc? I
)ccI J
;ccJ K
cmddd 
.dd 

Parametersdd 
.dd 
AddWithValuedd +
(dd+ ,
$strdd, 5
,dd5 6
Proddd7 ;
.dd; <
Nombredd< B
)ddB C
;ddC D
cmdee 
.ee 

Parametersee 
.ee 
AddWithValueee +
(ee+ ,
$stree, 7
,ee7 8
Prodee9 =
.ee= >
Longitudee> F
)eeF G
;eeG H
cmdff 
.ff 

Parametersff 
.ff 
AddWithValueff +
(ff+ ,
$strff, 7
,ff7 8
Prodff9 =
.ff= >
Diametroff> F
)ffF G
;ffG H
cmdgg 
.gg 

Parametersgg 
.gg 
AddWithValuegg +
(gg+ ,
$strgg, :
,gg: ;
Prodgg< @
.gg@ A
PrecioVentaggA L
)ggL M
;ggM N
cmdhh 
.hh 

Parametershh 
.hh 
AddWithValuehh +
(hh+ ,
$strhh, >
,hh> ?
Prodhh@ D
.hhD E
TipohhE I
.hhI J
IdTipo_productohhJ Y
)hhY Z
;hhZ [
cmdii 
.ii 

Parametersii 
.ii 
AddWithValueii +
(ii+ ,
$strii, 5
,ii5 6
Prodii7 ;
.ii; <
Activoii< B
)iiB C
;iiC D
cnjj 
.jj 
Openjj 
(jj 
)jj 
;jj 
intkk 
ikk 
=kk 
cmdkk 
.kk 
ExecuteNonQuerykk +
(kk+ ,
)kk, -
;kk- .
ifll 
(ll 
ill 
>ll 
$numll 
)ll 
{mm 
	actualizann 
=nn 
truenn  $
;nn$ %
}oo 
}pp 
catchqq 
(qq 
	Exceptionqq 
eqq 
)qq 
{rr 

MessageBoxss 
.ss 
Showss 
(ss  
$strss  4
+ss5 6
ess7 8
.ss8 9
Messagess9 @
)ss@ A
;ssA B
}tt 
returnuu 
	actualizauu 
;uu 
}vv 	
publicyy 
boolyy 
EliminarProductoyy $
(yy$ %
intyy% (
idyy) +
)yy+ ,
{zz 	

SqlCommand{{ 
cmd{{ 
={{ 
null{{ !
;{{! "
bool|| 
	eliminado|| 
=|| 
false|| "
;||" #
try}} 
{~~ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd
ÄÄ 
=
ÄÄ 
new
ÄÄ 

SqlCommand
ÄÄ $
(
ÄÄ$ %
$str
ÄÄ% 9
,
ÄÄ9 :
cn
ÄÄ; =
)
ÄÄ= >
{
ÅÅ 
CommandType
ÇÇ 
=
ÇÇ  !
CommandType
ÇÇ" -
.
ÇÇ- .
StoredProcedure
ÇÇ. =
}
ÉÉ 
;
ÉÉ 
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ 
.
ÑÑ 
AddWithValue
ÑÑ +
(
ÑÑ+ ,
$str
ÑÑ, 9
,
ÑÑ9 :
id
ÑÑ; =
)
ÑÑ= >
;
ÑÑ> ?
cn
ÖÖ 
.
ÖÖ 
Open
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
int
ÜÜ 
i
ÜÜ 
=
ÜÜ 
cmd
ÜÜ 
.
ÜÜ 
ExecuteNonQuery
ÜÜ +
(
ÜÜ+ ,
)
ÜÜ, -
;
ÜÜ- .
if
áá 
(
áá 
i
áá 
>
áá 
$num
áá 
)
áá 
{
àà 
	eliminado
ââ 
=
ââ 
true
ââ  $
;
ââ$ %
}
ää 
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
e
åå 
)
åå 
{
çç 

MessageBox
éé 
.
éé 
Show
éé 
(
éé  
e
éé  !
.
éé! "
Message
éé" )
)
éé) *
;
éé* +
}
èè 
return
êê 
	eliminado
êê 
;
êê 
}
ëë 	
public
ìì 
List
ìì 
<
ìì 
EntProducto
ìì 
>
ìì  
BuscarProducto
ìì! /
(
ìì/ 0
string
ìì0 6
busqueda
ìì7 ?
)
ìì? @
{
îî 	
List
ïï 
<
ïï 
EntProducto
ïï 
>
ïï 
lista
ïï #
=
ïï$ %
new
ïï& )
List
ïï* .
<
ïï. /
EntProducto
ïï/ :
>
ïï: ;
(
ïï; <
)
ïï< =
;
ïï= >

SqlCommand
ññ 
cmd
ññ 
=
ññ 
null
ññ !
;
ññ! "
try
óó 
{
òò 
SqlConnection
ôô 
cn
ôô  
=
ôô! "
Conexion
ôô# +
.
ôô+ ,
	Instancia
ôô, 5
.
ôô5 6
Conectar
ôô6 >
(
ôô> ?
)
ôô? @
;
ôô@ A
cmd
öö 
=
öö 
new
öö 

SqlCommand
öö $
(
öö$ %
$str
öö% 7
,
öö7 8
cn
öö9 ;
)
öö; <
{
õõ 
CommandType
úú 
=
úú  !
CommandType
úú" -
.
úú- .
StoredProcedure
úú. =
}
ùù 
;
ùù 
cmd
ûû 
.
ûû 

Parameters
ûû 
.
ûû 
AddWithValue
ûû +
(
ûû+ ,
$str
ûû, 4
,
ûû4 5
busqueda
ûû6 >
)
ûû> ?
;
ûû? @
cn
üü 
.
üü 
Open
üü 
(
üü 
)
üü 
;
üü 
SqlDataReader
†† 
dr
††  
=
††! "
cmd
††# &
.
††& '
ExecuteReader
††' 4
(
††4 5
)
††5 6
;
††6 7
while
°° 
(
°° 
dr
°° 
.
°° 
Read
°° 
(
°° 
)
°°  
)
°°  !
{
¢¢ 
EntProducto
§§ 
Prod
§§  $
=
§§% &
new
§§' *
EntProducto
§§+ 6
{
•• 

IdProducto
¶¶ "
=
¶¶# $
Convert
¶¶% ,
.
¶¶, -
ToInt32
¶¶- 4
(
¶¶4 5
dr
¶¶5 7
[
¶¶7 8
$str
¶¶8 D
]
¶¶D E
)
¶¶E F
,
¶¶F G
Nombre
ßß 
=
ßß  
dr
ßß! #
[
ßß# $
$str
ßß$ ,
]
ßß, -
.
ßß- .
ToString
ßß. 6
(
ßß6 7
)
ßß7 8
,
ßß8 9
Longitud
®®  
=
®®! "
Convert
®®# *
.
®®* +
ToDouble
®®+ 3
(
®®3 4
dr
®®4 6
[
®®6 7
$str
®®7 A
]
®®A B
)
®®B C
,
®®C D
Diametro
©©  
=
©©! "
Convert
©©# *
.
©©* +
ToDouble
©©+ 3
(
©©3 4
dr
©©4 6
[
©©6 7
$str
©©7 A
]
©©A B
)
©©B C
,
©©C D
Stock
™™ 
=
™™ 
Convert
™™  '
.
™™' (
ToInt32
™™( /
(
™™/ 0
dr
™™0 2
[
™™2 3
$str
™™3 :
]
™™: ;
)
™™; <
,
™™< =
Activo
´´ 
=
´´  
Convert
´´! (
.
´´( )
	ToBoolean
´´) 2
(
´´2 3
dr
´´3 5
[
´´5 6
$str
´´6 >
]
´´> ?
)
´´? @
,
´´@ A
PrecioVenta
¨¨ #
=
¨¨$ %
Convert
¨¨& -
.
¨¨- .
ToDouble
¨¨. 6
(
¨¨6 7
dr
¨¨7 9
[
¨¨9 :
$str
¨¨: G
]
¨¨G H
)
¨¨H I
,
¨¨I J
Tipo
≠≠ 
=
≠≠ 
new
≠≠ "
EntTipoProducto
≠≠# 2
{
ÆÆ 
Nombre
ØØ "
=
ØØ# $
dr
ØØ% '
[
ØØ' (
$str
ØØ( .
]
ØØ. /
.
ØØ/ 0
ToString
ØØ0 8
(
ØØ8 9
)
ØØ9 :
}
∞∞ 
}
±± 
;
±± 
lista
≥≥ 
.
≥≥ 
Add
≥≥ 
(
≥≥ 
Prod
≥≥ "
)
≥≥" #
;
≥≥# $
}
¥¥ 
}
µµ 
catch
∂∂ 
(
∂∂ 
	Exception
∂∂ 
e
∂∂ 
)
∂∂ 
{
∑∑ 

MessageBox
ππ 
.
ππ 
Show
ππ 
(
ππ  
e
ππ  !
.
ππ! "
Message
ππ" )
)
ππ) *
;
ππ* +
}
∫∫ 
return
ªª 
lista
ªª 
;
ªª 
}
ºº 	
public
ææ 
EntProducto
ææ 
BuscarProductoId
ææ +
(
ææ+ ,
int
ææ, /
idprod
ææ0 6
)
ææ6 7
{
øø 	

SqlCommand
¿¿ 
cmd
¿¿ 
=
¿¿ 
null
¿¿ !
;
¿¿! "
EntProducto
¡¡ 
Prod
¡¡ 
=
¡¡ 
new
¡¡ "
EntProducto
¡¡# .
(
¡¡. /
)
¡¡/ 0
;
¡¡0 1
try
¬¬ 
{
√√ 
SqlConnection
ƒƒ 
cn
ƒƒ  
=
ƒƒ! "
Conexion
ƒƒ# +
.
ƒƒ+ ,
	Instancia
ƒƒ, 5
.
ƒƒ5 6
Conectar
ƒƒ6 >
(
ƒƒ> ?
)
ƒƒ? @
;
ƒƒ@ A
cmd
≈≈ 
=
≈≈ 
new
≈≈ 

SqlCommand
≈≈ $
(
≈≈$ %
$str
≈≈% 9
,
≈≈9 :
cn
≈≈; =
)
≈≈= >
{
∆∆ 
CommandType
«« 
=
««  !
CommandType
««" -
.
««- .
StoredProcedure
««. =
}
»» 
;
»» 
cmd
…… 
.
…… 

Parameters
…… 
.
…… 
AddWithValue
…… +
(
……+ ,
$str
……, ?
,
……? @
idprod
……A G
)
……G H
;
……H I
cn
   
.
   
Open
   
(
   
)
   
;
   
SqlDataReader
ÀÀ 
dr
ÀÀ  
=
ÀÀ! "
cmd
ÀÀ# &
.
ÀÀ& '
ExecuteReader
ÀÀ' 4
(
ÀÀ4 5
)
ÀÀ5 6
;
ÀÀ6 7
while
ÃÃ 
(
ÃÃ 
dr
ÃÃ 
.
ÃÃ 
Read
ÃÃ 
(
ÃÃ 
)
ÃÃ  
)
ÃÃ  !
{
ÕÕ 
Prod
–– 
.
–– 

IdProducto
–– #
=
––$ %
Convert
––& -
.
––- .
ToInt32
––. 5
(
––5 6
dr
––6 8
[
––8 9
$str
––9 E
]
––E F
)
––F G
;
––G H
Prod
—— 
.
—— 
Nombre
—— 
=
——  !
dr
——" $
[
——$ %
$str
——% -
]
——- .
.
——. /
ToString
——/ 7
(
——7 8
)
——8 9
;
——9 :
Prod
““ 
.
““ 
Longitud
““ !
=
““" #
Convert
““$ +
.
““+ ,
ToDouble
““, 4
(
““4 5
dr
““5 7
[
““7 8
$str
““8 B
]
““B C
)
““C D
;
““D E
Prod
”” 
.
”” 
Diametro
”” !
=
””" #
Convert
””$ +
.
””+ ,
ToDouble
””, 4
(
””4 5
dr
””5 7
[
””7 8
$str
””8 B
]
””B C
)
””C D
;
””D E
Prod
‘‘ 
.
‘‘ 
PrecioVenta
‘‘ $
=
‘‘% &
Convert
‘‘' .
.
‘‘. /
ToDouble
‘‘/ 7
(
‘‘7 8
dr
‘‘8 :
[
‘‘: ;
$str
‘‘; H
]
‘‘H I
)
‘‘I J
;
‘‘J K
Prod
’’ 
.
’’ 
Activo
’’ 
=
’’  !
Convert
’’" )
.
’’) *
	ToBoolean
’’* 3
(
’’3 4
dr
’’4 6
[
’’6 7
$str
’’7 ?
]
’’? @
)
’’@ A
;
’’A B
Prod
÷÷ 
.
÷÷ 
Tipo
÷÷ 
=
÷÷ 
new
÷÷  #
EntTipoProducto
÷÷$ 3
{
◊◊ 
IdTipo_producto
ÿÿ '
=
ÿÿ( )
Convert
ÿÿ* 1
.
ÿÿ1 2
ToInt32
ÿÿ2 9
(
ÿÿ9 :
dr
ÿÿ: <
[
ÿÿ< =
$str
ÿÿ= N
]
ÿÿN O
)
ÿÿO P
,
ÿÿP Q
Nombre
ŸŸ 
=
ŸŸ  
dr
ŸŸ! #
[
ŸŸ# $
$str
ŸŸ$ *
]
ŸŸ* +
.
ŸŸ+ ,
ToString
ŸŸ, 4
(
ŸŸ4 5
)
ŸŸ5 6
}
€€ 
;
€€ 
}
›› 
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
	Exception
ﬂﬂ 
e
ﬂﬂ 
)
ﬂﬂ 
{
‡‡ 

MessageBox
‚‚ 
.
‚‚ 
Show
‚‚ 
(
‚‚  
e
‚‚  !
.
‚‚! "
Message
‚‚" )
)
‚‚) *
;
‚‚* +
}
„„ 
return
‰‰ 
Prod
‰‰ 
;
‰‰ 
}
ÂÂ 	
public
ËË 
List
ËË 
<
ËË "
EntProveedorProducto
ËË (
>
ËË( )
Ordenar
ËË* 1
(
ËË1 2
int
ËË2 5
dato
ËË6 :
)
ËË: ;
{
ÈÈ 	
List
ÍÍ 
<
ÍÍ "
EntProveedorProducto
ÍÍ %
>
ÍÍ% &
lista
ÍÍ' ,
=
ÍÍ- .
new
ÍÍ/ 2
List
ÍÍ3 7
<
ÍÍ7 8"
EntProveedorProducto
ÍÍ8 L
>
ÍÍL M
(
ÍÍM N
)
ÍÍN O
;
ÍÍO P

SqlCommand
ÎÎ 
cmd
ÎÎ 
=
ÎÎ 
null
ÎÎ !
;
ÎÎ! "
try
ÏÏ 
{
ÌÌ 
SqlConnection
ÓÓ 
cn
ÓÓ  
=
ÓÓ! "
Conexion
ÓÓ# +
.
ÓÓ+ ,
	Instancia
ÓÓ, 5
.
ÓÓ5 6
Conectar
ÓÓ6 >
(
ÓÓ> ?
)
ÓÓ? @
;
ÓÓ@ A
cmd
ÔÔ 
=
ÔÔ 
new
ÔÔ 

SqlCommand
ÔÔ $
(
ÔÔ$ %
$str
ÔÔ% 8
,
ÔÔ8 9
cn
ÔÔ: <
)
ÔÔ< =
{
 
CommandType
ÒÒ 
=
ÒÒ  !
CommandType
ÒÒ" -
.
ÒÒ- .
StoredProcedure
ÒÒ. =
}
ÚÚ 
;
ÚÚ 
cmd
ÛÛ 
.
ÛÛ 

Parameters
ÛÛ 
.
ÛÛ 
AddWithValue
ÛÛ +
(
ÛÛ+ ,
$str
ÛÛ, 3
,
ÛÛ3 4
dato
ÛÛ5 9
)
ÛÛ9 :
;
ÛÛ: ;
cn
ÙÙ 
.
ÙÙ 
Open
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
SqlDataReader
ıı 
dr
ıı  
=
ıı! "
cmd
ıı# &
.
ıı& '
ExecuteReader
ıı' 4
(
ıı4 5
)
ıı5 6
;
ıı6 7
while
ˆˆ 
(
ˆˆ 
dr
ˆˆ 
.
ˆˆ 
Read
ˆˆ 
(
ˆˆ 
)
ˆˆ  
)
ˆˆ  !
{
˜˜ "
EntProveedorProducto
¯¯ (
Prod
¯¯) -
=
¯¯. /
new
¯¯0 3"
EntProveedorProducto
¯¯4 H
{
˘˘ 
PrecioCompra
˙˙ $
=
˙˙% &
Convert
˙˙' .
.
˙˙. /
ToDouble
˙˙/ 7
(
˙˙7 8
dr
˙˙8 :
[
˙˙: ;
$str
˙˙; I
]
˙˙I J
)
˙˙J K
,
˙˙K L
Producto
¸¸  
=
¸¸! "
new
¸¸# &
EntProducto
¸¸' 2
{
˝˝ 

IdProducto
˛˛ &
=
˛˛' (
Convert
˛˛) 0
.
˛˛0 1
ToInt32
˛˛1 8
(
˛˛8 9
dr
˛˛9 ;
[
˛˛; <
$str
˛˛< H
]
˛˛H I
)
˛˛I J
,
˛˛J K
Nombre
ˇˇ "
=
ˇˇ# $
dr
ˇˇ% '
[
ˇˇ' (
$str
ˇˇ( 0
]
ˇˇ0 1
.
ˇˇ1 2
ToString
ˇˇ2 :
(
ˇˇ: ;
)
ˇˇ; <
,
ˇˇ< =
Longitud
ÄÄ $
=
ÄÄ% &
Convert
ÄÄ' .
.
ÄÄ. /
ToDouble
ÄÄ/ 7
(
ÄÄ7 8
dr
ÄÄ8 :
[
ÄÄ: ;
$str
ÄÄ; E
]
ÄÄE F
)
ÄÄF G
,
ÄÄG H
PrecioVenta
ÅÅ '
=
ÅÅ( )
Convert
ÅÅ* 1
.
ÅÅ1 2
ToDouble
ÅÅ2 :
(
ÅÅ: ;
dr
ÅÅ; =
[
ÅÅ= >
$str
ÅÅ> K
]
ÅÅK L
)
ÅÅL M
,
ÅÅM N
Stock
ÇÇ !
=
ÇÇ" #
Convert
ÇÇ$ +
.
ÇÇ+ ,
ToInt32
ÇÇ, 3
(
ÇÇ3 4
dr
ÇÇ4 6
[
ÇÇ6 7
$str
ÇÇ7 >
]
ÇÇ> ?
)
ÇÇ? @
,
ÇÇ@ A
Tipo
ÉÉ  
=
ÉÉ! "
new
ÉÉ# &
EntTipoProducto
ÉÉ' 6
{
ÑÑ 
IdTipo_producto
ÖÖ  /
=
ÖÖ0 1
Convert
ÖÖ2 9
.
ÖÖ9 :
ToInt32
ÖÖ: A
(
ÖÖA B
dr
ÖÖB D
[
ÖÖD E
$str
ÖÖE V
]
ÖÖV W
)
ÖÖW X
,
ÖÖX Y
Nombre
ÜÜ  &
=
ÜÜ' (
dr
ÜÜ) +
[
ÜÜ+ ,
$str
ÜÜ, 2
]
ÜÜ2 3
.
ÜÜ3 4
ToString
ÜÜ4 <
(
ÜÜ< =
)
ÜÜ= >
}
áá 
}
àà 
}
ââ 
;
ââ 
lista
åå 
.
åå 
Add
åå 
(
åå 
Prod
åå "
)
åå" #
;
åå# $
}
çç 
}
éé 
catch
èè 
(
èè 
	Exception
èè 
e
èè 
)
èè 
{
êê 

MessageBox
íí 
.
íí 
Show
íí 
(
íí  
e
íí  !
.
íí! "
Message
íí" )
)
íí) *
;
íí* +
}
ìì 
return
îî 
lista
îî 
;
îî 
}
ïï 	
}
òò 
<<<<<<< HEAD
}ôô ˆÁ
OD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProveedor.cs
=======
}ôô ÑË
]C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProveedor.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatProveedor 
: 
IDatProveedor  -
{ 
private 
static 
readonly 
DatProveedor  ,
	_instance- 6
=7 8
new9 <
DatProveedor= I
(I J
)J K
;K L
public 
static 
DatProveedor "
	Instancia# ,
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
bool 
CrearProveedor "
(" #
EntProveedor# /
pro0 3
)3 4
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 7
,7 8
cn9 ;
); <
;< =
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
pro< ?
.? @
RazonSocial@ K
)K L
;L M
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 2
,2 3
pro4 7
.7 8
Ruc8 ;
); <
;< =
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 5
,  5 6
pro  7 :
.  : ;
Correo  ; A
)  A B
;  B C
cmd!! 
.!! 

Parameters!! 
.!! 
AddWithValue!! +
(!!+ ,
$str!!, 7
,!!7 8
pro!!9 <
.!!< =
Telefono!!= E
)!!E F
;!!F G
cmd"" 
."" 

Parameters"" 
."" 
AddWithValue"" +
(""+ ,
$str"", :
,"": ;
pro""< ?
.""? @
Descripcion""@ K
)""K L
;""L M
cmd## 
.## 

Parameters## 
.## 
AddWithValue## +
(##+ ,
$str##, ;
,##; <
pro##= @
.##@ A
EstProveedor##A M
)##M N
;##N O
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
AddWithValue$$ +
($$+ ,
$str$$, 7
,$$7 8
pro$$9 <
.$$< =
Ubigeo$$= C
.$$C D
IdUbigeo$$D L
)$$L M
;$$M N
cn%% 
.%% 
Open%% 
(%% 
)%% 
;%% 
int&& 
i&& 
=&& 
cmd&& 
.&& 
ExecuteNonQuery&& +
(&&+ ,
)&&, -
;&&- .
if'' 
('' 
i'' 
>'' 
$num'' 
)'' 
{(( 
creado)) 
=)) 
true)) !
;))! "
}** 
}++ 
catch,, 
(,, 
	Exception,, 
e,, 
),, 
{-- 
throw.. 
new.. 
	Exception.. 
(..  
e..  !
...! "
Message.." )
)..) *
;..* +
}// 
return00 
creado00 
;00 
}11 	
public33 
List33 
<33 
EntProveedor33  
>33  !
ListarProveedor33" 1
(331 2
)332 3
{44 	

SqlCommand55 
cmd55 
=55 
null55 !
;55! "
List66 
<66 
EntProveedor66 
>66 
list66 #
=66$ %
new66& )
List66* .
<66. /
EntProveedor66/ ;
>66; <
(66< =
)66= >
;66> ?
try77 
{88 
SqlConnection99 
cn99  
=99! "
Conexion99# +
.99+ ,
	Instancia99, 5
.995 6
Conectar996 >
(99> ?
)99? @
;99@ A
cmd:: 
=:: 
new:: 

SqlCommand:: $
(::$ %
$str::% 8
,::8 9
cn::: <
)::< =
{;; 
CommandType<< 
=<<  !
CommandType<<" -
.<<- .
StoredProcedure<<. =
}== 
;== 
cn>> 
.>> 
Open>> 
(>> 
)>> 
;>> 
SqlDataReader?? 
dr??  
=??! "
cmd??# &
.??& '
ExecuteReader??' 4
(??4 5
)??5 6
;??6 7
while@@ 
(@@ 
dr@@ 
.@@ 
Read@@ 
(@@ 
)@@  
)@@  !
{AA 
EntProveedorBB  
proBB! $
=BB% &
newBB' *
EntProveedorBB+ 7
{CC 
IdProveedorDD #
=DD$ %
ConvertDD& -
.DD- .
ToInt32DD. 5
(DD5 6
drDD6 8
[DD8 9
$strDD9 F
]DDF G
)DDG H
,DDH I
RazonSocialEE #
=EE$ %
drEE& (
[EE( )
$strEE) 6
]EE6 7
.EE7 8
ToStringEE8 @
(EE@ A
)EEA B
,EEB C
RucFF 
=FF 
drFF  
[FF  !
$strFF! &
]FF& '
.FF' (
ToStringFF( 0
(FF0 1
)FF1 2
,FF2 3
CorreoGG 
=GG  
drGG! #
[GG# $
$strGG$ ,
]GG, -
.GG- .
ToStringGG. 6
(GG6 7
)GG7 8
,GG8 9
TelefonoHH  
=HH! "
drHH# %
[HH% &
$strHH& 0
]HH0 1
.HH1 2
ToStringHH2 :
(HH: ;
)HH; <
,HH< =
DescripcionII #
=II$ %
drII& (
[II( )
$strII) 6
]II6 7
.II7 8
ToStringII8 @
(II@ A
)IIA B
,IIB C
EstProveedorJJ $
=JJ% &
ConvertJJ' .
.JJ. /
	ToBooleanJJ/ 8
(JJ8 9
drJJ9 ;
[JJ; <
$strJJ< J
]JJJ K
)JJK L
}KK 
;KK 
	EntUbigeoMM 
ubiMM !
=MM" #
newMM$ '
	EntUbigeoMM( 1
{NN 
DepartamentoOO $
=OO% &
drOO' )
[OO) *
$strOO* 8
]OO8 9
.OO9 :
ToStringOO: B
(OOB C
)OOC D
,OOD E
	ProvinciaPP !
=PP" #
drPP$ &
[PP& '
$strPP' 2
]PP2 3
.PP3 4
ToStringPP4 <
(PP< =
)PP= >
,PP> ?
DistritoQQ  
=QQ! "
drQQ# %
[QQ% &
$strQQ& 0
]QQ0 1
.QQ1 2
ToStringQQ2 :
(QQ: ;
)QQ; <
}RR 
;RR 
proTT 
.TT 
UbigeoTT 
=TT  
ubiTT! $
;TT$ %
listUU 
.UU 
AddUU 
(UU 
proUU  
)UU  !
;UU! "
}VV 
}WW 
catchXX 
(XX 
	ExceptionXX 
eXX 
)XX 
{YY 

MessageBox[[ 
.[[ 
Show[[ 
([[  
e[[  !
.[[! "
Message[[" )
+[[* +
$str[[, >
)[[> ?
;[[? @
}\\ 
return]] 
list]] 
;]] 
}^^ 	
public`` 
List`` 
<`` 
EntProveedor``  
>``  !
SelectListProveedor``" 5
(``5 6
)``6 7
{aa 	

SqlCommandbb 
cmdbb 
=bb 
nullbb !
;bb! "
varcc 
listcc 
=cc 
newcc 
Listcc 
<cc  
EntProveedorcc  ,
>cc, -
(cc- .
)cc. /
;cc/ 0
trydd 
{ee 
SqlConnectionff 
cnff  
=ff! "
Conexionff# +
.ff+ ,
	Instanciaff, 5
.ff5 6
Conectarff6 >
(ff> ?
)ff? @
;ff@ A
cmdgg 
=gg 
newgg 

SqlCommandgg $
(gg$ %
$strgg% <
,gg< =
cngg> @
)gg@ A
{hh 
CommandTypeii 
=ii  !
CommandTypeii" -
.ii- .
StoredProcedureii. =
}jj 
;jj 
cnkk 
.kk 
Openkk 
(kk 
)kk 
;kk 
SqlDataReaderll 
drll  
=ll! "
cmdll# &
.ll& '
ExecuteReaderll' 4
(ll4 5
)ll5 6
;ll6 7
whilemm 
(mm 
drmm 
.mm 
Readmm 
(mm 
)mm  
)mm  !
{nn 
EntProveedoroo  
prooo! $
=oo% &
newoo' *
EntProveedoroo+ 7
{pp 
IdProveedorqq #
=qq$ %
Convertqq& -
.qq- .
ToInt32qq. 5
(qq5 6
drqq6 8
[qq8 9
$strqq9 F
]qqF G
)qqG H
,qqH I
RazonSocialrr #
=rr$ %
drrr& (
[rr( )
$strrr) 6
]rr6 7
.rr7 8
ToStringrr8 @
(rr@ A
)rrA B
,rrB C
Descripcionss #
=ss$ %
drss& (
[ss( )
$strss) 6
]ss6 7
.ss7 8
ToStringss8 @
(ss@ A
)ssA B
,ssB C
}tt 
;tt 
listuu 
.uu 
Adduu 
(uu 
prouu  
)uu  !
;uu! "
}vv 
}ww 
catchxx 
(xx 
	Exceptionxx 
exx 
)xx 
{yy 

MessageBox{{ 
.{{ 
Show{{ 
({{  
e{{  !
.{{! "
Message{{" )
+{{* +
$str{{, >
){{> ?
;{{? @
}|| 
return}} 
list}} 
;}} 
} 	
public
ÅÅ 
bool
ÅÅ !
ActualizarProveedor
ÅÅ '
(
ÅÅ' (
EntProveedor
ÅÅ( 4
pro
ÅÅ5 8
)
ÅÅ8 9
{
ÇÇ 	

SqlCommand
ÉÉ 
cmd
ÉÉ 
=
ÉÉ 
null
ÉÉ !
;
ÉÉ! "
bool
ÑÑ 
actualizado
ÑÑ 
=
ÑÑ 
false
ÑÑ $
;
ÑÑ$ %
try
ÖÖ 
{
ÜÜ 
SqlConnection
áá 
cn
áá  
=
áá! "
Conexion
áá# +
.
áá+ ,
	Instancia
áá, 5
.
áá5 6
Conectar
áá6 >
(
áá> ?
)
áá? @
;
áá@ A
cmd
àà 
=
àà 
new
àà 

SqlCommand
àà $
(
àà$ %
$str
àà% <
,
àà< =
cn
àà> @
)
àà@ A
{
ââ 
CommandType
ää 
=
ää  !
CommandType
ää" -
.
ää- .
StoredProcedure
ää. =
}
ãã 
;
ãã 
cmd
åå 
.
åå 

Parameters
åå 
.
åå 
AddWithValue
åå +
(
åå+ ,
$str
åå, :
,
åå: ;
pro
åå< ?
.
åå? @
IdProveedor
åå@ K
)
ååK L
;
ååL M
cmd
çç 
.
çç 

Parameters
çç 
.
çç 
AddWithValue
çç +
(
çç+ ,
$str
çç, :
,
çç: ;
pro
çç< ?
.
çç? @
RazonSocial
çç@ K
)
ççK L
;
ççL M
cmd
éé 
.
éé 

Parameters
éé 
.
éé 
AddWithValue
éé +
(
éé+ ,
$str
éé, 2
,
éé2 3
pro
éé4 7
.
éé7 8
Ruc
éé8 ;
)
éé; <
;
éé< =
cmd
èè 
.
èè 

Parameters
èè 
.
èè 
AddWithValue
èè +
(
èè+ ,
$str
èè, 5
,
èè5 6
pro
èè7 :
.
èè: ;
Correo
èè; A
)
èèA B
;
èèB C
cmd
êê 
.
êê 

Parameters
êê 
.
êê 
AddWithValue
êê +
(
êê+ ,
$str
êê, 7
,
êê7 8
pro
êê9 <
.
êê< =
Telefono
êê= E
)
êêE F
;
êêF G
cmd
ëë 
.
ëë 

Parameters
ëë 
.
ëë 
AddWithValue
ëë +
(
ëë+ ,
$str
ëë, :
,
ëë: ;
pro
ëë< ?
.
ëë? @
Descripcion
ëë@ K
)
ëëK L
;
ëëL M
cmd
íí 
.
íí 

Parameters
íí 
.
íí 
AddWithValue
íí +
(
íí+ ,
$str
íí, ;
,
íí; <
pro
íí= @
.
íí@ A
EstProveedor
ííA M
)
ííM N
;
ííN O
cmd
ìì 
.
ìì 

Parameters
ìì 
.
ìì 
AddWithValue
ìì +
(
ìì+ ,
$str
ìì, 7
,
ìì7 8
pro
ìì9 <
.
ìì< =
Ubigeo
ìì= C
.
ììC D
IdUbigeo
ììD L
)
ììL M
;
ììM N
cn
îî 
.
îî 
Open
îî 
(
îî 
)
îî 
;
îî 
int
ïï 
i
ïï 
=
ïï 
cmd
ïï 
.
ïï 
ExecuteNonQuery
ïï +
(
ïï+ ,
)
ïï, -
;
ïï- .
if
ññ 
(
ññ 
i
ññ 
>
ññ 
$num
ññ 
)
ññ 
{
óó 
actualizado
òò 
=
òò  !
true
òò" &
;
òò& '
}
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
e
õõ 
)
õõ 
{
úú 
throw
ûû 
new
ûû 
	Exception
ûû #
(
ûû# $
e
ûû$ %
.
ûû% &
Message
ûû& -
)
ûû- .
;
ûû. /
}
üü 
return
°° 
actualizado
°° 
;
°° 
}
¢¢ 	
public
§§ 
bool
§§ 
EliminarProveedor
§§ %
(
§§% &
int
§§& )
idProveedor
§§* 5
)
§§5 6
{
•• 	

SqlCommand
¶¶ 
cmd
¶¶ 
=
¶¶ 
null
¶¶ !
;
¶¶! "
bool
ßß 
	eliminado
ßß 
=
ßß 
false
ßß "
;
ßß" #
try
®® 
{
©© 
SqlConnection
™™ 
cn
™™  
=
™™! "
Conexion
™™# +
.
™™+ ,
	Instancia
™™, 5
.
™™5 6
Conectar
™™6 >
(
™™> ?
)
™™? @
;
™™@ A
cmd
´´ 
=
´´ 
new
´´ 

SqlCommand
´´ $
(
´´$ %
$str
´´% :
,
´´: ;
cn
´´< >
)
´´> ?
;
´´? @
cmd
¨¨ 
.
¨¨ 
CommandType
¨¨ 
=
¨¨  !
CommandType
¨¨" -
.
¨¨- .
StoredProcedure
¨¨. =
;
¨¨= >
cmd
≠≠ 
.
≠≠ 

Parameters
≠≠ 
.
≠≠ 
AddWithValue
≠≠ +
(
≠≠+ ,
$str
≠≠, :
,
≠≠: ;
idProveedor
≠≠< G
)
≠≠G H
;
≠≠H I
cn
ÆÆ 
.
ÆÆ 
Open
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
int
ØØ 
i
ØØ 
=
ØØ 
cmd
ØØ 
.
ØØ 
ExecuteNonQuery
ØØ +
(
ØØ+ ,
)
ØØ, -
;
ØØ- .
if
∞∞ 
(
∞∞ 
i
∞∞ 
>
∞∞ 
$num
∞∞ 
)
∞∞ 
{
±± 
	eliminado
≤≤ 
=
≤≤ 
true
≤≤  $
;
≤≤$ %
}
≥≥ 
}
¥¥ 
catch
µµ 
(
µµ 
	Exception
µµ 
e
µµ 
)
µµ 
{
∂∂ 

MessageBox
∏∏ 
.
∏∏ 
Show
∏∏ 
(
∏∏  
e
∏∏  !
.
∏∏! "
Message
∏∏" )
)
∏∏) *
;
∏∏* +
}
ππ 
return
∫∫ 
	eliminado
∫∫ 
;
∫∫ 
}
ªª 	
public
ΩΩ 
List
ΩΩ 
<
ΩΩ 
EntProveedor
ΩΩ  
>
ΩΩ  !$
SelectListProveedordat
ΩΩ" 8
(
ΩΩ8 9
int
ΩΩ9 <
idprov
ΩΩ= C
)
ΩΩC D
{
ææ 	

SqlCommand
øø 
cmd
øø 
=
øø 
null
øø !
;
øø! "
var
¿¿ 
list
¿¿ 
=
¿¿ 
new
¿¿ 
List
¿¿ 
<
¿¿  
EntProveedor
¿¿  ,
>
¿¿, -
(
¿¿- .
)
¿¿. /
;
¿¿/ 0
try
¡¡ 
{
¬¬ 
SqlConnection
√√ 
cn
√√  
=
√√! "
Conexion
√√# +
.
√√+ ,
	Instancia
√√, 5
.
√√5 6
Conectar
√√6 >
(
√√> ?
)
√√? @
;
√√@ A
cmd
ƒƒ 
=
ƒƒ 
new
ƒƒ 

SqlCommand
ƒƒ $
(
ƒƒ$ %
$str
ƒƒ% ?
,
ƒƒ? @
cn
ƒƒA C
)
ƒƒC D
{
≈≈ 
CommandType
∆∆ 
=
∆∆  !
CommandType
∆∆" -
.
∆∆- .
StoredProcedure
∆∆. =
,
∆∆= >
}
«« 
;
«« 
cmd
»» 
.
»» 

Parameters
»» 
.
»» 
AddWithValue
»» +
(
»»+ ,
$str
»», 3
,
»»3 4
idprov
»»4 :
)
»»: ;
;
»»; <
cn
…… 
.
…… 
Open
…… 
(
…… 
)
…… 
;
…… 
SqlDataReader
   
dr
    
=
  ! "
cmd
  # &
.
  & '
ExecuteReader
  ' 4
(
  4 5
)
  5 6
;
  6 7
while
ÀÀ 
(
ÀÀ 
dr
ÀÀ 
.
ÀÀ 
Read
ÀÀ 
(
ÀÀ 
)
ÀÀ  
)
ÀÀ  !
{
ÃÃ 
EntProveedor
ÕÕ  
pro
ÕÕ! $
=
ÕÕ% &
new
ÕÕ' *
EntProveedor
ÕÕ+ 7
{
ŒŒ 
IdProveedor
œœ #
=
œœ$ %
Convert
œœ& -
.
œœ- .
ToInt32
œœ. 5
(
œœ5 6
dr
œœ6 8
[
œœ8 9
$str
œœ9 F
]
œœF G
)
œœG H
,
œœH I
RazonSocial
–– #
=
––$ %
dr
––& (
[
––( )
$str
––) 6
]
––6 7
.
––7 8
ToString
––8 @
(
––@ A
)
––A B
,
––B C
Descripcion
—— #
=
——$ %
dr
——& (
[
——( )
$str
——) 6
]
——6 7
.
——7 8
ToString
——8 @
(
——@ A
)
——A B
,
——B C
}
““ 
;
““ 
list
”” 
.
”” 
Add
”” 
(
”” 
pro
””  
)
””  !
;
””! "
}
‘‘ 
}
’’ 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
e
÷÷ 
)
÷÷ 
{
◊◊ 

MessageBox
ŸŸ 
.
ŸŸ 
Show
ŸŸ 
(
ŸŸ  
e
ŸŸ  !
.
ŸŸ! "
Message
ŸŸ" )
+
ŸŸ* +
$str
ŸŸ, >
)
ŸŸ> ?
;
ŸŸ? @
}
⁄⁄ 
return
€€ 
list
€€ 
;
€€ 
}
›› 	
public
ﬂﬂ 
List
ﬂﬂ 
<
ﬂﬂ 
EntProveedor
ﬂﬂ  
>
ﬂﬂ  !
BuscarProveedor
ﬂﬂ" 1
(
ﬂﬂ1 2
string
ﬂﬂ2 8
busqueda
ﬂﬂ9 A
)
ﬂﬂA B
{
‡‡ 	
List
·· 
<
·· 
EntProveedor
·· 
>
·· 
list
·· #
=
··$ %
new
··& )
List
··* .
<
··. /
EntProveedor
··/ ;
>
··; <
(
··< =
)
··= >
;
··> ?

SqlCommand
‚‚ 
cmd
‚‚ 
=
‚‚ 
null
‚‚ !
;
‚‚! "
try
„„ 
{
‰‰ 
SqlConnection
ÂÂ 
cn
ÂÂ  
=
ÂÂ! "
Conexion
ÂÂ# +
.
ÂÂ+ ,
	Instancia
ÂÂ, 5
.
ÂÂ5 6
Conectar
ÂÂ6 >
(
ÂÂ> ?
)
ÂÂ? @
;
ÂÂ@ A
cmd
ÊÊ 
=
ÊÊ 
new
ÊÊ 

SqlCommand
ÊÊ $
(
ÊÊ$ %
$str
ÊÊ% 8
,
ÊÊ8 9
cn
ÊÊ: <
)
ÊÊ< =
;
ÊÊ= >
cmd
ÁÁ 
.
ÁÁ 
CommandType
ÁÁ 
=
ÁÁ  !
CommandType
ÁÁ" -
.
ÁÁ- .
StoredProcedure
ÁÁ. =
;
ÁÁ= >
cmd
ËË 
.
ËË 

Parameters
ËË 
.
ËË 
AddWithValue
ËË +
(
ËË+ ,
$str
ËË, 4
,
ËË4 5
busqueda
ËË6 >
)
ËË> ?
;
ËË? @
cn
ÈÈ 
.
ÈÈ 
Open
ÈÈ 
(
ÈÈ 
)
ÈÈ 
;
ÈÈ 
SqlDataReader
ÍÍ 
dr
ÍÍ  
=
ÍÍ! "
cmd
ÍÍ# &
.
ÍÍ& '
ExecuteReader
ÍÍ' 4
(
ÍÍ4 5
)
ÍÍ5 6
;
ÍÍ6 7
while
ÎÎ 
(
ÎÎ 
dr
ÎÎ 
.
ÎÎ 
Read
ÎÎ 
(
ÎÎ 
)
ÎÎ  
)
ÎÎ  !
{
ÏÏ 
EntProveedor
ÌÌ  
pro
ÌÌ! $
=
ÌÌ% &
new
ÌÌ' *
EntProveedor
ÌÌ+ 7
{
ÓÓ 
IdProveedor
ÔÔ #
=
ÔÔ$ %
Convert
ÔÔ& -
.
ÔÔ- .
ToInt32
ÔÔ. 5
(
ÔÔ5 6
dr
ÔÔ6 8
[
ÔÔ8 9
$str
ÔÔ9 F
]
ÔÔF G
)
ÔÔG H
,
ÔÔH I
RazonSocial
 #
=
$ %
dr
& (
[
( )
$str
) 6
]
6 7
.
7 8
ToString
8 @
(
@ A
)
A B
,
B C
Ruc
ÒÒ 
=
ÒÒ 
dr
ÒÒ  
[
ÒÒ  !
$str
ÒÒ! &
]
ÒÒ& '
.
ÒÒ' (
ToString
ÒÒ( 0
(
ÒÒ0 1
)
ÒÒ1 2
,
ÒÒ2 3
Correo
ÚÚ 
=
ÚÚ  
dr
ÚÚ! #
[
ÚÚ# $
$str
ÚÚ$ ,
]
ÚÚ, -
.
ÚÚ- .
ToString
ÚÚ. 6
(
ÚÚ6 7
)
ÚÚ7 8
,
ÚÚ8 9
Telefono
ÛÛ  
=
ÛÛ! "
dr
ÛÛ# %
[
ÛÛ% &
$str
ÛÛ& 0
]
ÛÛ0 1
.
ÛÛ1 2
ToString
ÛÛ2 :
(
ÛÛ: ;
)
ÛÛ; <
,
ÛÛ< =
Descripcion
ÙÙ #
=
ÙÙ$ %
dr
ÙÙ& (
[
ÙÙ( )
$str
ÙÙ) 6
]
ÙÙ6 7
.
ÙÙ7 8
ToString
ÙÙ8 @
(
ÙÙ@ A
)
ÙÙA B
,
ÙÙB C
EstProveedor
ıı $
=
ıı% &
Convert
ıı' .
.
ıı. /
	ToBoolean
ıı/ 8
(
ıı8 9
dr
ıı9 ;
[
ıı; <
$str
ıı< J
]
ııJ K
)
ııK L
,
ııL M
Ubigeo
ˆˆ 
=
ˆˆ 
new
ˆˆ "
	EntUbigeo
ˆˆ# ,
{
ˆˆ- .
Departamento
˜˜ (
=
˜˜) *
dr
˜˜+ -
[
˜˜- .
$str
˜˜. <
]
˜˜< =
.
˜˜= >
ToString
˜˜> F
(
˜˜F G
)
˜˜G H
,
˜˜H I
	Provincia
¯¯ %
=
¯¯& '
dr
¯¯( *
[
¯¯* +
$str
¯¯+ 6
]
¯¯6 7
.
¯¯7 8
ToString
¯¯8 @
(
¯¯@ A
)
¯¯A B
,
¯¯B C
Distrito
˘˘ $
=
˘˘% &
dr
˘˘' )
[
˘˘) *
$str
˘˘* 4
]
˘˘4 5
.
˘˘5 6
ToString
˘˘6 >
(
˘˘> ?
)
˘˘? @
}
˙˙ 
}
¸¸ 
;
¸¸ 
list
˝˝ 
.
˝˝ 
Add
˝˝ 
(
˝˝ 
pro
˝˝  
)
˝˝  !
;
˝˝! "
}
˛˛ 
}
ˇˇ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
e
ÄÄ 
)
ÄÄ 
{
ÅÅ 

MessageBox
ÉÉ 
.
ÉÉ 
Show
ÉÉ 
(
ÉÉ  
e
ÉÉ  !
.
ÉÉ! "
Message
ÉÉ" )
)
ÉÉ) *
;
ÉÉ* +
}
ÑÑ 
return
ÖÖ 
list
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
public
áá 
EntProveedor
áá 
BuscarIdProveedor
áá -
(
áá- .
int
áá. 1
idProveedor
áá2 =
)
áá= >
{
àà 	

SqlCommand
ââ 
cmd
ââ 
=
ââ 
null
ââ !
;
ââ! "
EntProveedor
ää 
pro
ää 
=
ää 
new
ää "
EntProveedor
ää# /
(
ää/ 0
)
ää0 1
;
ää1 2
try
ãã 
{
åå 
SqlConnection
çç 
cn
çç  
=
çç! "
Conexion
çç# +
.
çç+ ,
	Instancia
çç, 5
.
çç5 6
Conectar
çç6 >
(
çç> ?
)
çç? @
;
çç@ A
cmd
éé 
=
éé 
new
éé 

SqlCommand
éé $
(
éé$ %
$str
éé% :
,
éé: ;
cn
éé< >
)
éé> ?
;
éé? @
cmd
èè 
.
èè 
CommandType
èè 
=
èè  !
CommandType
èè" -
.
èè- .
StoredProcedure
èè. =
;
èè= >
cmd
êê 
.
êê 

Parameters
êê 
.
êê 
AddWithValue
êê +
(
êê+ ,
$str
êê, :
,
êê: ;
idProveedor
êê< G
)
êêG H
;
êêH I
cn
ëë 
.
ëë 
Open
ëë 
(
ëë 
)
ëë 
;
ëë 
SqlDataReader
íí 
dr
íí  
=
íí! "
cmd
íí# &
.
íí& '
ExecuteReader
íí' 4
(
íí4 5
)
íí5 6
;
íí6 7
while
ìì 
(
ìì 
dr
ìì 
.
ìì 
Read
ìì 
(
ìì 
)
ìì  
)
ìì  !
{
îî 
pro
ïï 
.
ïï 
IdProveedor
ïï #
=
ïï$ %
Convert
ïï& -
.
ïï- .
ToInt32
ïï. 5
(
ïï5 6
dr
ïï6 8
[
ïï8 9
$str
ïï9 F
]
ïïF G
)
ïïG H
;
ïïH I
pro
ññ 
.
ññ 
RazonSocial
ññ #
=
ññ$ %
dr
ññ& (
[
ññ( )
$str
ññ) 6
]
ññ6 7
.
ññ7 8
ToString
ññ8 @
(
ññ@ A
)
ññA B
;
ññB C
pro
óó 
.
óó 
Ruc
óó 
=
óó 
dr
óó  
[
óó  !
$str
óó! &
]
óó& '
.
óó' (
ToString
óó( 0
(
óó0 1
)
óó1 2
;
óó2 3
pro
òò 
.
òò 
Correo
òò 
=
òò  
dr
òò! #
[
òò# $
$str
òò$ ,
]
òò, -
.
òò- .
ToString
òò. 6
(
òò6 7
)
òò7 8
;
òò8 9
pro
ôô 
.
ôô 
Telefono
ôô  
=
ôô! "
dr
ôô# %
[
ôô% &
$str
ôô& 0
]
ôô0 1
.
ôô1 2
ToString
ôô2 :
(
ôô: ;
)
ôô; <
;
ôô< =
pro
öö 
.
öö 
Descripcion
öö #
=
öö$ %
dr
öö& (
[
öö( )
$str
öö) 6
]
öö6 7
.
öö7 8
ToString
öö8 @
(
öö@ A
)
ööA B
;
ööB C
pro
õõ 
.
õõ 
EstProveedor
õõ $
=
õõ% &
Convert
õõ' .
.
õõ. /
	ToBoolean
õõ/ 8
(
õõ8 9
dr
õõ9 ;
[
õõ; <
$str
õõ< J
]
õõJ K
)
õõK L
;
õõL M
	EntUbigeo
úú 
ubi
úú !
=
úú" #
new
úú$ '
	EntUbigeo
úú( 1
(
úú1 2
)
úú2 3
;
úú3 4
ubi
ùù 
.
ùù 
Departamento
ùù $
=
ùù% &
dr
ùù' )
[
ùù) *
$str
ùù* 8
]
ùù8 9
.
ùù9 :
ToString
ùù: B
(
ùùB C
)
ùùC D
;
ùùD E
ubi
ûû 
.
ûû 
	Provincia
ûû !
=
ûû" #
dr
ûû$ &
[
ûû& '
$str
ûû' 2
]
ûû2 3
.
ûû3 4
ToString
ûû4 <
(
ûû< =
)
ûû= >
;
ûû> ?
ubi
üü 
.
üü 
Distrito
üü  
=
üü! "
dr
üü# %
[
üü% &
$str
üü& 0
]
üü0 1
.
üü1 2
ToString
üü2 :
(
üü: ;
)
üü; <
;
üü< =
pro
†† 
.
†† 
Ubigeo
†† 
=
††  
ubi
††! $
;
††$ %
}
°° 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
e
££ 
)
££ 
{
§§ 
throw
§§ 
e
§§ 
;
§§ 
}
§§ 
return
•• 
pro
•• 
;
•• 
}
¶¶ 	
}
©© 
<<<<<<< HEAD
}™™ Åœ
WD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProveedorProducto.cs
=======
}™™ èœ
eC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatProveedorProducto.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class  
DatProveedorProducto %
:& '!
IDatProveedorProducto( =
{ 
private 
static 
readonly  
DatProveedorProducto  4
	_instance5 >
=? @
newA D 
DatProveedorProductoE Y
(Y Z
)Z [
;[ \
public 
static  
DatProveedorProducto *
	Instancia+ 4
{ 	
get 
{ 
return 
	_instance "
;" #
}$ %
} 	
public 
bool "
CrearProveedorProducto *
(* + 
EntProveedorProducto+ ?
prod@ D
)D E
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
crear 
= 
false 
; 
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% ?
,? @
cnA C
)C D
;D E
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
prod< @
.@ A
	ProveedorA J
.J K
IdProveedorK V
)V W
;W X
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 9
,9 :
prod; ?
.? @
Producto@ H
.H I

IdProductoI S
)S T
;T U
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , ;
,  ; <
prod  = A
.  A B
PrecioCompra  B N
)  N O
;  O P
cn!! 
.!! 
Open!! 
(!! 
)!! 
;!! 
int"" 
i"" 
="" 
cmd"" 
."" 
ExecuteNonQuery"" +
(""+ ,
)"", -
;""- .
if## 
(## 
i## 
!=## 
$num## 
)## 
crear$$ 
=$$ 
true$$  
;$$  !
}&& 
catch'' 
('' 
	Exception'' 
e'' 
)'' 
{(( 

MessageBox)) 
.)) 
Show)) 
())  
e))  !
.))! "
Message))" )
,))) *
$str))+ I
,))I J
MessageBoxButtons))K \
.))\ ]
OK))] _
,))_ `
MessageBoxIcon))a o
.))o p
Error))p u
)))u v
;))v w
}** 
return++ 
crear++ 
;++ 
},, 	
public.. 
List.. 
<..  
EntProveedorProducto.. (
>..( )%
ListarProductoParaComprar..* C
(..C D
)..D E
{// 	

SqlCommand00 
cmd00 
=00 
null00 !
;00! "
List11 
<11  
EntProveedorProducto11 %
>11% &
lista11' ,
=11- .
new11/ 2
List113 7
<117 8 
EntProveedorProducto118 L
>11L M
(11M N
)11N O
;11O P
try22 
{33 
SqlConnection44 
cn44  
=44! "
Conexion44# +
.44+ ,
	Instancia44, 5
.445 6
Conectar446 >
(44> ?
)44? @
;44@ A
cmd55 
=55 
new55 

SqlCommand55 $
(55$ %
$str55% B
,55B C
cn55D F
)55F G
{66 
CommandType77 
=77  !
CommandType77" -
.77- .
StoredProcedure77. =
}88 
;88 
cn99 
.99 
Open99 
(99 
)99 
;99 
SqlDataReader:: 
dr::  
=::! "
cmd::# &
.::& '
ExecuteReader::' 4
(::4 5
)::5 6
;::6 7
while;; 
(;; 
dr;; 
.;; 
Read;; 
(;; 
);;  
);;  !
{<<  
EntProveedorProducto== (
Prod==) -
===. /
new==0 3 
EntProveedorProducto==4 H
{>> 
Producto@@  
=@@! "
new@@# &
EntProducto@@' 2
{AA 

IdProductoBB &
=BB' (
ConvertBB) 0
.BB0 1
ToInt32BB1 8
(BB8 9
drBB9 ;
[BB; <
$strBB< H
]BBH I
)BBI J
,BBJ K
NombreCC "
=CC# $
drCC% '
[CC' (
$strCC( 0
]CC0 1
.CC1 2
ToStringCC2 :
(CC: ;
)CC; <
,CC< =
LongitudDD $
=DD% &
ConvertDD' .
.DD. /
ToDoubleDD/ 7
(DD7 8
drDD8 :
[DD: ;
$strDD; E
]DDE F
)DDF G
,DDG H
DiametroEE $
=EE% &
ConvertEE' .
.EE. /
ToDoubleEE/ 7
(EE7 8
drEE8 :
[EE: ;
$strEE; E
]EEE F
)EEF G
,EEG H
StockFF !
=FF" #
ConvertFF$ +
.FF+ ,
ToInt32FF, 3
(FF3 4
drFF4 6
[FF6 7
$strFF7 >
]FF> ?
)FF? @
,FF@ A
PrecioVentaGG '
=GG( )
ConvertGG* 1
.GG1 2
ToDoubleGG2 :
(GG: ;
drGG; =
[GG= >
$strGG> K
]GGK L
)GGL M
,GGM N
ActivoHH "
=HH# $
ConvertHH% ,
.HH, -
	ToBooleanHH- 6
(HH6 7
drHH7 9
[HH9 :
$strHH: B
]HHB C
)HHC D
,HHD E
TipoJJ  
=JJ! "
newJJ# &
EntTipoProductoJJ' 6
{KK 
NombreLL  &
=LL' (
drLL) +
[LL+ ,
$strLL, 2
]LL2 3
.LL3 4
ToStringLL4 <
(LL< =
)LL= >
}NN 
}OO 
,OO 
	ProveedorPP !
=PP" #
newPP$ '
EntProveedorPP( 4
{QQ 
IdProveedorRR '
=RR( )
ConvertRR* 1
.RR1 2
ToInt32RR2 9
(RR9 :
drRR: <
[RR< =
$strRR= J
]RRJ K
)RRK L
,RRL M
RazonSocialSS '
=SS( )
drSS* ,
[SS, -
$strSS- :
]SS: ;
.SS; <
ToStringSS< D
(SSD E
)SSE F
}TT 
,TT 
PrecioCompraUU $
=UU% &
ConvertUU' .
.UU. /
ToDoubleUU/ 7
(UU7 8
drUU8 :
[UU: ;
$strUU; I
]UUI J
)UUJ K
}VV 
;VV 
listaWW 
.WW 
AddWW 
(WW 
ProdWW "
)WW" #
;WW# $
}XX 
;XX 
}ZZ 
catch[[ 
([[ 
	Exception[[ 
e[[ 
)[[ 
{\\ 

MessageBox]] 
.]] 
Show]] 
(]]  
e]]  !
.]]! "
Message]]" )
,]]) *
$str]]+ J
,]]J K
MessageBoxButtons]]L ]
.]]] ^
OK]]^ `
,]]` a
MessageBoxIcon]]b p
.]]p q
Error]]q v
)]]v w
;]]w x
}^^ 
return__ 
lista__ 
;__ 
}`` 	
publiccc 
Listcc 
<cc  
EntProveedorProductocc (
>cc( )$
MostarDetalleProveedorIdcc* B
(ccB C
intccC F
idProveedorccG R
)ccR S
{dd 	

SqlCommandee 
cmdee 
=ee 
nullee !
;ee! "
Listff 
<ff  
EntProveedorProductoff %
>ff% &
listff' +
=ff, -
newff. 1
Listff2 6
<ff6 7 
EntProveedorProductoff7 K
>ffK L
(ffL M
)ffM N
;ffN O
trygg 
{hh 
SqlConnectionii 
cnii  
=ii! "
Conexionii# +
.ii+ ,
	Instanciaii, 5
.ii5 6
Conectarii6 >
(ii> ?
)ii? @
;ii@ A
cmdjj 
=jj 
newjj 

SqlCommandjj $
(jj$ %
$strjj% B
,jjB C
cnjjD F
)jjF G
;jjG H
cmdkk 
.kk 
CommandTypekk 
=kk  !
CommandTypekk" -
.kk- .
StoredProcedurekk. =
;kk= >
cmdll 
.ll 

Parametersll 
.ll 
AddWithValuell +
(ll+ ,
$strll, :
,ll: ;
idProveedorll< G
)llG H
;llH I
cnmm 
.mm 
Openmm 
(mm 
)mm 
;mm 
SqlDataReadernn 
drnn  
=nn! "
cmdnn# &
.nn& '
ExecuteReadernn' 4
(nn4 5
)nn5 6
;nn6 7
whileoo 
(oo 
droo 
.oo 
Readoo 
(oo 
)oo  
)oo  !
{pp  
EntProveedorProductoqq (
detqq) ,
=qq- .
newqq/ 2 
EntProveedorProductoqq3 G
{rr 
	Proveedorss !
=ss" #
newss$ '
EntProveedorss( 4
{tt 
IdProveedoruu '
=uu( )
Convertuu* 1
.uu1 2
ToInt32uu2 9
(uu9 :
druu: <
[uu< =
$struu= J
]uuJ K
)uuK L
,uuL M
RazonSocialvv '
=vv( )
drvv* ,
[vv, -
$strvv- :
]vv: ;
.vv; <
ToStringvv< D
(vvD E
)vvE F
,vvF G
Descripcionww '
=ww( )
drww* ,
[ww, -
$strww- :
]ww: ;
.ww; <
ToStringww< D
(wwD E
)wwE F
}xx 
,xx 
Productoyy  
=yy! "
newyy# &
EntProductoyy' 2
{zz 

IdProducto{{ &
={{' (
Convert{{) 0
.{{0 1
ToInt32{{1 8
({{8 9
dr{{9 ;
[{{; <
$str{{< H
]{{H I
){{I J
,{{J K
Nombre|| "
=||# $
dr||% '
[||' (
$str||( 0
]||0 1
.||1 2
ToString||2 :
(||: ;
)||; <
,||< =
Longitud}} $
=}}% &
Convert}}' .
.}}. /
ToDouble}}/ 7
(}}7 8
dr}}8 :
[}}: ;
$str}}; E
]}}E F
)}}F G
,}}G H
Stock~~ !
=~~" #
Convert~~$ +
.~~+ ,
ToInt32~~, 3
(~~3 4
dr~~4 6
[~~6 7
$str~~7 >
]~~> ?
)~~? @
} 
, 
PrecioCompra
ÅÅ $
=
ÅÅ% &
Convert
ÅÅ' .
.
ÅÅ. /
ToDouble
ÅÅ/ 7
(
ÅÅ7 8
dr
ÅÅ8 :
[
ÅÅ: ;
$str
ÅÅ; I
]
ÅÅI J
)
ÅÅJ K
,
ÅÅK L
}
ÇÇ 
;
ÇÇ 
list
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
det
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
}
ÖÖ 
}
ÜÜ 
catch
áá 
(
áá 
	Exception
áá 
e
áá 
)
áá 
{
àà 
throw
àà 
e
àà 
;
àà 
}
àà 
return
ââ 
list
ââ 
;
ââ 
}
ää 	
public
åå 
bool
åå &
EliminarDetalleProveedor
åå ,
(
åå, -
int
åå- 0
prov
åå1 5
,
åå5 6
int
åå7 :
prod
åå; ?
)
åå? @
{
çç 	

SqlCommand
éé 
cmd
éé 
=
éé 
null
éé !
;
éé! "
bool
èè 
	eliminado
èè 
=
èè 
false
èè "
;
èè" #
try
êê 
{
ëë 
SqlConnection
íí 
cn
íí  
=
íí! "
Conexion
íí# +
.
íí+ ,
	Instancia
íí, 5
.
íí5 6
Conectar
íí6 >
(
íí> ?
)
íí? @
;
íí@ A
cmd
ìì 
=
ìì 
new
ìì 

SqlCommand
ìì $
(
ìì$ %
$str
ìì% A
,
ììA B
cn
ììC E
)
ììE F
;
ììF G
cmd
îî 
.
îî 
CommandType
îî 
=
îî  !
CommandType
îî" -
.
îî- .
StoredProcedure
îî. =
;
îî= >
cmd
ïï 
.
ïï 

Parameters
ïï 
.
ïï 
AddWithValue
ïï +
(
ïï+ ,
$str
ïï, :
,
ïï: ;
prov
ïï< @
)
ïï@ A
;
ïïA B
cmd
ññ 
.
ññ 

Parameters
ññ 
.
ññ 
AddWithValue
ññ +
(
ññ+ ,
$str
ññ, 9
,
ññ9 :
prod
ññ; ?
)
ññ? @
;
ññ@ A
cn
óó 
.
óó 
Open
óó 
(
óó 
)
óó 
;
óó 
int
òò 
i
òò 
=
òò 
cmd
òò 
.
òò 
ExecuteNonQuery
òò +
(
òò+ ,
)
òò, -
;
òò- .
if
ôô 
(
ôô 
i
ôô 
>
ôô 
$num
ôô 
)
ôô 
{
öö 
	eliminado
õõ 
=
õõ 
true
õõ  $
;
õõ$ %
}
úú 
}
ùù 
catch
ûû 
(
ûû 
	Exception
ûû 
e
ûû 
)
ûû 
{
üü 

MessageBox
°° 
.
°° 
Show
°° 
(
°°  
e
°°  !
.
°°! "
Message
°°" )
)
°°) *
;
°°* +
}
¢¢ 
return
££ 
	eliminado
££ 
;
££ 
}
•• 	
public
ßß 
List
ßß 
<
ßß "
EntProveedorProducto
ßß (
>
ßß( )'
BuscarProductoParaComprar
ßß* C
(
ßßC D
string
ßßD J
busqueda
ßßK S
)
ßßS T
{
®® 	
List
©© 
<
©© "
EntProveedorProducto
©© %
>
©©% &
lista
©©' ,
=
©©- .
new
©©/ 2
List
©©3 7
<
©©7 8"
EntProveedorProducto
©©8 L
>
©©L M
(
©©M N
)
©©N O
;
©©O P

SqlCommand
™™ 
cmd
™™ 
=
™™ 
null
™™ !
;
™™! "
try
´´ 
{
¨¨ 
SqlConnection
≠≠ 
cn
≠≠  
=
≠≠! "
Conexion
≠≠# +
.
≠≠+ ,
	Instancia
≠≠, 5
.
≠≠5 6
Conectar
≠≠6 >
(
≠≠> ?
)
≠≠? @
;
≠≠@ A
cmd
ÆÆ 
=
ÆÆ 
new
ÆÆ 

SqlCommand
ÆÆ $
(
ÆÆ$ %
$str
ÆÆ% B
,
ÆÆB C
cn
ÆÆD F
)
ÆÆF G
;
ÆÆG H
cmd
ØØ 
.
ØØ 
CommandType
ØØ 
=
ØØ  !
CommandType
ØØ" -
.
ØØ- .
StoredProcedure
ØØ. =
;
ØØ= >
cmd
∞∞ 
.
∞∞ 

Parameters
∞∞ 
.
∞∞ 
AddWithValue
∞∞ +
(
∞∞+ ,
$str
∞∞, 4
,
∞∞4 5
busqueda
∞∞6 >
)
∞∞> ?
;
∞∞? @
cn
±± 
.
±± 
Open
±± 
(
±± 
)
±± 
;
±± 
SqlDataReader
≤≤ 
dr
≤≤  
=
≤≤! "
cmd
≤≤# &
.
≤≤& '
ExecuteReader
≤≤' 4
(
≤≤4 5
)
≤≤5 6
;
≤≤6 7
while
≥≥ 
(
≥≥ 
dr
≥≥ 
.
≥≥ 
Read
≥≥ 
(
≥≥ 
)
≥≥  
)
≥≥  !
{
¥¥ "
EntProveedorProducto
µµ (
Prod
µµ) -
=
µµ. /
new
µµ0 3"
EntProveedorProducto
µµ4 H
{
∂∂ 
Producto
∑∑  
=
∑∑! "
new
∑∑# &
EntProducto
∑∑' 2
{
∏∏ 

IdProducto
ππ &
=
ππ' (
Convert
ππ) 0
.
ππ0 1
ToInt32
ππ1 8
(
ππ8 9
dr
ππ9 ;
[
ππ; <
$str
ππ< H
]
ππH I
)
ππI J
,
ππJ K
Nombre
∫∫ "
=
∫∫# $
dr
∫∫% '
[
∫∫' (
$str
∫∫( 0
]
∫∫0 1
.
∫∫1 2
ToString
∫∫2 :
(
∫∫: ;
)
∫∫; <
,
∫∫< =
Longitud
ªª $
=
ªª% &
Convert
ªª' .
.
ªª. /
ToDouble
ªª/ 7
(
ªª7 8
dr
ªª8 :
[
ªª: ;
$str
ªª; E
]
ªªE F
)
ªªF G
,
ªªG H
Diametro
ºº $
=
ºº% &
Convert
ºº' .
.
ºº. /
ToDouble
ºº/ 7
(
ºº7 8
dr
ºº8 :
[
ºº: ;
$str
ºº; E
]
ººE F
)
ººF G
,
ººG H
Stock
ΩΩ !
=
ΩΩ" #
Convert
ΩΩ$ +
.
ΩΩ+ ,
ToInt32
ΩΩ, 3
(
ΩΩ3 4
dr
ΩΩ4 6
[
ΩΩ6 7
$str
ΩΩ7 >
]
ΩΩ> ?
)
ΩΩ? @
,
ΩΩ@ A
PrecioVenta
ææ '
=
ææ( )
Convert
ææ* 1
.
ææ1 2
ToDouble
ææ2 :
(
ææ: ;
dr
ææ; =
[
ææ= >
$str
ææ> K
]
ææK L
)
ææL M
,
ææM N
Activo
øø "
=
øø# $
Convert
øø% ,
.
øø, -
	ToBoolean
øø- 6
(
øø6 7
dr
øø7 9
[
øø9 :
$str
øø: B
]
øøB C
)
øøC D
,
øøD E
Tipo
¿¿  
=
¿¿! "
new
¿¿# &
EntTipoProducto
¿¿' 6
{
¡¡ 
Nombre
¬¬  &
=
¬¬' (
dr
¬¬) +
[
¬¬+ ,
$str
¬¬, 2
]
¬¬2 3
.
¬¬3 4
ToString
¬¬4 <
(
¬¬< =
)
¬¬= >
}
√√ 
,
√√ 
}
ƒƒ 
,
ƒƒ 
}
≈≈ 
;
≈≈ 
if
«« 
(
«« 
dr
«« 
[
«« 
$str
«« (
]
««( )
!=
««* ,
DBNull
««- 3
.
««3 4
Value
««4 9
)
««9 :
{
»» 
Prod
…… 
.
…… 
	Proveedor
…… &
=
……' (
new
……) ,
EntProveedor
……- 9
{
   
IdProveedor
ÀÀ '
=
ÀÀ( )
Convert
ÀÀ* 1
.
ÀÀ1 2
ToInt32
ÀÀ2 9
(
ÀÀ9 :
dr
ÀÀ: <
[
ÀÀ< =
$str
ÀÀ= J
]
ÀÀJ K
)
ÀÀK L
,
ÀÀL M
RazonSocial
ÃÃ '
=
ÃÃ( )
dr
ÃÃ* ,
[
ÃÃ, -
$str
ÃÃ- :
]
ÃÃ: ;
.
ÃÃ; <
ToString
ÃÃ< D
(
ÃÃD E
)
ÃÃE F
}
ÕÕ 
;
ÕÕ 
}
ŒŒ 
if
œœ 
(
œœ 
dr
œœ 
[
œœ 
$str
œœ )
]
œœ) *
!=
œœ+ -
DBNull
œœ. 4
.
œœ4 5
Value
œœ5 :
)
œœ: ;
Prod
–– 
.
–– 
PrecioCompra
–– )
=
––* +
Convert
––, 3
.
––3 4
ToDouble
––4 <
(
––< =
dr
––= ?
[
––? @
$str
––@ N
]
––N O
)
––O P
;
––P Q
lista
—— 
.
—— 
Add
—— 
(
—— 
Prod
—— "
)
——" #
;
——# $
}
““ 
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
e
‘‘ 
)
‘‘ 
{
’’ 

MessageBox
◊◊ 
.
◊◊ 
Show
◊◊ 
(
◊◊  
e
◊◊  !
.
◊◊! "
Message
◊◊" )
)
◊◊) *
;
◊◊* +
}
ÿÿ 
return
ŸŸ 
lista
ŸŸ 
;
ŸŸ 
}
⁄⁄ 	
public
‹‹ "
EntProveedorProducto
‹‹ #&
BuscarProvedorProductoId
‹‹$ <
(
‹‹< =
int
‹‹= @
idprod
‹‹A G
,
‹‹G H
int
‹‹I L
idprov
‹‹M S
)
‹‹S T
{
›› 	

SqlCommand
ﬁﬁ 
cmd
ﬁﬁ 
=
ﬁﬁ 
null
ﬁﬁ !
;
ﬁﬁ! ""
EntProveedorProducto
ﬂﬂ  
Prod
ﬂﬂ! %
=
ﬂﬂ& '
new
ﬂﬂ( +"
EntProveedorProducto
ﬂﬂ, @
(
ﬂﬂ@ A
)
ﬂﬂA B
;
ﬂﬂB C
try
‡‡ 
{
·· 
SqlConnection
‚‚ 
cn
‚‚  
=
‚‚! "
Conexion
‚‚# +
.
‚‚+ ,
	Instancia
‚‚, 5
.
‚‚5 6
Conectar
‚‚6 >
(
‚‚> ?
)
‚‚? @
;
‚‚@ A
cmd
„„ 
=
„„ 
new
„„ 

SqlCommand
„„ $
(
„„$ %
$str
„„% A
,
„„A B
cn
„„C E
)
„„E F
{
‰‰ 
CommandType
ÂÂ 
=
ÂÂ  !
CommandType
ÂÂ" -
.
ÂÂ- .
StoredProcedure
ÂÂ. =
}
ÊÊ 
;
ÊÊ 
cmd
ÁÁ 
.
ÁÁ 

Parameters
ÁÁ 
.
ÁÁ 
AddWithValue
ÁÁ +
(
ÁÁ+ ,
$str
ÁÁ, ?
,
ÁÁ? @
idprod
ÁÁA G
)
ÁÁG H
;
ÁÁH I
cmd
ËË 
.
ËË 

Parameters
ËË 
.
ËË 
AddWithValue
ËË +
(
ËË+ ,
$str
ËË, @
,
ËË@ A
idprov
ËËB H
)
ËËH I
;
ËËI J
cn
ÈÈ 
.
ÈÈ 
Open
ÈÈ 
(
ÈÈ 
)
ÈÈ 
;
ÈÈ 
SqlDataReader
ÍÍ 
dr
ÍÍ  
=
ÍÍ! "
cmd
ÍÍ# &
.
ÍÍ& '
ExecuteReader
ÍÍ' 4
(
ÍÍ4 5
)
ÍÍ5 6
;
ÍÍ6 7
while
ÎÎ 
(
ÎÎ 
dr
ÎÎ 
.
ÎÎ 
Read
ÎÎ 
(
ÎÎ 
)
ÎÎ  
)
ÎÎ  !
{
ÏÏ 
Prod
ÌÌ 
.
ÌÌ 
Producto
ÌÌ !
=
ÌÌ" #
new
ÌÌ$ '
EntProducto
ÌÌ( 3
{
ÓÓ 

IdProducto
ÔÔ "
=
ÔÔ# $
Convert
ÔÔ% ,
.
ÔÔ, -
ToInt32
ÔÔ- 4
(
ÔÔ4 5
dr
ÔÔ5 7
[
ÔÔ7 8
$str
ÔÔ8 D
]
ÔÔD E
)
ÔÔE F
,
ÔÔF G
Nombre
 
=
  
dr
! #
[
# $
$str
$ ,
]
, -
.
- .
ToString
. 6
(
6 7
)
7 8
,
8 9
Longitud
ÒÒ  
=
ÒÒ! "
Convert
ÒÒ# *
.
ÒÒ* +
ToDouble
ÒÒ+ 3
(
ÒÒ3 4
dr
ÒÒ4 6
[
ÒÒ6 7
$str
ÒÒ7 A
]
ÒÒA B
)
ÒÒB C
,
ÒÒC D
Diametro
ÚÚ  
=
ÚÚ! "
Convert
ÚÚ# *
.
ÚÚ* +
ToDouble
ÚÚ+ 3
(
ÚÚ3 4
dr
ÚÚ4 6
[
ÚÚ6 7
$str
ÚÚ7 A
]
ÚÚA B
)
ÚÚB C
,
ÚÚC D
PrecioVenta
ÛÛ #
=
ÛÛ$ %
Convert
ÛÛ& -
.
ÛÛ- .
ToDouble
ÛÛ. 6
(
ÛÛ6 7
dr
ÛÛ7 9
[
ÛÛ9 :
$str
ÛÛ: G
]
ÛÛG H
)
ÛÛH I
,
ÛÛI J
Activo
ÙÙ 
=
ÙÙ  
Convert
ÙÙ! (
.
ÙÙ( )
	ToBoolean
ÙÙ) 2
(
ÙÙ2 3
dr
ÙÙ3 5
[
ÙÙ5 6
$str
ÙÙ6 >
]
ÙÙ> ?
)
ÙÙ? @
,
ÙÙ@ A
Tipo
ıı 
=
ıı 
new
ıı "
EntTipoProducto
ıı# 2
{
ˆˆ 
IdTipo_producto
˜˜ +
=
˜˜, -
Convert
˜˜. 5
.
˜˜5 6
ToInt32
˜˜6 =
(
˜˜= >
dr
˜˜> @
[
˜˜@ A
$str
˜˜A R
]
˜˜R S
)
˜˜S T
,
˜˜T U
Nombre
¯¯ "
=
¯¯# $
dr
¯¯% '
[
¯¯' (
$str
¯¯( .
]
¯¯. /
.
¯¯/ 0
ToString
¯¯0 8
(
¯¯8 9
)
¯¯9 :
}
˙˙ 
}
˚˚ 
;
˚˚ 
if
˝˝ 
(
˝˝ 
dr
˝˝ 
[
˝˝ 
$str
˝˝ (
]
˝˝( )
!=
˝˝* ,
DBNull
˝˝- 3
.
˝˝3 4
Value
˝˝4 9
)
˝˝9 :
{
˛˛ 
Prod
ˇˇ 
.
ˇˇ 
	Proveedor
ˇˇ &
=
ˇˇ' (
new
ˇˇ) ,
EntProveedor
ˇˇ- 9
{
ÄÄ 
IdProveedor
ÅÅ '
=
ÅÅ( )
Convert
ÅÅ* 1
.
ÅÅ1 2
ToInt32
ÅÅ2 9
(
ÅÅ9 :
dr
ÅÅ: <
[
ÅÅ< =
$str
ÅÅ= J
]
ÅÅJ K
)
ÅÅK L
,
ÅÅL M
RazonSocial
ÇÇ '
=
ÇÇ( )
dr
ÇÇ* ,
[
ÇÇ, -
$str
ÇÇ- :
]
ÇÇ: ;
.
ÇÇ; <
ToString
ÇÇ< D
(
ÇÇD E
)
ÇÇE F
}
ÉÉ 
;
ÉÉ 
}
ÑÑ 
if
ÖÖ 
(
ÖÖ 
dr
ÖÖ 
[
ÖÖ 
$str
ÖÖ )
]
ÖÖ) *
!=
ÖÖ+ -
DBNull
ÖÖ. 4
.
ÖÖ4 5
Value
ÖÖ5 :
)
ÖÖ: ;
Prod
ÜÜ 
.
ÜÜ 
PrecioCompra
ÜÜ )
=
ÜÜ* +
Convert
ÜÜ, 3
.
ÜÜ3 4
ToDouble
ÜÜ4 <
(
ÜÜ< =
dr
ÜÜ= ?
[
ÜÜ? @
$str
ÜÜ@ N
]
ÜÜN O
)
ÜÜO P
;
ÜÜP Q
}
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
e
ãã 
)
ãã 
{
åå 

MessageBox
éé 
.
éé 
Show
éé 
(
éé  
e
éé  !
.
éé! "
Message
éé" )
)
éé) *
;
éé* +
}
èè 
return
êê 
Prod
êê 
;
êê 
}
ëë 	
}
íí 
<<<<<<< HEAD
}ìì ﬂ
JD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\datRoll.cs
=======
}ìì Ì
XC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\datRoll.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace 	
CapaAccesoDatos
 
{		 
public

 

class

 
datRoll

 
{ 
private 
static 
readonly 
datRoll  '

_instancia( 2
=3 4
new5 8
datRoll9 @
(@ A
)A B
;B C
public 
static 
datRoll 
	Instancia '
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
List 
< 
entRoll 
> 

ListarRoll '
(' (
)( )
{ 	

SqlCommand 
cmd 
= 
null !
;! "
List 
< 
entRoll 
> 
lista 
=  !
new" %
List& *
<* +
entRoll+ 2
>2 3
(3 4
)4 5
;5 6
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 2
,2 3
cn4 6
)6 7
;7 8
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cn 
. 
Open 
( 
) 
; 
SqlDataReader 
dr  
=! "
cmd# &
.& '
ExecuteReader' 4
(4 5
)5 6
;6 7
while 
( 
dr 
. 
Read 
( 
)  
)  !
{ 
entRoll 
rol 
=  !
new" %
entRoll& -
{   
IdRoll!! 
=!!  
Convert!!! (
.!!( )
ToInt32!!) 0
(!!0 1
dr!!1 3
[!!3 4
$str!!4 ;
]!!; <
)!!< =
,!!= >
Descripcion"" #
=""$ %
dr""& (
[""( )
$str"") 6
]""6 7
.""7 8
ToString""8 @
(""@ A
)""A B
,""B C
}## 
;## 
lista%% 
.%% 
Add%% 
(%% 
rol%% !
)%%! "
;%%" #
}&& 
})) 
catch** 
(** 
	Exception** 
e** 
)** 
{++ 

MessageBox,, 
.,, 
Show,, 
(,,  
e,,  !
.,,! "
Message,," )
,,,) *
$str,,+ D
,,,D E
MessageBoxButtons,,F W
.,,W X
OK,,X Z
,,,Z [
MessageBoxIcon,,\ j
.,,j k
Error,,k p
),,p q
;,,q r
}-- 
return.. 
lista.. 
;.. 
}// 	
}00 
<<<<<<< HEAD
}11 ∂c
RD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatTipoProducto.cs
=======
}11 ƒc
`C:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatTipoProducto.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace 	
CapaAccesoDatos
 
{		 
public

 

class

 
DatTipoProducto

  
:

! "
IDatTipoProducto

# 3
{ 
private 
static 
readonly 
DatTipoProducto  /

_instancia0 :
=; <
new= @
DatTipoProductoA P
(P Q
)Q R
;R S
public 
static 
DatTipoProducto %
	Instancia& /
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearTipoProducto %
(% &
EntTipoProducto& 5
tip6 9
)9 :
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% :
,: ;
cn< >
)> ?
;? @
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
tip7 :
.: ;
Nombre; A
)A B
;B C
cn 
. 
Open 
( 
) 
; 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if 
( 
i 
!= 
$num 
) 
{ 
creado   
=   
true   !
;  ! "
}!! 
}"" 
catch## 
(## 
	Exception## 
e## 
)## 
{$$ 

MessageBox%% 
.%% 
Show%% 
(%%  
e%%  !
.%%! "
Message%%" )
,%%) *
$str%%+ F
,%%F G
MessageBoxButtons%%H Y
.%%Y Z
OK%%Z \
,%%\ ]
MessageBoxIcon%%^ l
.%%l m
Error%%m r
)%%r s
;%%s t
}&& 
return'' 
creado'' 
;'' 
})) 	
public++ 
List++ 
<++ 
EntTipoProducto++ #
>++# $"
SelectListTipoProducto++% ;
(++; <
)++< =
{,, 	

SqlCommand-- 
cmd-- 
=-- 
null-- !
;--! "
List.. 
<.. 
EntTipoProducto..  
>..  !
lista.." '
=..( )
new..* -
List... 2
<..2 3
EntTipoProducto..3 B
>..B C
(..C D
)..D E
;..E F
try// 
{00 
SqlConnection11 
cn11  
=11! "
Conexion11# +
.11+ ,
	Instancia11, 5
.115 6
Conectar116 >
(11> ?
)11? @
;11@ A
cmd22 
=22 
new22 

SqlCommand22 $
(22$ %
$str22% ?
,22? @
cn22A C
)22C D
;22D E
cmd33 
.33 
CommandType33 
=33  !
CommandType33" -
.33- .
StoredProcedure33. =
;33= >
cn44 
.44 
Open44 
(44 
)44 
;44 
SqlDataReader55 
dr55  
=55! "
cmd55# &
.55& '
ExecuteReader55' 4
(554 5
)555 6
;556 7
while66 
(66 
dr66 
.66 
Read66 
(66 
)66  
)66  !
{77 
EntTipoProducto88 #
tip88$ '
=88( )
new88* -
EntTipoProducto88. =
(88= >
)88> ?
;88? @
tip99 
.99 
IdTipo_producto99 '
=99( )
Convert99* 1
.991 2
ToInt32992 9
(999 :
dr99: <
[99< =
$str99= N
]99N O
)99O P
;99P Q
tip:: 
.:: 
Nombre:: 
=::  
dr::! #
[::# $
$str::$ ,
]::, -
.::- .
ToString::. 6
(::6 7
)::7 8
;::8 9
lista;; 
.;; 
Add;; 
(;; 
tip;; !
);;! "
;;;" #
}<< 
}>> 
catch?? 
(?? 
	Exception?? 
e?? 
)?? 
{@@ 

MessageBoxAA 
.AA 
ShowAA 
(AA  
eAA  !
.AA! "
MessageAA" )
,AA) *
$strAA+ F
,AAF G
MessageBoxButtonsAAH Y
.AAY Z
OKAAZ \
,AA\ ]
MessageBoxIconAA^ l
.AAl m
ErrorAAm r
)AAr s
;AAs t
}BB 
returnCC 
listaCC 
;CC 
}DD 	
publicFF 
ListFF 
<FF 
EntTipoProductoFF #
>FF# $%
SelectListTipoProductodatFF% >
(FF> ?
intFF? B
idFFC E
)FFE F
{GG 	

SqlCommandHH 
cmdHH 
=HH 
nullHH !
;HH! "
ListII 
<II 
EntTipoProductoII  
>II  !
listaII" '
=II( )
newII* -
ListII. 2
<II2 3
EntTipoProductoII3 B
>IIB C
(IIC D
)IID E
;IIE F
tryJJ 
{KK 
SqlConnectionLL 
cnLL  
=LL! "
ConexionLL# +
.LL+ ,
	InstanciaLL, 5
.LL5 6
ConectarLL6 >
(LL> ?
)LL? @
;LL@ A
cmdMM 
=MM 
newMM 

SqlCommandMM $
(MM$ %
$strMM% B
,MMB C
cnMMD F
)MMF G
;MMG H
cmdNN 
.NN 
CommandTypeNN 
=NN  !
CommandTypeNN" -
.NN- .
StoredProcedureNN. =
;NN= >
cmdOO 
.OO 

ParametersOO 
.OO 
AddWithValueOO +
(OO+ ,
$strOO, 1
,OO1 2
idOO3 5
)OO5 6
;OO6 7
cnPP 
.PP 
OpenPP 
(PP 
)PP 
;PP 
SqlDataReaderQQ 
drQQ  
=QQ! "
cmdQQ# &
.QQ& '
ExecuteReaderQQ' 4
(QQ4 5
)QQ5 6
;QQ6 7
whileRR 
(RR 
drRR 
.RR 
ReadRR 
(RR 
)RR  
)RR  !
{SS 
EntTipoProductoTT #
tipTT$ '
=TT( )
newTT* -
EntTipoProductoTT. =
{UU 
IdTipo_productoVV '
=VV( )
ConvertVV* 1
.VV1 2
ToInt32VV2 9
(VV9 :
drVV: <
[VV< =
$strVV= N
]VVN O
)VVO P
,VVP Q
NombreWW 
=WW  
drWW! #
[WW# $
$strWW$ ,
]WW, -
.WW- .
ToStringWW. 6
(WW6 7
)WW7 8
}XX 
;XX 
listaYY 
.YY 
AddYY 
(YY 
tipYY !
)YY! "
;YY" #
}ZZ 
}\\ 
catch]] 
(]] 
	Exception]] 
e]] 
)]] 
{^^ 

MessageBox__ 
.__ 
Show__ 
(__  
e__  !
.__! "
Message__" )
,__) *
$str__+ F
,__F G
MessageBoxButtons__H Y
.__Y Z
OK__Z \
,__\ ]
MessageBoxIcon__^ l
.__l m
Error__m r
)__r s
;__s t
}`` 
returnaa 
listaaa 
;aa 
}bb 	
publiccc 
boolcc "
ActualizarTipoProductocc *
(cc* +
EntTipoProductocc+ :
tipcc; >
)cc> ?
{dd 	

SqlCommandee 
cmdee 
=ee 
nullee !
;ee! "
boolff 
	actualizaff 
=ff 
falseff "
;ff" #
trygg 
{hh 
SqlConnectionii 
cnii  
=ii! "
Conexionii# +
.ii+ ,
	Instanciaii, 5
.ii5 6
Conectarii6 >
(ii> ?
)ii? @
;ii@ A
cmdjj 
=jj 
newjj 

SqlCommandjj $
(jj$ %
$strjj% ?
,jj? @
cnjjA C
)jjC D
;jjD E
cmdkk 
.kk 
CommandTypekk 
=kk  !
CommandTypekk" -
.kk- .
StoredProcedurekk. =
;kk= >
cmdll 
.ll 

Parametersll 
.ll 
AddWithValuell +
(ll+ ,
$strll, >
,ll> ?
tipll@ C
.llC D
IdTipo_productollD S
)llS T
;llT U
cmdmm 
.mm 

Parametersmm 
.mm 
AddWithValuemm +
(mm+ ,
$strmm, 5
,mm5 6
tipmm7 :
.mm: ;
Nombremm; A
)mmA B
;mmB C
cnnn 
.nn 
Opennn 
(nn 
)nn 
;nn 
intoo 
ioo 
=oo 
cmdoo 
.oo 
ExecuteNonQueryoo +
(oo+ ,
)oo, -
;oo- .
ifpp 
(pp 
ipp 
>pp 
$numpp 
)pp 
{qq 
	actualizarr 
=rr 
truerr  $
;rr$ %
}ss 
}tt 
catchuu 
(uu 
	Exceptionuu 
euu 
)uu 
{vv 

MessageBoxww 
.ww 
Showww 
(ww  
eww  !
.ww! "
Messageww" )
)ww) *
;ww* +
}xx 
returnyy 
	actualizayy 
;yy 
}zz 	
public}} 
bool}}  
EliminarTipoProducto}} (
(}}( )
int}}) ,
id}}- /
)}}/ 0
{~~ 	

SqlCommand 
cmd 
= 
null !
;! "
bool
ÄÄ 
	eliminado
ÄÄ 
=
ÄÄ 
false
ÄÄ "
;
ÄÄ" #
try
ÅÅ 
{
ÇÇ 
SqlConnection
ÉÉ 
cn
ÉÉ  
=
ÉÉ! "
Conexion
ÉÉ# +
.
ÉÉ+ ,
	Instancia
ÉÉ, 5
.
ÉÉ5 6
Conectar
ÉÉ6 >
(
ÉÉ> ?
)
ÉÉ? @
;
ÉÉ@ A
cmd
ÑÑ 
=
ÑÑ 
new
ÑÑ 

SqlCommand
ÑÑ $
(
ÑÑ$ %
$str
ÑÑ% =
,
ÑÑ= >
cn
ÑÑ? A
)
ÑÑA B
;
ÑÑB C
cmd
ÖÖ 
.
ÖÖ 
CommandType
ÖÖ 
=
ÖÖ  !
CommandType
ÖÖ" -
.
ÖÖ- .
StoredProcedure
ÖÖ. =
;
ÖÖ= >
cmd
ÜÜ 
.
ÜÜ 

Parameters
ÜÜ 
.
ÜÜ 
AddWithValue
ÜÜ +
(
ÜÜ+ ,
$str
ÜÜ, >
,
ÜÜ> ?
id
ÜÜ@ B
)
ÜÜB C
;
ÜÜC D
cn
áá 
.
áá 
Open
áá 
(
áá 
)
áá 
;
áá 
int
àà 
i
àà 
=
àà 
cmd
àà 
.
àà 
ExecuteNonQuery
àà +
(
àà+ ,
)
àà, -
;
àà- .
if
ââ 
(
ââ 
i
ââ 
>
ââ 
$num
ââ 
)
ââ 
{
ää 
	eliminado
ãã 
=
ãã 
true
ãã  $
;
ãã$ %
}
åå 
}
çç 
catch
éé 
(
éé 
	Exception
éé 
e
éé 
)
éé 
{
èè 

MessageBox
êê 
.
êê 
Show
êê 
(
êê  
e
êê  !
.
êê! "
Message
êê" )
)
êê) *
;
êê* +
}
ëë 
return
íí 
	eliminado
íí 
;
íí 
}
ìì 	
}
ïï 
<<<<<<< HEAD
}ññ Äâ
LD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatUbigeo.cs
=======
}ññ éâ
ZC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatUbigeo.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace 	
CapaAccesoDatos
 
{		 
public

 

class

 
	DatUbigeo

 
:

 

IDatUbigeo

 '
{ 
private 
static 
readonly 
	DatUbigeo  )

_instancia* 4
=5 6
new7 :
	DatUbigeo; D
(D E
)E F
;F G
public 
static 
	DatUbigeo 
	Instancia  )
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
bool 
CrearUbigeo 
(  
	EntUbigeo  )
ubi* -
)- .
{ 	

SqlCommand 
cmd 
= 
null !
;! "
bool 
creado 
= 
false 
;  
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 4
,4 5
cn6 8
)8 9
;9 :
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
ubi9 <
.< =
IdUbigeo= E
)E F
;F G
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, ;
,; <
ubi= @
.@ A
DepartamentoA M
)M N
;N O
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
ubi: =
.= >
	Provincia> G
)G H
;H I
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
ubi9 <
.< =
Distrito= E
)E F
;F G
cn 
. 
Open 
( 
) 
; 
int 
i 
= 
cmd 
. 
ExecuteNonQuery +
(+ ,
), -
;- .
if   
(   
i   
!=   
$num   
)   
{!! 
creado"" 
="" 
true"" !
;""! "
}## 
}$$ 
catch%% 
(%% 
	Exception%% 
e%% 
)%% 
{&& 

MessageBox'' 
.'' 
Show'' 
(''  
e''  !
.''! "
Message''" )
,'') *
$str''+ E
,''E F
MessageBoxButtons''G X
.''X Y
OK''Y [
,''[ \
MessageBoxIcon''] k
.''k l
Error''l q
)''q r
;''r s
}(( 
return)) 
creado)) 
;)) 
}++ 	
public-- 
List-- 
<-- 
	EntUbigeo-- 
>-- 
ListarUbigeo-- +
(--+ ,
)--, -
{.. 	

SqlCommand// 
cmd// 
=// 
null// !
;//! "
List00 
<00 
	EntUbigeo00 
>00 
lista00 !
=00" #
new00$ '
List00( ,
<00, -
	EntUbigeo00- 6
>006 7
(007 8
)008 9
;009 :
try11 
{22 
SqlConnection33 
cn33  
=33! "
Conexion33# +
.33+ ,
	Instancia33, 5
.335 6
Conectar336 >
(33> ?
)33? @
;33@ A
cmd44 
=44 
new44 

SqlCommand44 $
(44$ %
$str44% 5
,445 6
cn447 9
)449 :
;44: ;
cmd55 
.55 
CommandType55 
=55  !
CommandType55" -
.55- .
StoredProcedure55. =
;55= >
cn66 
.66 
Open66 
(66 
)66 
;66 
SqlDataReader77 
dr77  
=77! "
cmd77# &
.77& '
ExecuteReader77' 4
(774 5
)775 6
;776 7
while88 
(88 
dr88 
.88 
Read88 
(88 
)88  
)88  !
{99 
	EntUbigeo:: 
ubi:: !
=::" #
new::$ '
	EntUbigeo::( 1
(::1 2
)::2 3
;::3 4
ubi;; 
.;; 
IdUbigeo;;  
=;;! "
dr;;# %
[;;% &
$str;;& 0
];;0 1
.;;1 2
ToString;;2 :
(;;: ;
);;; <
;;;< =
ubi<< 
.<< 
Departamento<< $
=<<% &
dr<<' )
[<<) *
$str<<* 8
]<<8 9
.<<9 :
ToString<<: B
(<<B C
)<<C D
;<<D E
ubi== 
.== 
	Provincia== !
===" #
dr==$ &
[==& '
$str==' 2
]==2 3
.==3 4
ToString==4 <
(==< =
)=== >
;==> ?
ubi>> 
.>> 
Distrito>>  
=>>! "
dr>># %
[>>% &
$str>>& 0
]>>0 1
.>>1 2
ToString>>2 :
(>>: ;
)>>; <
;>>< =
lista?? 
.?? 
Add?? 
(?? 
ubi?? !
)??! "
;??" #
}@@ 
}BB 
catchCC 
(CC 
	ExceptionCC 
eCC 
)CC 
{DD 

MessageBoxEE 
.EE 
ShowEE 
(EE  
eEE  !
.EE! "
MessageEE" )
,EE) *
$strEE+ C
,EEC D
MessageBoxButtonsEEE V
.EEV W
OKEEW Y
,EEY Z
MessageBoxIconEE[ i
.EEi j
ErrorEEj o
)EEo p
;EEp q
}FF 
returnGG 
listaGG 
;GG 
}HH 	
publicJJ 
ListJJ 
<JJ 
	EntUbigeoJJ 
>JJ 
ListarDistritoJJ -
(JJ- .
)JJ. /
{KK 	

SqlCommandLL 
cmdLL 
=LL 
nullLL !
;LL! "
ListMM 
<MM 
	EntUbigeoMM 
>MM 
listaMM !
=MM" #
newMM$ '
ListMM( ,
<MM, -
	EntUbigeoMM- 6
>MM6 7
(MM7 8
)MM8 9
;MM9 :
tryNN 
{OO 
SqlConnectionPP 
cnPP  
=PP! "
ConexionPP# +
.PP+ ,
	InstanciaPP, 5
.PP5 6
ConectarPP6 >
(PP> ?
)PP? @
;PP@ A
cmdQQ 
=QQ 
newQQ 

SqlCommandQQ $
(QQ$ %
$strQQ% 7
,QQ7 8
cnQQ9 ;
)QQ; <
;QQ< =
cmdRR 
.RR 
CommandTypeRR 
=RR  !
CommandTypeRR" -
.RR- .
StoredProcedureRR. =
;RR= >
cnSS 
.SS 
OpenSS 
(SS 
)SS 
;SS 
SqlDataReaderTT 
drTT  
=TT! "
cmdTT# &
.TT& '
ExecuteReaderTT' 4
(TT4 5
)TT5 6
;TT6 7
whileUU 
(UU 
drUU 
.UU 
ReadUU 
(UU 
)UU  
)UU  !
{VV 
	EntUbigeoWW 
ubiWW !
=WW" #
newWW$ '
	EntUbigeoWW( 1
(WW1 2
)WW2 3
;WW3 4
ubiXX 
.XX 
IdUbigeoXX  
=XX! "
drXX# %
[XX% &
$strXX& 0
]XX0 1
.XX1 2
ToStringXX2 :
(XX: ;
)XX; <
;XX< =
ubiYY 
.YY 
DistritoYY  
=YY! "
drYY# %
[YY% &
$strYY& 0
]YY0 1
.YY1 2
ToStringYY2 :
(YY: ;
)YY; <
;YY< =
listaZZ 
.ZZ 
AddZZ 
(ZZ 
ubiZZ !
)ZZ! "
;ZZ" #
}[[ 
}\\ 
catch]] 
(]] 
	Exception]] 
e]] 
)]] 
{^^ 

MessageBox__ 
.__ 
Show__ 
(__  
e__  !
.__! "
Message__" )
,__) *
$str__+ E
,__E F
MessageBoxButtons__G X
.__X Y
OK__Y [
,__[ \
MessageBoxIcon__] k
.__k l
Error__l q
)__q r
;__r s
}`` 
returnaa 
listaaa 
;aa 
}bb 	
publicee 
boolee 
ActualizarUbigeoee $
(ee$ %
	EntUbigeoee% .
ubiee/ 2
)ee2 3
{ff 	

SqlCommandgg 
cmdgg 
=gg 
nullgg !
;gg! "
boolhh 
	actualizahh 
=hh 
falsehh "
;hh" #
tryii 
{jj 
SqlConnectionkk 
cnkk  
=kk! "
Conexionkk# +
.kk+ ,
	Instanciakk, 5
.kk5 6
Conectarkk6 >
(kk> ?
)kk? @
;kk@ A
cmdll 
=ll 
newll 

SqlCommandll $
(ll$ %
$strll% 9
,ll9 :
cnll; =
)ll= >
;ll> ?
cmdmm 
.mm 
CommandTypemm 
=mm  !
CommandTypemm" -
.mm- .
StoredProceduremm. =
;mm= >
cmdnn 
.nn 

Parametersnn 
.nn 
AddWithValuenn +
(nn+ ,
$strnn, 7
,nn7 8
ubinn9 <
.nn< =
IdUbigeonn= E
)nnE F
;nnF G
cmdoo 
.oo 

Parametersoo 
.oo 
AddWithValueoo +
(oo+ ,
$stroo, ;
,oo; <
ubioo= @
.oo@ A
DepartamentoooA M
)ooM N
;ooN O
cmdpp 
.pp 

Parameterspp 
.pp 
AddWithValuepp +
(pp+ ,
$strpp, 8
,pp8 9
ubipp: =
.pp= >
	Provinciapp> G
)ppG H
;ppH I
cmdqq 
.qq 

Parametersqq 
.qq 
AddWithValueqq +
(qq+ ,
$strqq, 7
,qq7 8
ubiqq9 <
.qq< =
Distritoqq= E
)qqE F
;qqF G
cnrr 
.rr 
Openrr 
(rr 
)rr 
;rr 
intss 
iss 
=ss 
cmdss 
.ss 
ExecuteNonQueryss +
(ss+ ,
)ss, -
;ss- .
iftt 
(tt 
itt 
>tt 
$numtt 
)tt 
{uu 
	actualizavv 
=vv 
truevv  $
;vv$ %
}ww 
}xx 
catchyy 
(yy 
	Exceptionyy 
eyy 
)yy 
{zz 

MessageBox{{ 
.{{ 
Show{{ 
({{  
e{{  !
.{{! "
Message{{" )
){{) *
;{{* +
}|| 
return}} 
	actualiza}} 
;}} 
}~~ 	
public
ÅÅ 
bool
ÅÅ 
EliminarUbigeo
ÅÅ "
(
ÅÅ" #
int
ÅÅ# &
id
ÅÅ' )
)
ÅÅ) *
{
ÇÇ 	

SqlCommand
ÉÉ 
cmd
ÉÉ 
=
ÉÉ 
null
ÉÉ !
;
ÉÉ! "
bool
ÑÑ 
	eliminado
ÑÑ 
=
ÑÑ 
false
ÑÑ "
;
ÑÑ" #
try
ÖÖ 
{
ÜÜ 
SqlConnection
áá 
cn
áá  
=
áá! "
Conexion
áá# +
.
áá+ ,
	Instancia
áá, 5
.
áá5 6
Conectar
áá6 >
(
áá> ?
)
áá? @
;
áá@ A
cmd
àà 
=
àà 
new
àà 

SqlCommand
àà $
(
àà$ %
$str
àà% 7
,
àà7 8
cn
àà9 ;
)
àà; <
;
àà< =
cmd
ââ 
.
ââ 
CommandType
ââ 
=
ââ  !
CommandType
ââ" -
.
ââ- .
StoredProcedure
ââ. =
;
ââ= >
cmd
ää 
.
ää 

Parameters
ää 
.
ää 
AddWithValue
ää +
(
ää+ ,
$str
ää, 7
,
ää7 8
id
ää9 ;
)
ää; <
;
ää< =
cn
ãã 
.
ãã 
Open
ãã 
(
ãã 
)
ãã 
;
ãã 
int
åå 
i
åå 
=
åå 
cmd
åå 
.
åå 
ExecuteNonQuery
åå +
(
åå+ ,
)
åå, -
;
åå- .
if
çç 
(
çç 
i
çç 
>
çç 
$num
çç 
)
çç 
{
éé 
	eliminado
èè 
=
èè 
true
èè  $
;
èè$ %
}
êê 
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
e
íí 
)
íí 
{
ìì 

MessageBox
îî 
.
îî 
Show
îî 
(
îî  
e
îî  !
.
îî! "
Message
îî" )
)
îî) *
;
îî* +
}
ïï 
return
ññ 
	eliminado
ññ 
;
ññ 
}
óó 	
public
ôô 
List
ôô 
<
ôô 
	EntUbigeo
ôô 
>
ôô 
BuscarUbigeo
ôô +
(
ôô+ ,
string
ôô, 2
busqueda
ôô3 ;
)
ôô; <
{
öö 	
List
õõ 
<
õõ 
	EntUbigeo
õõ 
>
õõ 
lista
õõ !
=
õõ" #
new
õõ$ '
List
õõ( ,
<
õõ, -
	EntUbigeo
õõ- 6
>
õõ6 7
(
õõ7 8
)
õõ8 9
;
õõ9 :

SqlCommand
úú 
cmd
úú 
=
úú 
null
úú !
;
úú! "
try
ùù 
{
ûû 
SqlConnection
üü 
cn
üü  
=
üü! "
Conexion
üü# +
.
üü+ ,
	Instancia
üü, 5
.
üü5 6
Conectar
üü6 >
(
üü> ?
)
üü? @
;
üü@ A
cmd
†† 
=
†† 
new
†† 

SqlCommand
†† $
(
††$ %
$str
††% 5
,
††5 6
cn
††7 9
)
††9 :
;
††: ;
cmd
°° 
.
°° 
CommandType
°° 
=
°°  !
CommandType
°°" -
.
°°- .
StoredProcedure
°°. =
;
°°= >
cmd
¢¢ 
.
¢¢ 

Parameters
¢¢ 
.
¢¢ 
AddWithValue
¢¢ +
(
¢¢+ ,
$str
¢¢, 4
,
¢¢4 5
busqueda
¢¢6 >
)
¢¢> ?
;
¢¢? @
cn
££ 
.
££ 
Open
££ 
(
££ 
)
££ 
;
££ 
SqlDataReader
§§ 
dr
§§  
=
§§! "
cmd
§§# &
.
§§& '
ExecuteReader
§§' 4
(
§§4 5
)
§§5 6
;
§§6 7
while
•• 
(
•• 
dr
•• 
.
•• 
Read
•• 
(
•• 
)
••  
)
••  !
{
¶¶ 
	EntUbigeo
ßß 
ubi
ßß !
=
ßß" #
new
ßß$ '
	EntUbigeo
ßß( 1
(
ßß1 2
)
ßß2 3
;
ßß3 4
ubi
®® 
.
®® 
IdUbigeo
®®  
=
®®! "
dr
®®# %
[
®®% &
$str
®®& 0
]
®®0 1
.
®®1 2
ToString
®®2 :
(
®®: ;
)
®®; <
;
®®< =
ubi
©© 
.
©© 
Departamento
©© $
=
©©% &
dr
©©' )
[
©©) *
$str
©©* 8
]
©©8 9
.
©©9 :
ToString
©©: B
(
©©B C
)
©©C D
;
©©D E
ubi
™™ 
.
™™ 
	Provincia
™™ !
=
™™" #
dr
™™$ &
[
™™& '
$str
™™' 2
]
™™2 3
.
™™3 4
ToString
™™4 <
(
™™< =
)
™™= >
;
™™> ?
ubi
´´ 
.
´´ 
Distrito
´´  
=
´´! "
dr
´´# %
[
´´% &
$str
´´& 0
]
´´0 1
.
´´1 2
ToString
´´2 :
(
´´: ;
)
´´; <
;
´´< =
lista
¨¨ 
.
¨¨ 
Add
¨¨ 
(
¨¨ 
ubi
¨¨ !
)
¨¨! "
;
¨¨" #
}
≠≠ 
}
ÆÆ 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
e
ØØ 
)
ØØ 
{
∞∞ 

MessageBox
≤≤ 
.
≤≤ 
Show
≤≤ 
(
≤≤  
e
≤≤  !
.
≤≤! "
Message
≤≤" )
)
≤≤) *
;
≤≤* +
}
≥≥ 
return
µµ 
lista
µµ 
;
µµ 
}
∂∂ 	
}
ππ 
<<<<<<< HEAD
}∫∫ ÛS
KD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatVenta.cs
=======
}∫∫ ÅT
YC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\DatVenta.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace		 	
CapaAccesoDatos		
 
{

 
public 

class 
DatVenta 
: 
	IDatVenta %
{ 
private 
static 
readonly 
DatVenta  (

_instancia) 3
=4 5
new6 9
DatVenta: B
(B C
)C D
;D E
public 
static 
DatVenta 
	Instancia (
{ 	
get 
{ 
return 

_instancia #
;# $
}% &
} 	
public 
int 

CrearVenta 
( 
EntVenta &
venta' ,
), -
{ 	

SqlCommand 
cmd 
= 
null !
;! "
int 
idVenta 
= 
- 
$num 
; 
try 
{ 
SqlConnection 
cn  
=! "
Conexion# +
.+ ,
	Instancia, 5
.5 6
Conectar6 >
(> ?
)? @
;@ A
cmd 
= 
new 

SqlCommand $
($ %
$str% 3
,3 4
cn5 7
)7 8
;8 9
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
venta6 ;
.; <
Total< A
)A B
;B C
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
venta: ?
.? @
Cliente@ G
.G H
	IdUsuarioH Q
)Q R
;R S
SqlParameter 
id 
=  !
new" %
SqlParameter& 2
(2 3
$str3 =
,= >
$num? @
)@ A
{ 
	Direction   
=   
ParameterDirection    2
.  2 3
Output  3 9
}!! 
;!! 
cmd"" 
."" 

Parameters"" 
."" 
Add"" "
(""" #
id""# %
)""% &
;""& '
cn$$ 
.$$ 
Open$$ 
($$ 
)$$ 
;$$ 
int%% 
i%% 
=%% 
cmd%% 
.%% 
ExecuteNonQuery%% +
(%%+ ,
)%%, -
;%%- .
if&& 
(&& 
i&& 
>&& 
$num&& 
)&& 
{'' 
idVenta(( 
=(( 
Convert(( %
.((% &
ToInt32((& -
(((- .
cmd((. 1
.((1 2

Parameters((2 <
[((< =
$str((= G
]((G H
.((H I
Value((I N
)((N O
;((O P
})) 
if** 
(** 
idVenta** 
==** 
-**  
$num**  !
)**! "
{++ 

MessageBox,, 
.,, 
Show,, #
(,,# $
$str,,$ 1
),,1 2
;,,2 3
}-- 
}.. 
catch// 
(// 
	Exception// 
e// 
)// 
{00 

MessageBox11 
.11 
Show11 
(11  
e11  !
.11! "
Message11" )
,11) *
$str11+ c
,11c d
MessageBoxButtons11e v
.11v w
OK11w y
,11y z
MessageBoxIcon	11{ â
.
11â ä
Error
11ä è
)
11è ê
;
11ê ë
}22 
return44 
idVenta44 
;44 
}55 	
public77 
List77 
<77 
EntVenta77 
>77 
ListarVenta77 )
(77) *
int77* -
id77. 0
)770 1
{88 	

SqlCommand99 
cmd99 
=99 
null99 !
;99! "
List:: 
<:: 
EntVenta:: 
>:: 
lista::  
=::! "
new::# &
List::' +
<::+ ,
EntVenta::, 4
>::4 5
(::5 6
)::6 7
;::7 8
try;; 
{<< 
SqlConnection== 
cn==  
===! "
Conexion==# +
.==+ ,
	Instancia==, 5
.==5 6
Conectar==6 >
(==> ?
)==? @
;==@ A
cmd>> 
=>> 
new>> 

SqlCommand>> $
(>>$ %
$str>>% 4
,>>4 5
cn>>6 8
)>>8 9
;>>9 :
cmd?? 
.?? 

Parameters?? 
.?? 
AddWithValue?? +
(??+ ,
$str??, 1
,??1 2
id??3 5
)??5 6
;??6 7
cmd@@ 
.@@ 
CommandType@@ 
=@@  !
CommandType@@" -
.@@- .
StoredProcedure@@. =
;@@= >
cnAA 
.AA 
OpenAA 
(AA 
)AA 
;AA 
SqlDataReaderBB 
drBB  
=BB! "
cmdBB# &
.BB& '
ExecuteReaderBB' 4
(BB4 5
)BB5 6
;BB6 7
whileCC 
(CC 
drCC 
.CC 
ReadCC 
(CC 
)CC  
)CC  !
{DD 
EntVentaEE 
venEE  
=EE! "
newEE# &
EntVentaEE' /
{FF 
IdVentaGG 
=GG  !
ConvertGG" )
.GG) *
ToInt32GG* 1
(GG1 2
drGG2 4
[GG4 5
$strGG5 >
]GG> ?
)GG? @
,GG@ A
FechaHH 
=HH 
ConvertHH  '
.HH' (

ToDateTimeHH( 2
(HH2 3
drHH3 5
[HH5 6
$strHH6 =
]HH= >
)HH> ?
,HH? @
TotalII 
=II 
ConvertII  '
.II' (
ToDoubleII( 0
(II0 1
drII1 3
[II3 4
$strII4 ;
]II; <
)II< =
,II= >
EstadoJJ 
=JJ  
drJJ! #
[JJ# $
$strJJ$ ,
]JJ, -
.JJ- .
ToStringJJ. 6
(JJ6 7
)JJ7 8
,JJ8 9
ClienteKK 
=KK  !
newKK" %

EntUsuarioKK& 0
{LL 
	IdUsuarioMM %
=MM& '
ConvertMM( /
.MM/ 0
ToInt32MM0 7
(MM7 8
drMM8 :
[MM: ;
$strMM; F
]MMF G
)MMG H
,MMH I
}NN 
}OO 
;OO 
listaPP 
.PP 
AddPP 
(PP 
venPP !
)PP! "
;PP" #
}QQ 
}RR 
catchSS 
(SS 
	ExceptionSS 
eSS 
)SS 
{TT 

MessageBoxVV 
.VV 
ShowVV 
(VV  
eVV  !
.VV! "
MessageVV" )
)VV) *
;VV* +
}WW 
returnYY 
listaYY 
;YY 
}ZZ 	
public\\ 
List\\ 
<\\ 
EntVenta\\ 
>\\ 
ListarTodasLasVenta\\ 1
(\\1 2
)\\2 3
{]] 	

SqlCommand^^ 
cmd^^ 
=^^ 
null^^ !
;^^! "
List__ 
<__ 
EntVenta__ 
>__ 
lista__  
=__! "
new__# &
List__' +
<__+ ,
EntVenta__, 4
>__4 5
(__5 6
)__6 7
;__7 8
try`` 
{aa 
SqlConnectionbb 
cnbb  
=bb! "
Conexionbb# +
.bb+ ,
	Instanciabb, 5
.bb5 6
Conectarbb6 >
(bb> ?
)bb? @
;bb@ A
cmdcc 
=cc 
newcc 

SqlCommandcc $
(cc$ %
$strcc% <
,cc< =
cncc> @
)cc@ A
;ccA B
cmddd 
.dd 
CommandTypedd 
=dd  !
CommandTypedd" -
.dd- .
StoredProceduredd. =
;dd= >
cnee 
.ee 
Openee 
(ee 
)ee 
;ee 
SqlDataReaderff 
drff  
=ff! "
cmdff# &
.ff& '
ExecuteReaderff' 4
(ff4 5
)ff5 6
;ff6 7
whilegg 
(gg 
drgg 
.gg 
Readgg 
(gg 
)gg  
)gg  !
{hh 
EntVentaii 
venii  
=ii! "
newii# &
EntVentaii' /
{jj 
IdVentakk 
=kk  !
Convertkk" )
.kk) *
ToInt32kk* 1
(kk1 2
drkk2 4
[kk4 5
$strkk5 >
]kk> ?
)kk? @
,kk@ A
Fechall 
=ll 
Convertll  '
.ll' (

ToDateTimell( 2
(ll2 3
drll3 5
[ll5 6
$strll6 =
]ll= >
)ll> ?
,ll? @
Totalmm 
=mm 
Convertmm  '
.mm' (
ToDoublemm( 0
(mm0 1
drmm1 3
[mm3 4
$strmm4 ;
]mm; <
)mm< =
,mm= >
Estadonn 
=nn  
drnn! #
[nn# $
$strnn$ ,
]nn, -
.nn- .
ToStringnn. 6
(nn6 7
)nn7 8
,nn8 9
Clienteoo 
=oo  !
newoo" %

EntUsuariooo& 0
{pp 
Correoqq "
=qq# $
drqq% '
[qq' (
$strqq( 0
]qq0 1
.qq1 2
ToStringqq2 :
(qq: ;
)qq; <
,qq< =
UserNamerr $
=rr% &
drrr' )
[rr) *
$strrr* 4
]rr4 5
.rr5 6
ToStringrr6 >
(rr> ?
)rr? @
}ss 
}tt 
;tt 
listauu 
.uu 
Adduu 
(uu 
venuu !
)uu! "
;uu" #
}vv 
}ww 
catchxx 
(xx 
	Exceptionxx 
exx 
)xx 
{yy 

MessageBox{{ 
.{{ 
Show{{ 
({{  
e{{  !
.{{! "
Message{{" )
){{) *
;{{* +
}|| 
return~~ 
lista~~ 
;~~ 
} 	
}
ÄÄ 
<<<<<<< HEAD
}ÅÅ Æ
XD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatCompra.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 

IDatCompra

 
{ 
int 
CrearCompra 
( 
	EntCompra !
comp" &
)& '
;' (
List	 
< 
	EntCompra 
> 
ListarCompra %
(% &
int& )
id* ,
), -
;- .
List	 
< 
	EntCompra 
> !
ListarTodasLasCompras .
(. /
)/ 0
;0 1
bool	 
EliminarCompra 
( 
int  
idcompra! )
)) *
;* +
List	 
< 
	EntCompra 
> 
BuscarCompra %
(% &
string& ,
busqueda- 5
)5 6
;6 7
} 
} û
JD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\encrypt.cs
=======
}ÅÅ ¨
XC:\Users\mike\Desktop\Calidad_ofline\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\encrypt.cs
>>>>>>> 3a8f80fe0bd6557c448cc86d5f355e7acf4d3b01
	namespace 	
CapaAccesoDatos
 
{ 
public 

class 
encrypt 
{ 
public 
static 
string 
	GetSHA256 &
(& '
string' -
str. 1
)1 2
{		 	
SHA256

 
sha256

 
=

 
SHA256Managed

 )
.

) *
Create

* 0
(

0 1
)

1 2
;

2 3
ASCIIEncoding 
encoding "
=# $
new% (
ASCIIEncoding) 6
(6 7
)7 8
;8 9
byte 
[ 
] 
stream 
= 
null  
;  !
StringBuilder 
sb 
= 
new "
StringBuilder# 0
(0 1
)1 2
;2 3
stream 
= 
sha256 
. 
ComputeHash '
(' (
encoding( 0
.0 1
GetBytes1 9
(9 :
str: =
)= >
)> ?
;? @
for 
( 
int 
i 
= 
$num 
; 
i 
< 
stream  &
.& '
Length' -
;- .
i/ 0
++0 2
)2 3
sb4 6
.6 7
AppendFormat7 C
(C D
$strD L
,L M
streamN T
[T U
iU V
]V W
)W X
;X Y
return 
sb 
. 
ToString 
( 
)  
;  !
} 	
} 
} ˆ
[D:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatDetCompra.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{ 
public 

	interface 
IDatDetCompra "
{ 
bool		 
CrearDetCompra		 
(		 
EntDetCompra		 (
Det		) ,
)		, -
;		- .
List

 
<

 
EntDetCompra

 
>

 "
MostrarDetalleCompraId

 1
(

1 2
int

2 5
id

6 8
)

8 9
;

9 :
} 
} Ô
ZD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatDetVenta.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatDetVenta

 !
{ 
bool 
CrearDetVenta 
( 
EntDetVenta &
Det' *
)* +
;+ ,
List 
< 
EntDetVenta 
> 
Mostrardetventa )
() *
int* -
idVenta. 5
)5 6
;6 7
} 
} Õ

ZD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatProducto.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatProducto

 !
{ 
bool 
CrearProducto 
( 
EntProducto &
prod' +
)+ ,
;, -
List 
< 
EntProducto 
> 
ListarProducto (
(( )
)) *
;* +
bool 
ActualizarProducto 
(  
EntProducto  +
Prod, 0
)0 1
;1 2
bool 
EliminarProducto 
( 
int !
id" $
)$ %
;% &
List 
< 
EntProducto 
> 
BuscarProducto (
(( )
string) /
busqueda0 8
)8 9
;9 :
EntProducto 
BuscarProductoId $
($ %
int% (
idprod) /
)/ 0
;0 1
List 
<  
EntProveedorProducto !
>! "
Ordenar# *
(* +
int+ .
dato/ 3
)3 4
;4 5
} 
} á
[D:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatProveedor.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatProveedor

 "
{ 
bool 
CrearProveedor 
( 
EntProveedor (
pro) ,
), -
;- .
List 
< 
EntProveedor 
> 
ListarProveedor *
(* +
)+ ,
;, -
List 
< 
EntProveedor 
> 
SelectListProveedor .
(. /
)/ 0
;0 1
bool 
ActualizarProveedor  
(  !
EntProveedor! -
pro. 1
)1 2
;2 3
bool 
EliminarProveedor 
( 
int "
idProveedor# .
). /
;/ 0
List 
< 
EntProveedor 
> "
SelectListProveedordat 1
(1 2
int2 5
idprov6 <
)< =
;= >
List 
< 
EntProveedor 
> 
BuscarProveedor *
(* +
string+ 1
busqueda2 :
): ;
;; <
EntProveedor 
BuscarIdProveedor &
(& '
int' *
idProveedor+ 6
)6 7
;7 8
} 
} ®
cD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatProveedorProducto.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 !
IDatProveedorProducto

 *
{ 
bool "
CrearProveedorProducto #
(# $ 
EntProveedorProducto$ 8
prod9 =
)= >
;> ?
List 
<  
EntProveedorProducto !
>! "%
ListarProductoParaComprar# <
(< =
)= >
;> ?
List 
<  
EntProveedorProducto !
>! "$
MostarDetalleProveedorId# ;
(; <
int< ?
idProveedor@ K
)K L
;L M
bool $
EliminarDetalleProveedor %
(% &
int& )
prov* .
,. /
int0 3
prod4 8
)8 9
;9 :
List 
<  
EntProveedorProducto !
>! "%
BuscarProductoParaComprar# <
(< =
string= C
busquedaD L
)L M
;M N 
EntProveedorProducto $
BuscarProvedorProductoId 5
(5 6
int6 9
idprod: @
,@ A
intB E
idprovF L
)L M
;M N
} 
} Ï
cD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatTemporaryProducts.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 !
IDatTemporaryProducts

 *
{ 
bool &
CreaarTemporaryProductsCli '
(' ( 
EntTemporaryProducts( <
temp= A
)A B
;B C
bool #
CreaarTemporaryProducts $
($ % 
EntTemporaryProducts% 9
temp: >
)> ?
;? @
List 
<  
EntTemporaryProducts !
>! "$
MostrarTemporaryProducts# ;
(; <
int< ?
	idUsuario@ I
)I J
;J K
List 
<  
EntTemporaryProducts !
>! "'
MostrarTemporaryProductsCli# >
(> ?
int? B
	idUsuarioC L
)L M
;M N
bool %
EliminarTemporaryProducts &
(& '
int' *
idtemp+ 1
)1 2
;2 3
bool '
ActualizarTemporaryProducts (
(( ) 
EntTemporaryProducts) =
temp> B
)B C
;C D 
EntTemporaryProducts %
BuscarTemporaryProductsId 6
(6 7
int7 :
id; =
)= >
;> ? 
EntTemporaryProducts (
BuscarTemporaryProductsIdCli 9
(9 :
int: =
id> @
)@ A
;A B
} 
} π
^D:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatTipoProducto.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatTipoProducto

 %
{ 
bool 
CrearTipoProducto 
( 
EntTipoProducto .
tip/ 2
)2 3
;3 4
List 
< 
EntTipoProducto 
> "
SelectListTipoProducto 4
(4 5
)5 6
;6 7
List 
< 
EntTipoProducto 
> %
SelectListTipoProductodat 7
(7 8
int8 ;
id< >
)> ?
;? @
bool "
ActualizarTipoProducto #
(# $
EntTipoProducto$ 3
tip4 7
)7 8
;8 9
bool  
EliminarTipoProducto !
(! "
int" %
id& (
)( )
;) *
} 
} Ö	
XD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatUbigeo.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 

IDatUbigeo

 
{ 
bool 
CrearUbigeo 
( 
	EntUbigeo "
ubi# &
)& '
;' (
List 
< 
	EntUbigeo 
> 
ListarUbigeo $
($ %
)% &
;& '
List 
< 
	EntUbigeo 
> 
ListarDistrito &
(& '
)' (
;( )
bool 
ActualizarUbigeo 
( 
	EntUbigeo '
ubi( +
)+ ,
;, -
bool 
EliminarUbigeo 
( 
int 
id  "
)" #
;# $
List 
< 
	EntUbigeo 
> 
BuscarUbigeo $
($ %
string% +
busqueda, 4
)4 5
;5 6
} 
} ©
YD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatUsuario.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
IDatUsuario

  
{ 
bool 
CrearCliente 
( 

EntUsuario $
Cli% (
)( )
;) *
List 
< 

EntUsuario 
> 
ListarCliente &
(& '
)' (
;( )
List 
< 

EntUsuario 
> 
BuscarCliente &
(& '
string' -
busqueda. 6
)6 7
;7 8
bool 
EditarCliente 
( 

EntUsuario %
u& '
)' (
;( )
List 
< 

EntUsuario 
> !
ListarAdministradores .
(. /
)/ 0
;0 1
bool #
ActualizarAdministrador $
($ %

EntUsuario% /
ad0 2
)2 3
;3 4
List 
< 

EntUsuario 
> "
BuscaraAdministradores /
(/ 0
string0 6
busqueda7 ?
)? @
;@ A

EntUsuario 
IniciarSesion  
(  !
string! '
campo( -
,- .
string/ 5
contra6 <
)< =
;= >
bool 
EliminarUsuarios 
( 
int !
id" $
)$ %
;% &

EntUsuario 
BuscarIdUsuario "
(" #
int# &
busqueda' /
)/ 0
;0 1
} 
} Ï
WD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Interfaces\IDatVenta.cs
	namespace 	
CapaAccesoDatos
 
. 

Interfaces $
{		 
public

 

	interface

 
	IDatVenta

 
{ 
int 

CrearVenta 
( 
EntVenta 
venta  %
)% &
;& '
List 
< 
EntVenta 
> 
ListarVenta "
(" #
int# &
id' )
)) *
;* +
List 
< 
EntVenta 
> 
ListarTodasLasVenta *
(* +
)+ ,
;, -
} 
} Ö
ZD:\Universidad\calidad\PRUEBAS-MADERERA\SISTEMA\CapaAccesoDatos\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str *
)* +
]+ ,
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[		 
assembly		 	
:			 
!
AssemblyConfiguration		  
(		  !
$str		! #
)		# $
]		$ %
[

 
assembly

 	
:

	 

AssemblyCompany

 
(

 
$str

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *